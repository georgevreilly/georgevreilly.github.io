<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:atom="https://www.w3.org/2005/Atom">
    <channel>
        <title>George V. Reilly</title>
        <link>https://www.georgevreilly.com/</link>
        <description></description>
        <language>en</language>
        <pubDate>Wed, 31 Dec 2025 00:00:00 GMT</pubDate>
        <docs>https://www.georgevreilly.com/rss/</docs>
        <generator>acrylamid 0.8.dev0</generator>
        
            <item>
        <title>International Charger</title>
        <link>https://www.georgevreilly.com/2025/12/31/InternationalCharger.html</link>
        <description>&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://www.power-plugs-sockets.com/&#34;&gt;&lt;img alt=&#34;International Cables for USB Charger&#34; src=&#34;https://www.georgevreilly.com/content/binary/international-charger-cables.jpg&#34; style=&#34;width: 600px;&#34;/&gt;&lt;/a&gt;
&lt;p&gt;Over the last two years,
I have traveled to multiple countries
with a single beefy USB charger,
even though those countries use a variety of &lt;a class=&#34;reference external&#34; href=&#34;https://www.power-plugs-sockets.com/&#34;&gt;electrical plug types&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;How?
I bought a power cord for each kind of plug:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;USA + Canada: &lt;a class=&#34;reference external&#34; href=&#34;https://www.worldstandards.eu/electricity/plugs-and-sockets/ab/&#34;&gt;Type A&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;France, Portugal, Sweden: &lt;a class=&#34;reference external&#34; href=&#34;https://www.worldstandards.eu/electricity/plugs-and-sockets/c/&#34;&gt;Type C&lt;/a&gt; (the Euro plug)&lt;/li&gt;
&lt;li&gt;Ireland + United Kingdom: &lt;a class=&#34;reference external&#34; href=&#34;https://www.worldstandards.eu/electricity/plugs-and-sockets/g/&#34;&gt;Type G&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;New Zealand: &lt;a class=&#34;reference external&#34; href=&#34;https://www.worldstandards.eu/electricity/plugs-and-sockets/i/&#34;&gt;Type I&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Each of these power cords has the same &lt;a class=&#34;reference external&#34; href=&#34;https://www.sfcable.com/blog/all-know-power-cord-connectors&#34;&gt;connector&lt;/a&gt;:
the &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/IEC_60320#C7/C8_coupler&#34;&gt;figure-8 C7&lt;/a&gt;,
since that&#39;s what the USB charger accepts.&lt;/p&gt;
&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://issuu.com/sfcable/docs/iec_c5_power_cords_vs_iec_c7_power_cords_what_s_t/s/24565475&#34;&gt;&lt;img alt=&#34;International Cables for USB Charger&#34; src=&#34;https://www.georgevreilly.com/content/binary/c5-vs-c7-power-cords.jpeg&#34;/&gt;&lt;/a&gt;
&lt;p&gt;Similarly, I bring &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/IEC_60320#C5/C6_coupler&#34;&gt;clover-leaf C5&lt;/a&gt; power cords with different plugs
for PC laptop chargers.&lt;/p&gt;
&lt;p&gt;Obviously, I could use travel adapter plugs instead,
but I find it convenient to bring the right power cords.
And a selection of USB-C and USB-A cables.&lt;/p&gt;
</description>
        <pubDate>Wed, 31 Dec 2025 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2025-12-31:/2025/12/31/InternationalCharger.html</guid>
    </item>
        
            <item>
        <title>Wordle on Normal Mode</title>
        <link>https://www.georgevreilly.com/blog/2025/05/30/WordleOnNormalMode.html</link>
        <description>&lt;blockquote class=&#34;pull-quote&#34;&gt;
&lt;p&gt;At the &lt;a class=&#34;reference external&#34; href=&#34;https://www.meetup.com/psppython/events/307728743/&#34;&gt;June 2025 PuPPy meetup&lt;/a&gt; (Puget Sound Programming Python),
I will be giving a talk about &lt;em&gt;Exploring Wordle&lt;/em&gt;.&lt;/p&gt;
&lt;div class=&#34;line-block&#34;&gt;
&lt;div class=&#34;line&#34;&gt;June 11: doors open at 5:30pm&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;GitHub Bellevue&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;10900 NE 4th St, Floor 21&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Bellevue, WA 98004&lt;/div&gt;
&lt;/div&gt;
&lt;/blockquote&gt;
&lt;p&gt;In &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/09/26/ExploringWordle.html&#34;&gt;Exploring Wordle&lt;/a&gt;, I wrote a long blog post about solving Wordle programmatically,
which implicitly solved Wordle in &lt;em&gt;Hard Mode&lt;/em&gt;.
Today, I want to discuss a strategy that is only possible in Normal Mode.&lt;/p&gt;
&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://slate.com/culture/2022/02/wordle-game-nyt-original-vs-hard-mode.html&#34;&gt;&lt;img alt=&#34;Hard Mode in Wordle setting&#34; src=&#34;https://www.georgevreilly.com/content/binary/WordleHardMode.png&#34;/&gt;&lt;/a&gt;
&lt;dl class=&#34;docutils&#34;&gt;
&lt;dt&gt;Hard Mode&lt;/dt&gt;
&lt;dd&gt;&lt;p class=&#34;first&#34;&gt;Can be turned on through the Settings menu at the top right of the screen.
‚ÄúAny revealed hints must be used in subsequent guesses‚Äù it says.
If you guess a ‚Äúpresent‚Äù (yellow) letter,
that letter must be used on all subsequent guesses.
If you guess a ‚Äúcorrect‚Äù (green) letter, such as &lt;tt class=&#34;docutils literal&#34;&gt;3:T&lt;/tt&gt;,
that letter must played in that position on all the remaining guesses.&lt;/p&gt;
&lt;p&gt;When you post your results,
the &lt;tt class=&#34;docutils literal&#34;&gt;N/6&lt;/tt&gt; score will be suffixed with a star, &lt;tt class=&#34;docutils literal&#34;&gt;*&lt;/tt&gt;.&lt;/p&gt;
&lt;div class=&#34;last line-block&#34;&gt;
&lt;div class=&#34;line&#34;&gt;Wordle 1,317 4/6*&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;‚¨ú‚¨ú‚¨úüü®‚¨ú&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;üü©‚¨úüü®‚¨ú‚¨ú&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;üü©üü©‚¨ú‚¨úüü©&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;üü©üü©üü©üü©üü©&lt;/div&gt;
&lt;/div&gt;
&lt;/dd&gt;
&lt;dt&gt;Normal Mode&lt;/dt&gt;
&lt;dd&gt;&lt;p class=&#34;first&#34;&gt;If you&#39;ve never turned on Hard Mode,
then you&#39;re playing Normal Mode.
You can play any letter at any time.
You are not required to play all the present and correct letters
from previous guesses.&lt;/p&gt;
&lt;p class=&#34;last&#34;&gt;This post will explore why this might be useful.&lt;/p&gt;
&lt;/dd&gt;
&lt;/dl&gt;
&lt;p&gt;Many people play hard mode rules, without realizing it.
They instinctively apply all the constraints that they&#39;ve learned from earlier guesses.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://slate.com/culture/2022/02/wordle-game-nyt-original-vs-hard-mode.html&#34;&gt;Slate&lt;/a&gt; has a discussion of the merits of Hard Mode and Normal Mode.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;an-example-of-normal-mode-being-helpful&#34;&gt;
&lt;h3&gt;An example of Normal Mode being helpful&lt;/h3&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img alt=&#34;Game 1285: OLIVE=....E FRAME=.rA.E STARE=S.ARE&#34; src=&#34;https://www.georgevreilly.com/content/binary/olive-frame-stare.png&#34; style=&#34;width: 400px;&#34;/&gt;
&lt;p class=&#34;caption&#34;&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://wordlearchive.com/1285&#34;&gt;Wordle Game 1285&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;p&gt;&lt;tt class=&#34;docutils literal&#34;&gt;S.ARE&lt;/tt&gt; could be &lt;tt class=&#34;docutils literal&#34;&gt;SCARE&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;SHARE&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;SNARE&lt;/tt&gt;, or &lt;tt class=&#34;docutils literal&#34;&gt;SPARE&lt;/tt&gt;.
In Hard Mode, you would have no choice
but to try those four choices in some order,
and hope that you got the right one before running out of guesses.
Three guesses have already been played and three remain.&lt;/p&gt;
&lt;p&gt;Each of the following outcomes are possible:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;getting the correct answer on your fourth guess&lt;/li&gt;
&lt;li&gt;on your fifth guess&lt;/li&gt;
&lt;li&gt;on your sixth guess&lt;/li&gt;
&lt;li&gt;losing the game if the correct word was last in your list.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In Normal Mode however,
you can guess a word that contains the four differing letters,
&lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;H&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;N&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;P&lt;/tt&gt;,
and pin down the answer.
&lt;tt class=&#34;docutils literal&#34;&gt;PUNCH&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;PINCH&lt;/tt&gt; are both suitable words.
You can&#39;t possibly win with &lt;tt class=&#34;docutils literal&#34;&gt;PUNCH&lt;/tt&gt;, but your next guess is guaranteed to win.
In this case, I got &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;PUNCH=....h&lt;/span&gt;&lt;/tt&gt;,
so I played &lt;tt class=&#34;docutils literal&#34;&gt;SHARE&lt;/tt&gt; as my fifth guess.&lt;/p&gt;
&lt;link rel=&#34;stylesheet&#34; href=&#34;/wordle.css&#34;&gt;&lt;/div&gt;
</description>
        <pubDate>Sat, 31 May 2025 03:00:04 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2025-05-31:/blog/2025/05/30/WordleOnNormalMode.html</guid>
    </item>
        
            <item>
        <title>Patching Airflow Wheels</title>
        <link>https://www.georgevreilly.com/blog/2024/12/20/PatchingAirflowWheels.html</link>
        <description>&lt;p&gt;In &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2024/12/16/PatchingAndSplittingPythonWheels.html&#34;&gt;Patching and Splitting Python Wheels&lt;/a&gt;,
I wrote about some occasions when I had to take a &lt;a class=&#34;reference external&#34; href=&#34;https://realpython.com/python-wheels/&#34;&gt;Python wheel&lt;/a&gt;
and patch it.
Now I want to tell you about a very different approach
that I used recently to patch Airflow wheels.&lt;/p&gt;
&lt;p&gt;With the other wheels, we just needed to apply some tactical patches.
With Airflow, we are making substantive changes.&lt;/p&gt;
&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://airflow.apache.org/&#34;&gt;&lt;img alt=&#34;Apache Airflow&#34; src=&#34;https://www.georgevreilly.com/content/binary/ApacheAirflowLogo.png&#34;/&gt;&lt;/a&gt;
&lt;p&gt;We&#39;ve been using &lt;a class=&#34;reference external&#34; href=&#34;https://airflow.apache.org/&#34;&gt;Airflow&lt;/a&gt; for years at work.
We built up a lot of infrastructure around Airflow 1
and we are gradually migrating to &lt;a class=&#34;reference external&#34; href=&#34;https://www.astronomer.io/blog/introducing-airflow-2-0/&#34;&gt;Airflow 2&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Several years ago, we forked the &lt;a class=&#34;reference external&#34; href=&#34;https://pypi.org/project/apache-airflow/&#34;&gt;airflow package&lt;/a&gt;
and made a large number of changes to it for internal consumption.
Unfortunately, this made it increasingly hard for us to merge changes
from the &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/apache/airflow&#34;&gt;upstream repo&lt;/a&gt; into our internal Git repository,
as the repos continued to diverge.&lt;/p&gt;
&lt;p&gt;Airflow&#39;s &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/apache/airflow/blob/2.10.2/dev/README_RELEASE_AIRFLOW.md&#34;&gt;current release workflow&lt;/a&gt;:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Create a release branch from &lt;tt class=&#34;docutils literal&#34;&gt;main&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;Create release candidates.&lt;/li&gt;
&lt;li&gt;Fix any problems, including cherry-picking from &lt;tt class=&#34;docutils literal&#34;&gt;main&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;Publish the final release, which is &lt;a class=&#34;reference external&#34; href=&#34;https://git-scm.com/book/en/v2/Git-Basics-Tagging&#34;&gt;tagged&lt;/a&gt;.
The package is uploaded to PyPI.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Note that this tagged branch is never merged back to &lt;tt class=&#34;docutils literal&#34;&gt;main&lt;/tt&gt;,
so you cannot checkout an official release from the &lt;tt class=&#34;docutils literal&#34;&gt;main&lt;/tt&gt; branch.
You must checkout the tag instead.
(I don&#39;t know if this was also the release workflow for Airflow 1.)&lt;/p&gt;
&lt;p&gt;Our internal workflow is different.
Engineers work on feature branches and create pull requests.
These pull requests get merged into &lt;tt class=&#34;docutils literal&#34;&gt;master&lt;/tt&gt;.
Production deployments are built from &lt;tt class=&#34;docutils literal&#34;&gt;master&lt;/tt&gt; only.
We don&#39;t use tagged releases.
This &lt;tt class=&#34;docutils literal&#34;&gt;master&lt;/tt&gt;-centric assumption is baked deeply
into our build and continuous integration systems.
Since the upstream &lt;tt class=&#34;docutils literal&#34;&gt;main&lt;/tt&gt; doesn&#39;t have release code,
it&#39;s not suitable for merging into our &lt;tt class=&#34;docutils literal&#34;&gt;master&lt;/tt&gt;.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;git-clone-workflow&#34;&gt;
&lt;h3&gt;Git Clone Workflow&lt;/h3&gt;
&lt;p&gt;To avoid the difficulties that we caused ourselves with Airflow 1,
we created a fresh repository for Airflow 2,
which does &lt;em&gt;not&lt;/em&gt; have a copy of the upstream repo&#39;s code.
We now maintain a set of patches for each upstream release that we care about.
This new repo has build scripts and patches only.&lt;/p&gt;
&lt;p&gt;When I first set this up,
I had the CI build script create a shallow clone of the upstream repo,
then check out each tag,
and apply our patches.&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# NOT SHOWN: create a virtualenv with Hatch and other build dependencies
# from Airflow&#39;s pyproject.toml
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;git&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;clone&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--depth&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;https://github.com/apache/airflow.git&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;worktree&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;worktree&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;tag&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;2.10.2&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;2.10.4&amp;quot;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;git&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;reset&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--hard&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;HEAD&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;rm&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-rf&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;dist&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;git&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;fetch&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--depth&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;origin&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;git&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;checkout&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--quiet&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;FETCH_HEAD&lt;span class=&#34;w&#34;&gt;

    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;p&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;../patches/&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$tag&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;/*.patch&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;do&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;git&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;am&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&amp;lt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$p&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

    &lt;/span&gt;python3&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-m&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;build&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--wheel&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;cp&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;dist/*&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;../build&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;done&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The first patch for each tag changes the version information
so that our wheel won&#39;t conflict with the official wheel from upstream.
It updates &lt;tt class=&#34;docutils literal&#34;&gt;tool.hatch.version&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;pyproject.toml&lt;/tt&gt; to read:&lt;/p&gt;
&lt;pre class=&#34;code toml literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;[tool.hatch.version]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;source&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;expression&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;stripe_airflow_version()&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;stripe_version.py&amp;quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;instead of extracting the version information from &lt;tt class=&#34;docutils literal&#34;&gt;airflow/__init__.py&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;stripe_version.py&lt;/tt&gt; script uses &lt;a class=&#34;reference external&#34; href=&#34;https://git-scm.com/docs/git-describe&#34;&gt;git describe&lt;/a&gt;
to get the number of additional commits in our branch
and the abbreviated SHA of the most recent commit,
then prefixes these items with &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;+stripe.${MAJOR}.&lt;/span&gt;&lt;/tt&gt;
All of this is suffixed to the actual version number from upstream,
so we build a wheel that is named something like
&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;apache_airflow-${TAG}+stripe.1.${COUNT}.g${SHA}-py3-none-any.whl&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;While this system produced a working wheel,
there was one critical omission.
The official upstream wheel contained an extra 37MB of UI code in &lt;tt class=&#34;docutils literal&#34;&gt;www/static&lt;/tt&gt;,
which is used by the various Airflow website UIs.&lt;/p&gt;
&lt;p&gt;I spent quite a bit of effort to make our build generate this extra payload,
but it turned out to be very difficult.
&lt;tt class=&#34;docutils literal&#34;&gt;python3 &lt;span class=&#34;pre&#34;&gt;-m&lt;/span&gt; hatch build &lt;span class=&#34;pre&#34;&gt;-t&lt;/span&gt; custom&lt;/tt&gt;
requires Node.js and does a lot of extra steps
that didn&#39;t interact well with the locked down egress rules of our CI.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;source-distribution-workflow&#34;&gt;
&lt;h3&gt;Source Distribution Workflow&lt;/h3&gt;
&lt;p&gt;I realized that all of the &lt;tt class=&#34;docutils literal&#34;&gt;www/static&lt;/tt&gt; tree could be
extracted from the official release,
and that we didn&#39;t have to generate it in CI.&lt;/p&gt;
&lt;p&gt;Instead of checking out a tag,
our CI downloads the official &lt;a class=&#34;reference external&#34; href=&#34;https://packaging.python.org/en/latest/specifications/source-distribution-format/&#34;&gt;source distribution&lt;/a&gt; tarball,
&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;apache_airflow-${RELEASE}.tar.gz&lt;/span&gt;&lt;/tt&gt;,
untars the contents,
applies our patches using &lt;tt class=&#34;docutils literal&#34;&gt;patch &lt;span class=&#34;pre&#34;&gt;--strip=1&lt;/span&gt;&lt;/tt&gt; instead of &lt;tt class=&#34;docutils literal&#34;&gt;git am&lt;/tt&gt;,
and builds a new wheel.&lt;/p&gt;
&lt;p&gt;It took me a while to figure out why our custom versioning wasn&#39;t working.
Because the sdist contains a file called &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;PKG-INFO&lt;/span&gt;&lt;/tt&gt; at the root,
Hatch takes the version from that.
I had to update the &lt;tt class=&#34;docutils literal&#34;&gt;stripe_version.py&lt;/tt&gt; script to modify
the &lt;tt class=&#34;docutils literal&#34;&gt;Version:&lt;/tt&gt; line in &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;PKG-INFO&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;format-patch-workflow&#34;&gt;
&lt;h3&gt;Format-Patch Workflow&lt;/h3&gt;
&lt;p&gt;So far, I&#39;ve covered how the patched wheel is built in CI,
but not how you would create new patches.&lt;/p&gt;
&lt;p&gt;For local development, you can check out the upstream tag
(see &lt;tt class=&#34;docutils literal&#34;&gt;FETCH_HEAD&lt;/tt&gt; above),
then apply any existing patches that are relevant.
Make other changes, commit them locally, and build the wheel by hand.
When you have tested and have something that you&#39;re happy with,
you can use &lt;a class=&#34;reference external&#34; href=&#34;https://git-scm.com/book/en/v2/Distributed-Git-Maintaining-a-Project&#34;&gt;git format-patch&lt;/a&gt; to create a series of patches.
These patches can then be committed to the repo that we use to build the wheels.&lt;/p&gt;
&lt;p&gt;This workflow is less convenient
than making changes directly in the forked code,
as we did with Airflow 1.
But now we only have a moderate amount of friction
to upgrade to a newer release from upstream,
instead of ever-increasing difficulty.&lt;/p&gt;
&lt;/div&gt;
</description>
        <pubDate>Fri, 20 Dec 2024 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2024-12-20:/blog/2024/12/20/PatchingAirflowWheels.html</guid>
    </item>
        
            <item>
        <title>Patching and Splitting Python Wheels</title>
        <link>https://www.georgevreilly.com/blog/2024/12/16/PatchingAndSplittingPythonWheels.html</link>
        <description>&lt;img alt=&#34;Patching a bicycle tube&#34; src=&#34;https://www.georgevreilly.com/content/binary/patching-bike-tube.jpg&#34; style=&#34;width: 700px;&#34;/&gt;
&lt;p&gt;I gave lightning talks at &lt;a class=&#34;reference external&#34; href=&#34;https://www.meetup.com/pythonireland/events/300802991/&#34;&gt;Python Ireland&lt;/a&gt; in May 2024 and
&lt;a class=&#34;reference external&#34; href=&#34;https://www.meetup.com/psppython/events/302211630/&#34;&gt;Puget Sound Programming Python (PuPPy)&lt;/a&gt; in August 2024
about patching and splitting wheels: &lt;a class=&#34;reference external&#34; href=&#34;https://docs.google.com/presentation/d/1YXfI7U1oVgHLSgX8uYieIGdooQK-jTqXWMhpkUrAo4U/edit?usp=sharing&#34;&gt;slides&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;patching-wheels&#34;&gt;
&lt;h3&gt;Patching Wheels&lt;/h3&gt;
&lt;p&gt;Last year, I wrote about manually &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/08/10/PatchingAPythonWheel.html&#34;&gt;Patching a Python Wheel&lt;/a&gt;.
There was a cyclic dependency
between the Torch 2.0.1 wheel and the Triton 2.0.0 wheel.
While &lt;tt class=&#34;docutils literal&#34;&gt;pip&lt;/tt&gt; had no problem with this,
&lt;a class=&#34;reference external&#34; href=&#34;https://bazel.build/&#34;&gt;Bazel&lt;/a&gt; certainly did.
My &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/08/10/PatchingAPythonWheel.html&#34;&gt;workaround&lt;/a&gt; was to unzip the Torch wheel,
edit the metadata to remove the dependency on Triton,
and zip the wheel up again with a modified name.&lt;/p&gt;
&lt;p&gt;At the beginning of this year,
I had to patch Torch 2.1 for &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/torch21&#34;&gt;different reasons&lt;/a&gt;.
Again, I needed to patch the Torch wheel because of Bazel problems.
Due to the way that Bazel installs each package in a different location,
instead of one common &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;site-packages&lt;/span&gt;&lt;/tt&gt;,
I had to &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/torch21&#34;&gt;ensure&lt;/a&gt; that Torch preloaded a series of &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;lib*.so&lt;/span&gt;&lt;/tt&gt; extensions
in &lt;em&gt;topologically sorted&lt;/em&gt; order.
This time, I wrote a &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/torch21/blob/main/scripts/patcher&#34;&gt;patcher script&lt;/a&gt; to apply patches to a wheel.&lt;/p&gt;
&lt;p&gt;The &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/torch21/blob/main/scripts/patcher&#34;&gt;patcher script&lt;/a&gt; uses the official &lt;a class=&#34;reference external&#34; href=&#34;https://wheel.readthedocs.io/en/stable/&#34;&gt;wheel&lt;/a&gt; package
to do most of the work
of extracting the contents and packing the new wheel.
My &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/torch21&#34;&gt;torch21 repo&lt;/a&gt; gives two examples of how to use &lt;tt class=&#34;docutils literal&#34;&gt;patcher&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;splitting-wheels&#34;&gt;
&lt;h3&gt;Splitting Wheels&lt;/h3&gt;
&lt;p&gt;There are multiple variants of the Torch wheel.
The Torch 2.1 wheel with CUDA 11.8, &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;torch==2.1.2+cu118&lt;/span&gt;&lt;/tt&gt;, is 2.5GB,
and expands to 4GB!
Almost all of that is in shared object libraries (&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;lib/lib*.so&lt;/span&gt;&lt;/tt&gt;),
some 3.9GB.&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
-rwxr-xr-x 1 georgevreilly stripe  125M Dec 12 18:05 libcudnn_adv_infer.so.8
-rwxr-xr-x 1 georgevreilly stripe  241M Dec 12 18:05 libtorch_cuda_linalg.so
-rwxr-xr-x 1 georgevreilly stripe  451M Dec 12 18:05 libtorch_cpu.so
-rwxr-xr-x 1 georgevreilly stripe  548M Dec 12 18:04 libcublasLt.so.11
-rwxr-xr-x 1 georgevreilly stripe  621M Dec 12 18:05 libcudnn_cnn_infer.so.8
-rwxr-xr-x 1 georgevreilly stripe 1355M Dec 12 18:05 libtorch_cuda.so
&lt;/pre&gt;
&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://gist.github.com/georgevreilly/702e9e8783dd5978bd3e4a151fadee1e&#34;&gt;&lt;img alt=&#34;Library interdependencies&#34; src=&#34;https://www.georgevreilly.com/content/binary/torch-topo-deps.png&#34; style=&#34;width: 700px;&#34;/&gt;&lt;/a&gt;
&lt;p&gt;An internal system that we use for remotely building Bazel actions
has a hard limit of 3GB.
This is an internal policy, not an inherent Bazel limitation,
but it led to difficulties with building apps
that wanted to use the wheel.&lt;/p&gt;
&lt;p&gt;My solution was to split the wheel into two wheels,
a &lt;tt class=&#34;docutils literal&#34;&gt;cudatorch&lt;/tt&gt; wheel, which contained the two largest libraries,
&lt;tt class=&#34;docutils literal&#34;&gt;libtorch_cuda.so&lt;/tt&gt; (1355MB) and &lt;tt class=&#34;docutils literal&#34;&gt;libtorch_cuda_linalg.so&lt;/tt&gt; (241MB),
and a modified version of the &lt;tt class=&#34;docutils literal&#34;&gt;torch&lt;/tt&gt; wheel, which contained everything else.&lt;/p&gt;
&lt;p&gt;I had to use &lt;a class=&#34;reference external&#34; href=&#34;https://manpages.ubuntu.com/manpages/noble/en/man1/patchelf.1.html&#34;&gt;patchelf&lt;/a&gt; to modify the &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Rpath&#34;&gt;rpath&lt;/a&gt; of the two libs
in the &lt;tt class=&#34;docutils literal&#34;&gt;cudatorch&lt;/tt&gt; wheel to something like
&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;$ORIGIN:$ORIGIN/../../torch/lib&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;In the &lt;tt class=&#34;docutils literal&#34;&gt;torch&lt;/tt&gt; wheel, I had to patch &lt;tt class=&#34;docutils literal&#34;&gt;torch/__init__.py&lt;/tt&gt;
to preload the &lt;tt class=&#34;docutils literal&#34;&gt;cudatorch&lt;/tt&gt; libs.&lt;/p&gt;
&lt;/div&gt;
</description>
        <pubDate>Mon, 16 Dec 2024 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2024-12-16:/blog/2024/12/16/PatchingAndSplittingPythonWheels.html</guid>
    </item>
        
            <item>
        <title>Social Media Handles</title>
        <link>https://www.georgevreilly.com/blog/2024/12/01/SocialMediaHandles.html</link>
        <description>&lt;p&gt;The migration away from Twitter has really caught fire lately,
with Bluesky being the obvious winner of new accounts in recent weeks.&lt;/p&gt;
&lt;p&gt;I&#39;m available on other platforms, if you want to follow me.
These are sorted from most to least active:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Bluesky: &lt;a class=&#34;reference external&#34; href=&#34;https://bsky.app/profile/georgevreilly.bsky.social&#34;&gt;&amp;#64;georgevreilly.bsky.social&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Threads: &lt;a class=&#34;reference external&#34; href=&#34;https://www.threads.net/@georgevreilly&#34;&gt;&amp;#64;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Instagram: &lt;a class=&#34;reference external&#34; href=&#34;https://www.instagram.com/georgevreilly/&#34;&gt;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Substack: &lt;a class=&#34;reference external&#34; href=&#34;https://substack.com/@georgevreilly&#34;&gt;&amp;#64;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;LinkedIn: &lt;a class=&#34;reference external&#34; href=&#34;https://www.linkedin.com/in/georgevreilly/&#34;&gt;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;GitHub: &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly&#34;&gt;&amp;#64;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;PixelFed: &lt;a class=&#34;reference external&#34; href=&#34;https://pxlmo.com/georgevreilly&#34;&gt;&amp;#64;georgevreilly&amp;#64;pxlmo.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Twitter: &lt;a class=&#34;reference external&#34; href=&#34;https://x.com/georgevreilly&#34;&gt;&amp;#64;georgevreilly&lt;/a&gt; (going dormant soon)&lt;/li&gt;
&lt;li&gt;Mastodon: &lt;a class=&#34;reference external&#34; href=&#34;https://tech.lgbt/@georgevreilly&#34;&gt;&amp;#64;georgevreilly&amp;#64;tech.lgbt&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Discord: &lt;tt class=&#34;docutils literal&#34;&gt;&amp;#64;georgevreilly&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Reddit: &lt;a class=&#34;reference external&#34; href=&#34;https://www.reddit.com/user/george_v_reilly/&#34;&gt;u/george_v_reilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Tumblr: &lt;a class=&#34;reference external&#34; href=&#34;https://www.tumblr.com/georgevreilly&#34;&gt;&amp;#64;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;TikTok: &lt;a class=&#34;reference external&#34; href=&#34;https://www.tiktok.com/@georgevreilly&#34;&gt;&amp;#64;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Basically, I&#39;m &lt;tt class=&#34;docutils literal&#34;&gt;georgevreilly&lt;/tt&gt; everywhere,
except for a few old accounts from the 2000s where I used &lt;tt class=&#34;docutils literal&#34;&gt;george_v_reilly&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;I have a sweatshirt from attending CascadiaJS in 2012
that has &lt;tt class=&#34;docutils literal&#34;&gt;&amp;#64;georgevreilly&lt;/tt&gt; along the length of the left sleeve.
It was either my Twitter or my GitHub handle (which are, of course, identical).&lt;/p&gt;
&lt;p&gt;I can also be reached via:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Linktree: &lt;a class=&#34;reference external&#34; href=&#34;https://linktr.ee/georgevreilly&#34;&gt;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;About.me: &lt;a class=&#34;reference external&#34; href=&#34;https://about.me/georgevreilly&#34;&gt;georgevreilly&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Sun, 01 Dec 2024 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2024-12-01:/blog/2024/12/01/SocialMediaHandles.html</guid>
    </item>
        
            <item>
        <title>Cold Brew Coffee Recipe for French Press</title>
        <link>https://www.georgevreilly.com/blog/2024/10/19/ColdBrewCoffeeFrenchPressRecipe.html</link>
        <description>&lt;img alt=&#34;French Press&#34; class=&#34;right-float&#34; src=&#34;https://www.georgevreilly.com/content/binary/french-press.jpg&#34;/&gt;
&lt;p&gt;Last year, I posted a recipe for &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/07/24/ColdBrewCoffeeRecipe.html&#34;&gt;cold brew coffee&lt;/a&gt;
using an &lt;a class=&#34;reference external&#34; href=&#34;https://www.oxo.com/cold-brew-coffee-maker.html&#34;&gt;Oxo Cold Brew Coffee Maker&lt;/a&gt;.
Recently, it occurred to me that I could use a French Press instead of the Oxo.
I&#39;ve made several batches, with good results.
It&#39;s a little more convenient to make cold brew in the Oxo,
but it&#39;s good to know that it can be made
without buying special-use equipment.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;ingredients&#34;&gt;
&lt;h3&gt;Ingredients&lt;/h3&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;24 fl oz (700 ml) water&lt;/li&gt;
&lt;li&gt;6 oz (170 g) fresh &lt;em&gt;coarsely ground&lt;/em&gt; coffee.
Store-bought pre-ground coffee is too fine.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This will fill a one-quart (one-liter) French Press.
It &lt;strong&gt;yields about 16 fl oz&lt;/strong&gt; (1 pt/500 ml) of cold brew coffee.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;instructions&#34;&gt;
&lt;h3&gt;Instructions&lt;/h3&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Grind the coffee beans coarsely.&lt;/li&gt;
&lt;li&gt;Place the ground coffee in the French Press.&lt;/li&gt;
&lt;li&gt;Pour water into the grounds, distributing it as best you can.&lt;/li&gt;
&lt;li&gt;Stir gently to ensure that all coffee grounds are wet.&lt;/li&gt;
&lt;li&gt;Cover the French Press with plastic wrap‚Äîthis prevents absorption of odors in the fridge.&lt;/li&gt;
&lt;li&gt;Store it in the fridge, for anywhere between 6 and 24 hours.&lt;/li&gt;
&lt;li&gt;Remove the plastic wrap, insert the plunger, and plunge.&lt;/li&gt;
&lt;li&gt;Pour the brew through a coffee filter
to strain any fine grounds that get past the plunger.&lt;/li&gt;
&lt;li&gt;Refrigerate the cold brew.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
        <pubDate>Sat, 19 Oct 2024 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2024-10-19:/blog/2024/10/19/ColdBrewCoffeeFrenchPressRecipe.html</guid>
    </item>
        
            <item>
        <title>Exploring Wordle</title>
        <link>https://www.georgevreilly.com/blog/2023/09/26/ExploringWordle.html</link>
        <description>&lt;p&gt;Unless YOUVE LIVED UNDER ROCKS, you&#39;ve heard of &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Wordle&#34;&gt;Wordle&lt;/a&gt;,
the online word game that has become wildly popular since late 2021.
You&#39;ve probably seen people posting their Wordle games
as grids of little green, yellow, and black (or white) emojis on social media.&lt;/p&gt;
&lt;div class=&#34;line-block&#34;&gt;
&lt;div class=&#34;line&#34;&gt;Wordle 797 4/6&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;&lt;br /&gt;&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;‚¨õ ‚¨õ ‚¨õ ‚¨õ üü®&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;üü® ‚¨õ üü© ‚¨õ ‚¨õ&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;‚¨õ ‚¨õ üü© üü® ‚¨õ&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;üü© üü© üü© üü© üü©&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;The problem that I want to address in this post is:&lt;/p&gt;
&lt;blockquote&gt;
Given some &lt;tt class=&#34;docutils literal&#34;&gt;GUESS=SCORE&lt;/tt&gt; pairs for Wordle and a word list,
programmatically find all the words from the list
that are eligible as answers.&lt;/blockquote&gt;
&lt;p&gt;Let&#39;s look at this four-round game for Wordle 797:&lt;/p&gt;
&lt;table class=&#34;wordle&#34;&gt;
  &lt;tr&gt;&lt;td class=&#34;absent&#34;&gt;J&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;U&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;D&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;G&lt;/td&gt; &lt;td class=&#34;present&#34;&gt;E&lt;/td&gt; &lt;td class=&#34;gs&#34;&gt;JUDGE=....e&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td class=&#34;present&#34;&gt;C&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;H&lt;/td&gt; &lt;td class=&#34;correct&#34;&gt;E&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;S&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;T&lt;/td&gt; &lt;td class=&#34;gs&#34;&gt;CHEST=c.E..&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td class=&#34;absent&#34;&gt;W&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;R&lt;/td&gt; &lt;td class=&#34;correct&#34;&gt;E&lt;/td&gt; &lt;td class=&#34;present&#34;&gt;C&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;K&lt;/td&gt; &lt;td class=&#34;gs&#34;&gt;WRECK=..Ec.&lt;/td&gt;&lt;/tr&gt;
  &lt;tr&gt;&lt;td class=&#34;correct&#34;&gt;O&lt;/td&gt; &lt;td class=&#34;correct&#34;&gt;C&lt;/td&gt; &lt;td class=&#34;correct&#34;&gt;E&lt;/td&gt; &lt;td class=&#34;correct&#34;&gt;A&lt;/td&gt; &lt;td class=&#34;correct&#34;&gt;N&lt;/td&gt; &lt;td class=&#34;gs&#34;&gt;OCEAN=OCEAN&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;p&gt;The letters of each guess are colored Green, Yellow, or Black (dark-gray).&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;A Green tile üü© means that the letter is &lt;strong&gt;correct&lt;/strong&gt;:
&lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; is the third letter of the answer.&lt;/li&gt;
&lt;li&gt;A Yellow tile üü® means that the letter is &lt;strong&gt;present&lt;/strong&gt; &lt;em&gt;elsewhere&lt;/em&gt; in the answer.
There is a &lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; in the answer;
it&#39;s not in columns 1 or 4, but it is correct in column 2.
Likewise, an &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; is present in the answer;
it&#39;s not in column 5, but it&#39;s correct in column 3.&lt;/li&gt;
&lt;li&gt;A Black tile ‚¨õ is &lt;strong&gt;absent&lt;/strong&gt; from the answer:
&lt;tt class=&#34;docutils literal&#34;&gt;J&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;U&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;D&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;G&lt;/tt&gt;,
&lt;tt class=&#34;docutils literal&#34;&gt;H&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;S&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt;,
&lt;tt class=&#34;docutils literal&#34;&gt;W&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;R&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;K&lt;/tt&gt;
do not appear anywhere in &lt;tt class=&#34;docutils literal&#34;&gt;OCEAN&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(This definition of ‚Äúabsent‚Äù turns out to be inadequate,
as you will discover later.)&lt;/p&gt;
&lt;p&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;GUESS=SCORE&lt;/tt&gt; notation is intended to be clear to read
and also easier to write than Greens and Yellows.
For example:&lt;/p&gt;
&lt;div style=&#34;text-align: center; font-family: &amp;#x27;Source Code Pro&amp;#x27;, monospace; font-size: 48px;&#34;&gt;
    &lt;div&gt;&lt;i&gt;GUESS=SCORE&lt;/i&gt;&lt;/div&gt;
    &lt;div&gt;CHEST=c.E..&lt;/div&gt;
&lt;/div&gt;

&lt;table class=&#34;wordle&#34;&gt;
  &lt;tr&gt;&lt;td class=&#34;present&#34;&gt;C&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;H&lt;/td&gt; &lt;td class=&#34;correct&#34;&gt;E&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;S&lt;/td&gt; &lt;td class=&#34;absent&#34;&gt;T&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;the &lt;em&gt;uppercase&lt;/em&gt; &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; at position 3 in the score denotes that
&lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; is in the &lt;strong&gt;correct&lt;/strong&gt; position (i.e., green üü©);&lt;/li&gt;
&lt;li&gt;the &lt;em&gt;lowercase&lt;/em&gt; &lt;tt class=&#34;docutils literal&#34;&gt;c&lt;/tt&gt; at position 1 in the score denotes that
&lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; is &lt;strong&gt;present&lt;/strong&gt; somewhere in the answer,
but it is in the wrong position (yellow üü®);&lt;/li&gt;
&lt;li&gt;the &lt;tt class=&#34;docutils literal&#34;&gt;.&lt;/tt&gt;s in the score at positions 2, 4, and 5 denote that
the corresponding letters in the guess
(&lt;tt class=&#34;docutils literal&#34;&gt;H&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;S&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt;, respectively)
are &lt;strong&gt;absent&lt;/strong&gt; from the answer (black ‚¨õ).&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&#34;section&#34; id=&#34;deducing-constraints&#34;&gt;
&lt;h3&gt;Deducing Constraints&lt;/h3&gt;
&lt;p&gt;What can we deduce from the first three rows of guesses,
&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;JUDGE=....e&lt;/span&gt; CHEST=c.E.. &lt;span class=&#34;pre&#34;&gt;WRECK=..Ec.&lt;/span&gt;&lt;/tt&gt;?&lt;/p&gt;
&lt;p&gt;There is a set of &lt;em&gt;valid&lt;/em&gt; letters,
&lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt;,
that are either &lt;em&gt;present&lt;/em&gt; (yellow üü®) or &lt;em&gt;correct&lt;/em&gt; (green üü©).
Both &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; start out as present,
but &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; later finds its correct position,
while &lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; does not.&lt;/p&gt;
&lt;p&gt;There is a set of &lt;em&gt;invalid&lt;/em&gt; letters that are
known to be &lt;em&gt;absent&lt;/em&gt; from the answer (black ‚¨õ):
&lt;tt class=&#34;docutils literal&#34;&gt;J&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;U&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;D&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;G&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;H&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;S&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;W&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;R&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;K&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The remaining letters of the alphabet are currently &lt;em&gt;unknown&lt;/em&gt;.
When they are played, they will turn into &lt;em&gt;valid&lt;/em&gt; or &lt;em&gt;invalid&lt;/em&gt; letters.
Unless we already have all five correct letters,
we will draw candidate letters from the unknown pool.&lt;/p&gt;
&lt;p&gt;Furthermore, we know something about &lt;em&gt;letter positions&lt;/em&gt;.
The &lt;em&gt;correct&lt;/em&gt; letters are in the correct positions,
while the &lt;em&gt;present&lt;/em&gt; letters are in the wrong positions.&lt;/p&gt;
&lt;p&gt;A candidate word &lt;em&gt;must&lt;/em&gt;:&lt;/p&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;include all valid letters ‚Äî          &lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;exclude all invalid letters ‚Äî        &lt;tt class=&#34;docutils literal&#34;&gt;JUDGHSTWRK&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;match all ‚Äúcorrect‚Äù positions ‚Äî      &lt;tt class=&#34;docutils literal&#34;&gt;3:E&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;not match any ‚Äúpresent‚Äù positions ‚Äî  &lt;tt class=&#34;docutils literal&#34;&gt;1:C&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;4:C&lt;/tt&gt;, or &lt;tt class=&#34;docutils literal&#34;&gt;5:E&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;These constraints narrow the possible choices from the word list.&lt;/p&gt;
&lt;p&gt;The obvious way to solve this with a computer
is to codify the constraints provided by previous guess‚Äìscore pairs
and run through the entire list of words
to find eligible words.
But no human solves Wordle by methodically examining thousands of words.
Instead, you rack your brain for
‚Äúwhat ends in &lt;tt class=&#34;docutils literal&#34;&gt;SE&lt;/tt&gt; and has an &lt;tt class=&#34;docutils literal&#34;&gt;M&lt;/tt&gt;?‚Äù or
‚ÄúI&#39;ve tried &lt;tt class=&#34;docutils literal&#34;&gt;A&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;I&lt;/tt&gt;; will &lt;tt class=&#34;docutils literal&#34;&gt;O&lt;/tt&gt; or &lt;tt class=&#34;docutils literal&#34;&gt;U&lt;/tt&gt; work?‚Äù or
‚ÄúWhat are the most likely letters left on the keyboard at the bottom?‚Äù&lt;/p&gt;
&lt;p&gt;This article will show you how to solve Wordle programmatically.
It won&#39;t help you much in playing Wordle by hand,
though you may understand more about the game when you&#39;re finished reading.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;prototyping-with-pipes&#34;&gt;
&lt;h3&gt;Prototyping with Pipes&lt;/h3&gt;
&lt;p&gt;Let&#39;s prototype the above constraints with a series of &lt;a class=&#34;reference external&#34; href=&#34;https://www.cyberciti.biz/faq/howto-use-grep-command-in-linux-unix/&#34;&gt;grep&#39;s&lt;/a&gt;
in a &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Pipeline_(Unix)&#34;&gt;Unix pipeline&lt;/a&gt; tailored to this &lt;tt class=&#34;docutils literal&#34;&gt;OCEAN&lt;/tt&gt; example:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# JUDGE=....e CHEST=c.E.. WRECK=..Ec.
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;^.....$&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/usr/share/dict/words&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;  &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# Extract five-letter words
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;tr&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;a-z&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;A-Z&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# Translate each word to uppercase
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;^..E..$&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# Match CORRECT positions
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;awk&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;/C/ &amp;amp;&amp;amp; /E/&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# Match ALL of VALID set, CORRECT|PRESENT
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[JUDGHSTWRK]&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# Exclude INVALID set
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;^[^C]..[^C][^E]$&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;             &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# Exclude PRESENT positions&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;gives:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
ICENI
ILEAC
OCEAN
OLEIC
&lt;/pre&gt;
&lt;p&gt;(This was in Bash, on macOS 13.6.
Zsh doesn&#39;t like the comments in the middle of the multi-line pipeline,
so you may have to omit them.
Other operating systems will have different versions of &lt;tt class=&#34;docutils literal&#34;&gt;/usr/share/dict/words&lt;/tt&gt;
that may not have all of these obscure words.)&lt;/p&gt;
&lt;p&gt;We can accomplish this with only the simplest features of regular expressions:
the &lt;a class=&#34;reference external&#34; href=&#34;https://www.regular-expressions.info/dot.html&#34;&gt;dot metacharacter&lt;/a&gt; (&lt;tt class=&#34;docutils literal&#34;&gt;.&lt;/tt&gt;),
&lt;a class=&#34;reference external&#34; href=&#34;https://www.regular-expressions.info/charclass.html&#34;&gt;character classes&lt;/a&gt; (&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;[JUD...]&lt;/span&gt;&lt;/tt&gt;)
and negated character classes (&lt;tt class=&#34;docutils literal&#34;&gt;[^E]&lt;/tt&gt;),
and the &lt;tt class=&#34;docutils literal&#34;&gt;^&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;$&lt;/tt&gt; &lt;a class=&#34;reference external&#34; href=&#34;https://www.regular-expressions.info/anchors.html&#34;&gt;anchors&lt;/a&gt;.
Awk gives us &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/09/05/RegexConjunctions.html&#34;&gt;regex conjunctions&lt;/a&gt;, allowing us to match &lt;em&gt;all&lt;/em&gt; of the chars.&lt;/p&gt;
&lt;p&gt;The above regular expressions are
a simple mechanical transformation of the guess‚Äìscore pairs.
They could be simplified.
For example, after &lt;tt class=&#34;docutils literal&#34;&gt;grep &lt;span class=&#34;pre&#34;&gt;&#39;^..E..$&#39;&lt;/span&gt;&lt;/tt&gt;,
the &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;awk &#39;/C/ &amp;amp;&amp;amp; /E/&#39;&lt;/tt&gt; is redundant.
We&#39;re not going to optimize the regexes, however.&lt;/p&gt;
&lt;p&gt;Three of the four answers‚Äî&lt;tt class=&#34;docutils literal&#34;&gt;ICENI&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;ILEAC&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;OLEIC&lt;/tt&gt;‚Äîare far too obscure to be Wordle answers.
Actual Wordle answers also exclude simple plurals (&lt;tt class=&#34;docutils literal&#34;&gt;YARDS&lt;/tt&gt;)
and simple past tense (&lt;tt class=&#34;docutils literal&#34;&gt;LIKED&lt;/tt&gt;),
but allow more complex plurals (&lt;tt class=&#34;docutils literal&#34;&gt;BOXES&lt;/tt&gt;)
and irregular past tense (&lt;tt class=&#34;docutils literal&#34;&gt;DWELT&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;BROKE&lt;/tt&gt;).
We make no attempt to judge if an eligible word is &lt;em&gt;likely&lt;/em&gt; as a Wordle answer;
merely that it fits.&lt;/p&gt;
&lt;p&gt;Let&#39;s make a pipeline for Wordle 787 (&lt;tt class=&#34;docutils literal&#34;&gt;INDEX&lt;/tt&gt;):&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# VOUCH=..... GRIPE=..i.e DENIM=deni. WIDEN=.iDEn
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;^.....$&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;/usr/share/dict/words&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;tr&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;a-z&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;A-Z&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;^..DE.$&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# CORRECT pos
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;awk&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;/D/ &amp;amp;&amp;amp; /E/ &amp;amp;&amp;amp; /I/ &amp;amp;&amp;amp; /N/&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# VALID set
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[VOUCHGRPMW]&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;            &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# INVALID set
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;grep&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;^[^D][^EI][^IN][^I][^EN]$&#39;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# PRESENT pos&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;yields:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
INDEX
&lt;/pre&gt;
&lt;p&gt;This approach is promising,
but constructing those regexes by hand is not maintainable.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;word-lists&#34;&gt;
&lt;h3&gt;Word Lists&lt;/h3&gt;
&lt;p&gt;There are several sources of five-letter words.&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Filtering &lt;tt class=&#34;docutils literal&#34;&gt;/usr/share/dict/words&lt;/tt&gt; or similar lists.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/wordle/blob/main/wordle.txt&#34;&gt;wordle.txt&lt;/a&gt;: The nearly 15,000 words that Wordle accepts as entries.
Many of these words are obscure.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/wordle/blob/main/answers.txt&#34;&gt;answers.txt&lt;/a&gt;: The 2,309 words that Wordle uses as answers.
These words are fairly recognizable.
They are a subset of the other list.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The latter two lists were extracted from the source code of the game.
In the various examples below, I use the larger 15,000-word list.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;initial-python-solution&#34;&gt;
&lt;h3&gt;Initial Python Solution&lt;/h3&gt;
&lt;p&gt;Let&#39;s attempt to solve this in Python.
The first piece is to parse a list of &lt;tt class=&#34;docutils literal&#34;&gt;GUESS=SCORE&lt;/tt&gt; pairs.&lt;/p&gt;
&lt;!-- wordle1 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;parse_guesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;                         &lt;span class=&#34;c1&#34;&gt;# Black/Absent&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;                           &lt;span class=&#34;c1&#34;&gt;# Green/Correct or Yellow/Present&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;                       &lt;span class=&#34;c1&#34;&gt;# Exact match for pos (Green/Correct)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# Wrong spot (Yellow/Present)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;=&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;A&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Z&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;GUESS should be uppercase&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;A&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Z&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;z&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;assert&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;upper&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;ne&#34;&gt;ValueError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Unexpected &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; for &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Let&#39;s try it for the &lt;tt class=&#34;docutils literal&#34;&gt;OCEAN&lt;/tt&gt; guesses:&lt;/p&gt;
&lt;pre class=&#34;code pycon literal-block&#34;&gt;
&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parse_guesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;... &lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;JUDGE=....e&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;CHEST=c.E..&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;WRECK=..Ec.&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;invalid={&#39;H&#39;, &#39;K&#39;, &#39;D&#39;, &#39;G&#39;, &#39;T&#39;, &#39;R&#39;, &#39;U&#39;, &#39;W&#39;, &#39;J&#39;, &#39;S&#39;}
valid={&#39;E&#39;, &#39;C&#39;}
mask=[None, None, &#39;E&#39;, None, None]
wrong_spot=[{&#39;C&#39;}, set(), set(), {&#39;C&#39;}, {&#39;E&#39;}]

&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vocab&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;... &lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;is_eligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;... &lt;/span&gt;        &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;...&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;ICENI
ILEAC
OCEAN
OLEIC&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Here&#39;s the &lt;tt class=&#34;docutils literal&#34;&gt;is_eligible&lt;/tt&gt; function.
We &lt;a class=&#34;reference external&#34; href=&#34;https://www.geeksforgeeks.org/short-circuiting-techniques-python/#&#34;&gt;short-circuit the evaluation&lt;/a&gt; and
return as soon as any condition is &lt;tt class=&#34;docutils literal&#34;&gt;False&lt;/tt&gt;.&lt;/p&gt;
&lt;!-- wordle1 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;is_eligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# Missing some &#39;valid&#39; letters from the word;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# all Green/Correct and Yellow/Present letters are required&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;!Valid: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# Some of the Green/Correct letters are not at their positions&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;!Mask: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# Some invalid (Black/Absent) letters are in the word&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Invalid: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ws&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ws&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# We have valid letters in the wrong position (Yellow/Present)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;WrongSpot: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Got: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;converting-to-classes&#34;&gt;
&lt;h3&gt;Converting to Classes&lt;/h3&gt;
&lt;p&gt;Returning four parallel collections from a function is a &lt;a class=&#34;reference external&#34; href=&#34;https://pragmaticways.com/31-code-smells-you-must-know/&#34;&gt;code smell&lt;/a&gt;.
Let&#39;s refactor these functions into a &lt;tt class=&#34;docutils literal&#34;&gt;WordleGuesses&lt;/tt&gt; class.&lt;/p&gt;
&lt;p&gt;First, we&#39;ll need some helper classes:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;WordleError&lt;/tt&gt;: an exception class;&lt;/li&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;TileState&lt;/tt&gt;: a &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/09/02/PythonEnumsWithAttributes.html&#34;&gt;multi-attribute enumeration&lt;/a&gt;;&lt;/li&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;GuessScore&lt;/tt&gt;: a &lt;a class=&#34;reference external&#34; href=&#34;https://realpython.com/python-data-classes/&#34;&gt;dataclass&lt;/a&gt; that manages a guess‚Äìscore pair
and the associated &lt;tt class=&#34;docutils literal&#34;&gt;TileState&lt;/tt&gt;s.&lt;/li&gt;
&lt;li&gt;We&#39;ll also use &lt;a class=&#34;reference external&#34; href=&#34;https://bernat.tech/posts/the-state-of-type-hints-in-python/&#34;&gt;type annotations&lt;/a&gt; because it&#39;s 2023.&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- wordle2 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;5&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;ne&#34;&gt;Exception&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
   &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&amp;quot;&amp;quot;&amp;quot;Base exception class&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;namedtuple&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;TileState&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;value emoji color css_color&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Enum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U0001F7E9&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Green&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;quot;#6aaa64&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U0001F7E8&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Yellow&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;#c9b458&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U00002B1B&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Black&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;quot;#838184&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;nd&#34;&gt;&amp;#64;dataclass&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;GuessScore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;score&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;    &lt;span class=&#34;nd&#34;&gt;&amp;#64;classmethod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_score&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;GuessScore&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_score&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;split&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;=&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tile_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;s&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;    &lt;span class=&#34;nd&#34;&gt;&amp;#64;classmethod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;tile_state&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score_tile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;A&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score_tile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Z&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;a&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score_tile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;lt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;z&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;score_tile&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;raise&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WordleError&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Invalid score: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;score_tile&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__repr__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;score&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;emojis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;separator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;separator&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;emoji&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;For brevity, I presented a minimal version of &lt;tt class=&#34;docutils literal&#34;&gt;GuessScore.make&lt;/tt&gt; above.
The version in my &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/wordle&#34;&gt;Wordle repository&lt;/a&gt; has robust validation.&lt;/p&gt;
&lt;p&gt;Let&#39;s add the main class, &lt;tt class=&#34;docutils literal&#34;&gt;WordleGuesses&lt;/tt&gt;:&lt;/p&gt;
&lt;!-- wordle2 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;nd&#34;&gt;&amp;#64;dataclass&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;      &lt;span class=&#34;c1&#34;&gt;# Exact match for position (Green/Correct)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;             &lt;span class=&#34;c1&#34;&gt;# Green/Correct or Yellow/Present&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;           &lt;span class=&#34;c1&#34;&gt;# Black/Absent&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# Wrong spot (Yellow/Present)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GuessScore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;    &lt;span class=&#34;nd&#34;&gt;&amp;#64;classmethod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;parse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GuessScore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;WordleGuesses&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;&lt;tt class=&#34;docutils literal&#34;&gt;WordleGuesses.parse&lt;/tt&gt; is a bit shorter and clearer than &lt;tt class=&#34;docutils literal&#34;&gt;parse_guesses&lt;/tt&gt;.
It uses &lt;tt class=&#34;docutils literal&#34;&gt;TileState&lt;/tt&gt; at each position
to classify the current tile and
accumulate state in the four member collections.
Since &lt;tt class=&#34;docutils literal&#34;&gt;GuessScore.make&lt;/tt&gt; has validated the input,
&lt;tt class=&#34;docutils literal&#34;&gt;parse&lt;/tt&gt; doesn&#39;t need to do any further validation.&lt;/p&gt;
&lt;p&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;is_eligible&lt;/tt&gt; method is essentially the same as its predecessor:&lt;/p&gt;
&lt;!-- wordle2 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;is_eligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Did not have the full set of green+yellow letters known to be valid&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;!Valid: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Couldn&#39;t find all the green/correct letters&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;!Mask: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Invalid (black) letters are in the word&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Invalid: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ws&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ws&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Found some yellow letters: valid letters in wrong position&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;WrongSpot: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;False&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Potentially valid&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Got: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;%s&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;True&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;find_eligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vocabulary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vocabulary&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_eligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;There&#39;s a &lt;a class=&#34;reference external&#34; href=&#34;https://www.spinellis.gr/blog/20200225/&#34;&gt;famous story&lt;/a&gt; where Donald Knuth
was asked by Jon Bentley to demonstrate &lt;a class=&#34;reference external&#34; href=&#34;http://www.literateprogramming.com/&#34;&gt;literate programming&lt;/a&gt;
by finding the &lt;em&gt;K&lt;/em&gt; most common words from a text file.
Knuth turned in an eight-page gem of WEB, which was reviewed by Doug McIlroy,
who demonstrated that the task could also be accomplished in a six-line pipeline.&lt;/p&gt;
&lt;p&gt;Wordle can also be solved with a six-line pipeline,
but the regexes are quite difficult to type correctly
and they have to be carefully hand tailored
for each set of guess‚Äìscore pairs.
There is no one general six-line pipeline.&lt;/p&gt;
&lt;p&gt;I know that I&#39;d much rather work with these Python classes.
As we&#39;ll see below, they are a solid foundation
that can be built upon in many ways.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;does-it-work&#34;&gt;
&lt;h3&gt;Does it Work?&lt;/h3&gt;
&lt;p&gt;Let&#39;s try it!:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: ARBOR
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;HARES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.ar..&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GUILT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CROAK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.Roa.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BRAVO&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;bRa.o&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;ARBOR&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# answer: CACHE
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CHAIR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Cha..&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CLASH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;C.a.h&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CATCH&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;CA.ch&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;CACHE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;CAHOW&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;# answer: TOXIC
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;LEAKS&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;MIGHT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.i..t&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BLITZ&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..it.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;OPTIC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;o.tIC&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TONIC&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;TO.IC&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;TORIC&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;TOXIC
&lt;/pre&gt;
&lt;p&gt;This looks right
but there are some subtle bugs in the code.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;fifty-is-the-new-witty&#34;&gt;
&lt;h3&gt;Fifty is the new Witty&lt;/h3&gt;
&lt;p&gt;Here we expect to find &lt;tt class=&#34;docutils literal&#34;&gt;FIFTY&lt;/tt&gt;, but no words match:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: FIFTY
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;HARES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BUILT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..i.t&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TIMID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tI...&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PINTO&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.T.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WITTY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.TY&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;--None--
&lt;/pre&gt;
&lt;p&gt;Let&#39;s take a look at the state of the &lt;tt class=&#34;docutils literal&#34;&gt;WordleGuesses&lt;/tt&gt; instance:&lt;/p&gt;
&lt;pre class=&#34;code pycon literal-block&#34;&gt;
&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GuessScore&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;make&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;        &amp;quot;HARES=..... BUILT=..i.t TIMID=tI... PINTO=.I.T. WITTY=.I.TY&amp;quot;.split()]

&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;parse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wg&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;go&#34;&gt;WordleGuesses(mask=[None, &#39;I&#39;, None, &#39;T&#39;, &#39;Y&#39;], valid={&#39;T&#39;, &#39;I&#39;, &#39;Y&#39;}, invalid={
&#39;A&#39;, &#39;E&#39;, &#39;D&#39;, &#39;M&#39;, &#39;U&#39;, &#39;H&#39;, &#39;I&#39;, &#39;B&#39;, &#39;L&#39;, &#39;T&#39;, &#39;P&#39;, &#39;O&#39;, &#39;R&#39;, &#39;W&#39;, &#39;N&#39;, &#39;S&#39;},
wrong_spot=[{&#39;T&#39;}, set(), {&#39;I&#39;}, set(), {&#39;T&#39;}], guess_scores=[GuessScore(guess=&#39;HARES&#39;,
score=&#39;.....&#39;, tiles=[&amp;lt;TileState.ABSENT: TileState(value=3, emoji=&#39;‚¨õ&#39;, color=&#39;Black&#39;,
css_color=&#39;#838184&#39;)&amp;gt;, &amp;lt;TileState.ABSENT: TileState(value=3, emoji=&#39;‚¨õ&#39;, color=&#39;Black&#39;,
css_color=&#39;#838184&#39;)&amp;gt;,
    ... much snipped ...&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;That&#39;s ugly.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;better-string-representation&#34;&gt;
&lt;h3&gt;Better String Representation&lt;/h3&gt;
&lt;p&gt;Let&#39;s write a few helper functions to improve the &lt;tt class=&#34;docutils literal&#34;&gt;__repr__&lt;/tt&gt;:&lt;/p&gt;
&lt;!-- wordle3 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;letter_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;sorted&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;s&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;letter_sets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;[&amp;quot;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;,&amp;quot;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;letter_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;-&amp;quot;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;e&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;]&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;-&amp;quot;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;fm&#34;&gt;__repr__&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letter_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letter_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letter_sets&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;unused&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;letter_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;string&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ascii_uppercase&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;_guess_scores&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;, &amp;quot;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;emojis&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;WordleGuesses(&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;    &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;, &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;)&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Let&#39;s run it again, printing out the instance:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: FIFTY
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;HARES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BUILT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..i.t&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TIMID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tI...&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PINTO&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.T.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WITTY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.TY&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;-I-TY&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ITY&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ABDEHILMNOPRSTUW&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[T,-,I,-,T]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CFGJKQVXZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;HARES=.....|‚¨õ‚¨õ‚¨õ‚¨õ‚¨õ, BUILT=..i.t|‚¨õ‚¨õüü®‚¨õüü®,
        TIMID=tI...|üü®üü©‚¨õ‚¨õ‚¨õ, PINTO=.I.T.|‚¨õüü©‚¨õüü©‚¨õ, WITTY=.I.TY|‚¨õüü©‚¨õüü©üü©&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;--None--
&lt;/pre&gt;
&lt;p&gt;That&#39;s a huge improvement in legibility
over the default string representation!&lt;/p&gt;
&lt;p&gt;There&#39;s a &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; in both &lt;tt class=&#34;docutils literal&#34;&gt;valid&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;invalid&lt;/tt&gt;‚Äîtwo sets that should be mutually exclusive.
The first ‚Äúabsent‚Äù &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; at position 3 in &lt;tt class=&#34;docutils literal&#34;&gt;WITTY&lt;/tt&gt;
has poisoned the second  &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; at position 4, which is ‚Äúcorrect‚Äù.
The &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; at position 1 in &lt;tt class=&#34;docutils literal&#34;&gt;TIMID&lt;/tt&gt; and
the &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; at position 5 in &lt;tt class=&#34;docutils literal&#34;&gt;BUILT&lt;/tt&gt; are ‚Äúpresent‚Äù
because they are the only &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; in those guesses.&lt;/p&gt;
&lt;p&gt;When there are two &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt;s in a guess, but only one &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; in the answer,
one of the &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt;s will either be ‚Äúcorrect‚Äù or ‚Äúpresent‚Äù.
The second, superfluous &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; will be ‚Äúabsent‚Äù.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;first-attempt-at-fixing-the-bug&#34;&gt;
&lt;h3&gt;First Attempt at Fixing the Bug&lt;/h3&gt;
&lt;p&gt;Let&#39;s modify &lt;tt class=&#34;docutils literal&#34;&gt;WordleGuesses.parse&lt;/tt&gt; slightly to address that.
When we get an &lt;tt class=&#34;docutils literal&#34;&gt;ABSENT&lt;/tt&gt; tile,
we should add that letter to &lt;tt class=&#34;docutils literal&#34;&gt;invalid&lt;/tt&gt;
only if it&#39;s not already in &lt;tt class=&#34;docutils literal&#34;&gt;valid&lt;/tt&gt;.&lt;/p&gt;
&lt;!-- wordle4 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;nd&#34;&gt;&amp;#64;classmethod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;parse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GuessScore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;WordleGuesses&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;c1&#34;&gt;# &amp;lt;&amp;lt;&amp;lt; new&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                        &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Does it work? Yes!
Now we have &lt;tt class=&#34;docutils literal&#34;&gt;FIFTY&lt;/tt&gt;.&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: FIFTY
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;HARES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BUILT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..i.t&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TIMID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tI...&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PINTO&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.T.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WITTY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.TY&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;-I-TY&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ITY&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ABDEHLMNOPRSUW&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[T,-,I,-,T]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CFGJKQVXZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;FIFTY&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;JITTY&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;KITTY&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;ZITTY
&lt;/pre&gt;
&lt;p&gt;But we also have &lt;tt class=&#34;docutils literal&#34;&gt;JITTY&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;KITTY&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;ZITTY&lt;/tt&gt;,
which should not been considered eligible
since &lt;tt class=&#34;docutils literal&#34;&gt;WITTY&lt;/tt&gt; was eliminated for the &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; at position 3.
We&#39;ll come back to this soon.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;the-problem-of-repeated-letters&#34;&gt;
&lt;h3&gt;The Problem of Repeated Letters&lt;/h3&gt;
&lt;p&gt;There&#39;s a problem that we haven&#39;t grappled with properly yet:
&lt;em&gt;repeated letters&lt;/em&gt; in a guess or in an answer.
We&#39;ve made an implicit assumption that there are five distinct letters
in each guess and in the answer.&lt;/p&gt;
&lt;p&gt;Here&#39;s an example that fails with the original &lt;tt class=&#34;docutils literal&#34;&gt;parse&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: EMPTY
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;LODGE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;....e&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WIPER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..Pe.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TEPEE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;teP..&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;EXPAT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;E.P.t&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E-P--&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;EPT&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ADEGILORWX&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[T,E,-,E,ET]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;BCFHJKMNQSUVYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;--None--
&lt;/pre&gt;
&lt;p&gt;but works with the current &lt;tt class=&#34;docutils literal&#34;&gt;parse&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: EMPTY
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;LODGE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;....e&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WIPER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..Pe.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TEPEE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;teP..&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;EXPAT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;E.P.t&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E-P--&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;EPT&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ADGILORWX&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[T,E,-,E,ET]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;BCFHJKMNQSUVYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;EMPTS&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;EMPTY
&lt;/pre&gt;
&lt;p&gt;Note that there is no longer an &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;invalid&lt;/tt&gt;.
In &lt;tt class=&#34;docutils literal&#34;&gt;TEPEE=teP..&lt;/tt&gt;, the &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; in position 2 is considered ‚Äúpresent‚Äù,
while the two &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt;s in positions 4 and 5 are marked ‚Äúabsent‚Äù.
This tells us that there is only one &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; in the answer.
Since &lt;tt class=&#34;docutils literal&#34;&gt;P&lt;/tt&gt; is correct in position 3 of &lt;tt class=&#34;docutils literal&#34;&gt;TEPEE&lt;/tt&gt;,
the &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; must be in position 1.
This is confirmed by the subsequent &lt;tt class=&#34;docutils literal&#34;&gt;EXPAT=E.P.t&lt;/tt&gt;,
where the initial &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt; is marked ‚Äúcorrect‚Äù.&lt;/p&gt;
&lt;p&gt;Our previous understanding of ‚Äúabsent‚Äù was too simple.
An ‚Äúabsent‚Äù tile can mean one of two things:&lt;/p&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;This letter is not in the answer at all‚Äîthe usual case.&lt;/li&gt;
&lt;li&gt;If another copy of this letter
is ‚Äúcorrect‚Äù or ‚Äúpresent‚Äù elsewhere in the same guess (i.e., &lt;em&gt;valid&lt;/em&gt;),
the letter is superfluous at this position.
The guess has more instances of this letter than the answer does.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Consider the results here:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: STYLE
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GROAN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WHILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...LE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BELLE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...LE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TUPLE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;t..LE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;STELE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ST.LE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ST-LE&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ELST&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ABGHINOPRUW&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[T,-,-,-,-]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CDFJKMQVXYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;STELE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;STYLE
&lt;/pre&gt;
&lt;p&gt;&lt;tt class=&#34;docutils literal&#34;&gt;STELE&lt;/tt&gt; was an incorrect guess,
so it should not have been offered as an eligible word.
&lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt;&amp;nbsp;is valid in position 5, but wrong in position 3.&lt;/p&gt;
&lt;p&gt;Another example:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: WRITE
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SABER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...er&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;REFIT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;re.it&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TRITE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.RITE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;-RITE&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;EIRT&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ABFS&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[R,E,-,EI,RT]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CDGHJKLMNOPQUVWXYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;TRITE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;URITE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WRITE
&lt;/pre&gt;
&lt;p&gt;&lt;tt class=&#34;docutils literal&#34;&gt;TRITE&lt;/tt&gt; was an incorrect guess,
so it should not have been offered.
&lt;tt class=&#34;docutils literal&#34;&gt;4:T&lt;/tt&gt; is valid, &lt;tt class=&#34;docutils literal&#34;&gt;1:T&lt;/tt&gt; is wrong.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;fixing-repeated-absent-letters&#34;&gt;
&lt;h3&gt;Fixing Repeated Absent Letters&lt;/h3&gt;
&lt;p&gt;We can fix this by making two passes through the tiles
for each guess‚Äìscore pair.&lt;/p&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;Handle ‚Äúcorrect‚Äù and ‚Äúpresent‚Äù tiles as before.&lt;/li&gt;
&lt;li&gt;Add ‚Äúabsent‚Äù tiles to either &lt;tt class=&#34;docutils literal&#34;&gt;invalid&lt;/tt&gt; or &lt;tt class=&#34;docutils literal&#34;&gt;wrong_spot&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We need the second pass to handle a case like &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;WITTY=.I.TY&lt;/span&gt;&lt;/tt&gt;,
where the ‚Äúabsent‚Äù &lt;tt class=&#34;docutils literal&#34;&gt;3:T&lt;/tt&gt; precedes the ‚Äúcorrect‚Äù &lt;tt class=&#34;docutils literal&#34;&gt;4:T&lt;/tt&gt;:
the &lt;tt class=&#34;docutils literal&#34;&gt;valid&lt;/tt&gt; set must be fully updated before we process ‚Äúabsent‚Äù tiles.&lt;/p&gt;
&lt;!-- wordle5 --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;nd&#34;&gt;&amp;#64;classmethod&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;parse&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;GuessScore&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;])&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;WordleGuesses&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;_&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# First pass for correct and present&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Second pass for absent letters&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;enumerate&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                        &lt;span class=&#34;c1&#34;&gt;# There are more instances of `g` in `gs.guess`&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                        &lt;span class=&#34;c1&#34;&gt;# than in the answer&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                        &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                        &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;add&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;cls&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;We can see that &lt;tt class=&#34;docutils literal&#34;&gt;valid&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;invalid&lt;/tt&gt; are disjoint.
The &lt;tt class=&#34;docutils literal&#34;&gt;is_eligible&lt;/tt&gt; method needs no changes.&lt;/p&gt;
&lt;p&gt;Let&#39;s try the &lt;tt class=&#34;docutils literal&#34;&gt;WRITE&lt;/tt&gt; example again:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: WRITE
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SABER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...er&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;REFIT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;re.it&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TRITE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.RITE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;-RITE&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;EIRT&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ABFS&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[RT,E,-,EI,RT]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CDGHJKLMNOPQUVWXYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;URITE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WRITE
&lt;/pre&gt;
&lt;p&gt;There is now a &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; in the first &lt;tt class=&#34;docutils literal&#34;&gt;wrong_spot&lt;/tt&gt; entry.&lt;/p&gt;
&lt;p&gt;And &lt;tt class=&#34;docutils literal&#34;&gt;STYLE&lt;/tt&gt;?&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: STYLE
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GROAN&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WHILE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...LE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BELLE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...LE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TUPLE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;t..LE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;STELE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ST.LE&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ST-LE&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ELST&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ABGHINOPRUW&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[T,E,EL,-,-]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CDFJKMQVXYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;STYLE
&lt;/pre&gt;
&lt;p&gt;Both the second and third &lt;tt class=&#34;docutils literal&#34;&gt;wrong_spot&lt;/tt&gt;s now have an &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt;.
The ‚Äúabsent‚Äù &lt;tt class=&#34;docutils literal&#34;&gt;3:L&lt;/tt&gt; from &lt;tt class=&#34;docutils literal&#34;&gt;BELLE&lt;/tt&gt; is also in the third &lt;tt class=&#34;docutils literal&#34;&gt;wrong_spot&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;What about some other examples?&lt;/p&gt;
&lt;p&gt;In our previous attempt at fixing the bug,
neither &lt;tt class=&#34;docutils literal&#34;&gt;QUICK&lt;/tt&gt; nor &lt;tt class=&#34;docutils literal&#34;&gt;SPICK&lt;/tt&gt; were found
because the first &lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;CHICK&lt;/tt&gt; was ‚Äúabsent‚Äù
and thus marked invalid.
Now, the &lt;tt class=&#34;docutils literal&#34;&gt;valid&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;invalid&lt;/tt&gt; sets are disjoint,
there&#39;s a &lt;tt class=&#34;docutils literal&#34;&gt;C&lt;/tt&gt; in the first element of &lt;tt class=&#34;docutils literal&#34;&gt;wrong_spot&lt;/tt&gt;,
and both words are found:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: QUICK
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;MORAL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TWINE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..I..&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CHICK&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..ICK&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;--ICK&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CIK&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;AEHLMNORTW&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[C,-,-,-,-]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;BDFGJPQSUVXYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;QUICK&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;SPICK
&lt;/pre&gt;
&lt;p&gt;As expected, we find only one answer for &lt;tt class=&#34;docutils literal&#34;&gt;FIFTY&lt;/tt&gt; now:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: FIFTY
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;HARES&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.....&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BUILT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;..i.t&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TIMID&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;tI...&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;PINTO&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.T.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;WITTY&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.I.TY&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;-I-TY&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ITY&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;ABDEHLMNOPRSUW&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[T,-,IT,I,T]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CFGJKQVXZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;FIFTY
&lt;/pre&gt;
&lt;p&gt;The new &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; in the third element of &lt;tt class=&#34;docutils literal&#34;&gt;wrong_spot&lt;/tt&gt;
blocks the rhymes for &lt;tt class=&#34;docutils literal&#34;&gt;WITTY&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;further-optimization-of-the-mask&#34;&gt;
&lt;h3&gt;Further Optimization of the Mask&lt;/h3&gt;
&lt;p&gt;There&#39;s still room for improvement.
If you guess &lt;tt class=&#34;docutils literal&#34;&gt;ANGLE=ANGle&lt;/tt&gt;,
it&#39;s immediately obvious (to a human player) that
you should swap the &lt;tt class=&#34;docutils literal&#34;&gt;L&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;E&lt;/tt&gt;
to guess &lt;tt class=&#34;docutils literal&#34;&gt;ANGEL&lt;/tt&gt; on your next turn.
Or swap the &lt;tt class=&#34;docutils literal&#34;&gt;P&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;SPRAT=SpRAt&lt;/tt&gt; to guess &lt;tt class=&#34;docutils literal&#34;&gt;STRAP&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Similarly, &lt;tt class=&#34;docutils literal&#34;&gt;TENET=TEN.t&lt;/tt&gt; tells you that
the fourth letter of the answer must be &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt;,
while &lt;tt class=&#34;docutils literal&#34;&gt;CHORE=C.OrE&lt;/tt&gt; must have &lt;tt class=&#34;docutils literal&#34;&gt;2:R&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;A more complex example:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: BURLY
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-v&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;LOWER&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;l...r&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;FRAIL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.r..l&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BLURT&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Blur.&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;B----&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;BLRU&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;AEFIOTW&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;[L,LR,U,R,LR]&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CDGHJKMNPQSVXYZ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;R&lt;/tt&gt; is in the wrong spot
in positions 5 (&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;l...r&lt;/span&gt;&lt;/tt&gt;), 2 (&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;.r..l&lt;/span&gt;&lt;/tt&gt;), and 4 (&lt;tt class=&#34;docutils literal&#34;&gt;Blur.&lt;/tt&gt;).
The &lt;tt class=&#34;docutils literal&#34;&gt;B&lt;/tt&gt; is correct in position 1, so &lt;tt class=&#34;docutils literal&#34;&gt;R&lt;/tt&gt; must be in position 3.&lt;/p&gt;
&lt;p&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;L&lt;/tt&gt; is in the wrong spot in positions 1, 5, and 2.
&lt;tt class=&#34;docutils literal&#34;&gt;B&lt;/tt&gt; is in position 1, &lt;tt class=&#34;docutils literal&#34;&gt;R&lt;/tt&gt; is now in 3,
so that leaves only position 4 for &lt;tt class=&#34;docutils literal&#34;&gt;L&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;There remain two possibilities for &lt;tt class=&#34;docutils literal&#34;&gt;U&lt;/tt&gt;‚Äîpositions 2 and 5;
the information contained in &lt;tt class=&#34;docutils literal&#34;&gt;mask&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;wrong_spot&lt;/tt&gt;
is not enough to determine where &lt;tt class=&#34;docutils literal&#34;&gt;U&lt;/tt&gt; should go.&lt;/p&gt;
&lt;p&gt;The original mask, &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;B----&lt;/span&gt;&lt;/tt&gt;, was due to having only one ‚Äúcorrect‚Äù letter.
Using the cumulative information in the guesses and scores,
we can infer a mask of &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;B-RL-&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;In all of these cases,
we can find exactly one remaining position
where a ‚Äúpresent‚Äù letter can be placed.
In the &lt;tt class=&#34;docutils literal&#34;&gt;BURLY&lt;/tt&gt; example, it takes two passes:
we couldn&#39;t uniquely determine a place for &lt;tt class=&#34;docutils literal&#34;&gt;L&lt;/tt&gt;
until we had already placed &lt;tt class=&#34;docutils literal&#34;&gt;R&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Up to now, we&#39;ve been treating each tile in almost complete isolation.
Let&#39;s optimize the mask programmatically.&lt;/p&gt;
&lt;p&gt;To account for repeated letters,
such as the two &lt;tt class=&#34;docutils literal&#34;&gt;T&lt;/tt&gt;s in &lt;tt class=&#34;docutils literal&#34;&gt;TENET=TEN.t&lt;/tt&gt;,
we use Python&#39;s &lt;tt class=&#34;docutils literal&#34;&gt;collections.Counter&lt;/tt&gt; as a &lt;a class=&#34;reference external&#34; href=&#34;https://dbader.org/blog/sets-and-multiset-in-python&#34;&gt;multiset&lt;/a&gt;.
&lt;tt class=&#34;docutils literal&#34;&gt;Counter&lt;/tt&gt;&#39;s union operation, &lt;tt class=&#34;docutils literal&#34;&gt;|=&lt;/tt&gt;,
computes the maximum of corresponding counts.&lt;/p&gt;
&lt;p&gt;First, we loop through &lt;em&gt;all&lt;/em&gt; the guess‚Äìscore pairs,
building a &lt;tt class=&#34;docutils literal&#34;&gt;valid&lt;/tt&gt; multiset of the ‚Äúcorrect‚Äù and ‚Äúpresent‚Äù letters.
Then we subtract a multiset of the ‚Äúcorrect‚Äù letters,
yielding a multiset of the ‚Äúpresent‚Äù letters.&lt;/p&gt;
&lt;p&gt;Second, we loop over &lt;tt class=&#34;docutils literal&#34;&gt;present&lt;/tt&gt;, trying for each letter
to find a single empty position where it can be placed in the mask.
If there is such a position,
we update &lt;tt class=&#34;docutils literal&#34;&gt;mask2&lt;/tt&gt;, remove the letter from &lt;tt class=&#34;docutils literal&#34;&gt;present&lt;/tt&gt;,
and break out of the inner loop.
If there isn&#39;t (as in the two possibilities for &lt;tt class=&#34;docutils literal&#34;&gt;U&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;BURLY&lt;/tt&gt;),
then we use the little-known &lt;a class=&#34;reference external&#34; href=&#34;https://python-notes.curiousefficiency.org/en/latest/python_concepts/break_else.html&#34;&gt;break-else&lt;/a&gt; construct
to exit from the outer loop.&lt;/p&gt;
&lt;p&gt;Finally, we merge &lt;tt class=&#34;docutils literal&#34;&gt;mask2&lt;/tt&gt; into &lt;tt class=&#34;docutils literal&#34;&gt;self.mask&lt;/tt&gt;.
This &lt;tt class=&#34;docutils literal&#34;&gt;optimize&lt;/tt&gt; method is called
from the end of &lt;tt class=&#34;docutils literal&#34;&gt;WordleGuesses.parse&lt;/tt&gt;.&lt;/p&gt;
&lt;!-- wordle --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;optimize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;sd&#34;&gt;&amp;quot;&amp;quot;&amp;quot;Use PRESENT tiles to improve `mask`.&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;mask1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;*&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# Compute `valid`, a multiset of the correct and present letters in all guesses&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Counter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Counter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess_scores&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Counter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;g&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;guess&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;gs&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;tiles&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;correct&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Counter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask1&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# Compute `present`, a multiset of the valid letters&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;c1&#34;&gt;# whose correct position is not yet known; i.e., PRESENT in any row.&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;present&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;correct&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;correct&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;available&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;s2&#34;&gt;&amp;quot;Can `c` be placed in slot `i` of `mask2`?&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;positions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;WORDLE_LEN&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;available&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;# Is there only one position where `c` can be placed?&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;positions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;i&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;positions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;present&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Counter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;i&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; -&amp;gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;# We reach this for-else only if there was no `break` in the for-loop;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;# i.e., no one-element `positions` was found in `present`.&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;c1&#34;&gt;# We must abandon the outer loop, even though `present` is not empty.&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;k&#34;&gt;break&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;debug&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;=}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m2&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;logging&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;info&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\t&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;optimize: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; | &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot; =&amp;gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;mask2&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Here are some examples of it in action.
Going from &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;---ET&lt;/span&gt;&lt;/tt&gt; to &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;-ESET&lt;/span&gt;&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: BESET
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-vv&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CIVET&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...ET&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;EGRET&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;e..ET&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SLEET&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;s.eET&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;---ET,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EST,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;CGILRV,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;ES,-,E,-,-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ABDFHJKMNOPQUWXYZ&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;T&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;S&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;correct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;T&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;S&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;E&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;S&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;None,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;S&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;None,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;None&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;optimize:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;---ET&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-ES--&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-ESET
&lt;/pre&gt;
&lt;p&gt;And from &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;C----&lt;/span&gt;&lt;/tt&gt; to &lt;tt class=&#34;docutils literal&#34;&gt;CLER-&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: CLERK
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-vv&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;SINCE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...ce&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CEDAR&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Ce..r&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CRUEL&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Cr.el&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;C----,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;CELR,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ADINSU,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;-,ER,-,CE,ELR&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;BFGHJKMOPQTVWXYZ&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;C&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;R&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;L&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;correct&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;C&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;({&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;R&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;L&#39;&lt;/span&gt;:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;E&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;4&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;R&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;L&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;present&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;Counter&lt;span class=&#34;o&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask2&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;None,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;L&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;E&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;R&#39;&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;None&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;optimize:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;C----&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-LER-&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&amp;gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;CLER-
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;demanding-an-explanation&#34;&gt;
&lt;h3&gt;Demanding an Explanation&lt;/h3&gt;
&lt;p&gt;Would you like to know &lt;em&gt;why&lt;/em&gt; a guess is ineligible?
We can do that too.&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: ROUSE
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;THIEF&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;...e.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;BLADE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;....E&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;GROVE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.ro.E&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;--words&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;ROMEO&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;PROSE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;STORE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;MURAL&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;ROUSE&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--explain&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;----E,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;EOR,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;ABDFGHILTV,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;-,R,O,E,-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;CJKMNPQSUWXYZ&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;guess_scores:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;THIEF=...e.|‚¨õ‚¨õ‚¨õüü®‚¨õ, BLADE=....E|‚¨õ‚¨õ‚¨õ‚¨õüü©,
                    GROVE=.ro.E|‚¨õüü®üü®‚¨õüü©&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;ROMEO&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Mask:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;needs&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;----E&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;WrongSpot:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;---E-&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;PROSE&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;WrongSpot:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-RO--&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;STORE&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Invalid:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-T---&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;WrongSpot:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--O--&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;MURAL&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Valid:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;missing&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;EO&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;Mask:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;needs&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;----E&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;Invalid:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;---AL&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;ROUSE&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Eligible
&lt;/pre&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
&lt;span class=&#34;c1&#34;&gt;# answer: BIRCH
&lt;/span&gt;$&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;./wordle.py&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;CLAIM&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;c..i.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;TRICE&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;.riC.&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;--words&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;INCUR&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;TAXIS&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;PRICY&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;ERICA&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;BIRCH&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;--explain&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;WordleGuesses&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;---C-,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;CIR,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;AELMT,&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=[&lt;/span&gt;C,R,I,I,-&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;,&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;unused&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;BDFGHJKNOPQSUVWXYZ&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;guess_scores:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&#39;CLAIM=c..i.|üü®‚¨õ‚¨õüü®‚¨õ, TRICE=.riC.|‚¨õüü®üü®üü©‚¨õ&#39;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;INCUR&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Mask:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;needs&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;---C-&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;TAXIS&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Valid:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;missing&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;CR&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;Mask:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;needs&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;---C-&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;Invalid:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;TA---&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;WrongSpot:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;---I-&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;PRICY&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;WrongSpot:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-RI--&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;ERICA&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Invalid:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;E---A&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;WrongSpot:&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;has&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-RI--&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;BIRCH&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;Eligible
&lt;/pre&gt;
&lt;p&gt;Here&#39;s how those explanations were computed,
using a variation on &lt;tt class=&#34;docutils literal&#34;&gt;is_eligible&lt;/tt&gt;:&lt;/p&gt;
&lt;!-- wordle --&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;WordleGuesses&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;is_ineligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;dict&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;missing&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;:=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;letters&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;valid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Did not have the full set of green+yellow letters known to be valid&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Valid&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;missing &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;letter_set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;missing&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;!=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Couldn&#39;t find all the green/correct letters&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Mask&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;needs &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Invalid (black) letters present at specific positions&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;Invalid&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;has &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;invalid&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;wrong&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ws&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;c&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ws&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;zip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong_spot&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;any&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;c1&#34;&gt;# Found some yellow letters: valid letters in wrong position&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;WrongSpot&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;has &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dash_mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;wrong&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;find_explanations_&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vocabulary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;    &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;tuple&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;|&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]]:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;n&#34;&gt;explanations&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;word&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vocabulary&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_ineligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;why&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;None&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;reasons&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                &lt;span class=&#34;n&#34;&gt;why&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;; &amp;quot;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;                    &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;v&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;k&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;v&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_ineligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;items&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;            &lt;span class=&#34;n&#34;&gt;explanations&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;append&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;((&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;why&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;explanations&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;This approach is slower than &lt;tt class=&#34;docutils literal&#34;&gt;is_eligible&lt;/tt&gt;,
though it&#39;s not noticeable
when running &lt;tt class=&#34;docutils literal&#34;&gt;wordle.py&lt;/tt&gt; for one set of guess‚Äìscores.
I have a test tool (&lt;tt class=&#34;docutils literal&#34;&gt;score.py&lt;/tt&gt;)
that runs through the 200+ games that I&#39;ve recorded.
Using &lt;tt class=&#34;docutils literal&#34;&gt;find_explanations&lt;/tt&gt;, it took about 10 seconds to run.
Switching to &lt;tt class=&#34;docutils literal&#34;&gt;find_eligible&lt;/tt&gt;, it dropped to 2 seconds (5x improvement).
By prefiltering the word list with a regex made from the mask,
the time drops to half a second (further 4x improvement).&lt;/p&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;n&#34;&gt;pattern&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;re&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;or&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;m&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parsed_guesses&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;mask&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word_list&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;w&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;vocabulary&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;pattern&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fullmatch&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;w&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;eligible&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;parsed_guesses&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;find_eligible&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;word_list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;finally&#34;&gt;
&lt;h3&gt;Finally&lt;/h3&gt;
&lt;p&gt;I thought I knew a lot about solving Wordle programmatically
when I started this long post a month ago.
As I wrote this,
I realized that I could use a few ugly greps
to accomplish the same thing as my Python code;
wrote a tool to render games as HTML and emojis;
spun off a couple of blog posts on
&lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/09/02/PythonEnumsWithAttributes.html&#34;&gt;multi-attribute enumeration&lt;/a&gt; and &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/09/05/RegexConjunctions.html&#34;&gt;regex conjunctions&lt;/a&gt;;
found and fixed several bugs with repeated letters,
greatly refining my understanding of the nuances;
rewrote the sections on repeated letters repeatedly;
added a means to explain ineligibility;
and had a minor epiphany about optimizing the mask programmatically.&lt;/p&gt;
&lt;p&gt;The full code can be found in my &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/wordle&#34;&gt;Wordle repository&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;other-work&#34;&gt;
&lt;h3&gt;Other Work&lt;/h3&gt;
&lt;p&gt;I found these articles after I completed the final draft of this post.&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Bertsimas and Paskov used &lt;a class=&#34;reference external&#34; href=&#34;https://mitsloan.mit.edu/ideas-made-to-matter/how-algorithm-solves-wordle&#34;&gt;Exact Dynamic Programming&lt;/a&gt;
to find &lt;a class=&#34;reference external&#34; href=&#34;http://wordle-page.s3-website-us-east-1.amazonaws.com/assets/Wordle_Paper_Final.pdf&#34;&gt;An Exact and Interpretable Solution to Wordle&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://yannlandry.photography/blog/wordle-intelligent-solver&#34;&gt;Yann Landry&#39;s Solver&lt;/a&gt; is a little JavaScript and HTML tool
that tries to pick the best next word using a scoring system.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://www.inspiredpython.com/article/solving-wordle-puzzles-with-basic-python&#34;&gt;Solving with Basic Python&lt;/a&gt; makes suggestions for each round
based on word commonality.&lt;/li&gt;
&lt;li&gt;Some &lt;a class=&#34;reference external&#34; href=&#34;https://mashable.com/article/wordle-tips-tricks&#34;&gt;Tips and Tricks&lt;/a&gt; for playing the game.&lt;/li&gt;
&lt;/ul&gt;
&lt;!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -_ --&gt;
&lt;!-- Sticking the Wordle stylesheet at the end out of the way --&gt;
&lt;link rel=&#34;stylesheet&#34; href=&#34;/wordle.css&#34;&gt;&lt;/div&gt;
</description>
        <pubDate>Tue, 26 Sep 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-09-26:/blog/2023/09/26/ExploringWordle.html</guid>
    </item>
        
            <item>
        <title>Regex Conjunctions</title>
        <link>https://www.georgevreilly.com/blog/2023/09/05/RegexConjunctions.html</link>
        <description>&lt;p&gt;Most regular expression engines make it easy to
match &lt;a class=&#34;reference external&#34; href=&#34;https://www.regular-expressions.info/alternation.html&#34;&gt;alternations&lt;/a&gt; (or disjunctions) with the &lt;tt class=&#34;docutils literal&#34;&gt;|&lt;/tt&gt; operator:
to match &lt;em&gt;either&lt;/em&gt; &lt;tt class=&#34;docutils literal&#34;&gt;foo&lt;/tt&gt; &lt;em&gt;or&lt;/em&gt; &lt;tt class=&#34;docutils literal&#34;&gt;bar&lt;/tt&gt;,
use &lt;tt class=&#34;docutils literal&#34;&gt;foo|bar&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Few regex engines have any provisions for &lt;a class=&#34;reference external&#34; href=&#34;https://unix.stackexchange.com/a/55391/4060&#34;&gt;conjunctions&lt;/a&gt;,
and the syntax is often horrible.
Awk makes it easy to match &lt;tt class=&#34;docutils literal&#34;&gt;/pat1/ &amp;amp;&amp;amp; /pat2/ &amp;amp;&amp;amp; /pat3/&lt;/tt&gt;.&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
$ cat &lt;span class=&#34;s&#34;&gt;&amp;lt;&amp;lt;EOF | awk &#39;/bar/ &amp;amp;&amp;amp; /foo/&#39;
&amp;gt; foo bar
&amp;gt; bar
&amp;gt; barfy food
&amp;gt; barfly
&amp;gt; EOF&lt;/span&gt;
foo bar
barfy food
&lt;/pre&gt;
&lt;p&gt;In the case of a Unix pipeline,
the conjunction could also be expressed as a series of pipes:
&lt;tt class=&#34;docutils literal&#34;&gt;... | grep pat1 | grep pat2 | grep pat3 | ...&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2020/04/23/regex-32-problems.html&#34;&gt;longest regex&lt;/a&gt; that I ever encountered
was an enormous alternation‚Äîa true horror that shouldn&#39;t have been a regex at all.&lt;/p&gt;
</description>
        <pubDate>Tue, 05 Sep 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-09-05:/blog/2023/09/05/RegexConjunctions.html</guid>
    </item>
        
            <item>
        <title>Python Enums with Attributes</title>
        <link>https://www.georgevreilly.com/blog/2023/09/02/PythonEnumsWithAttributes.html</link>
        <description>&lt;p&gt;Python &lt;a class=&#34;reference external&#34; href=&#34;https://realpython.com/python-enum/&#34;&gt;enumerations&lt;/a&gt; are useful for grouping related constants in a namespace.
You can add additional behaviors to an enum class,
but there isn&#39;t an easy and obvious way
to add attributes to enum members.&lt;/p&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Enum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Green&amp;quot;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Yellow&amp;quot;&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;elif&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
            &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Black&amp;quot;&lt;/span&gt;

    &lt;span class=&#34;k&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;emoji&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U0001F7E9&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U0001F7E8&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
            &lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U00002B1B&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
        &lt;span class=&#34;p&#34;&gt;}[&lt;/span&gt;&lt;span class=&#34;bp&#34;&gt;self&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Accessing the members and the methods:&lt;/p&gt;
&lt;pre class=&#34;code pycon literal-block&#34;&gt;
&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;span class=&#34;gp&#34;&gt;... &lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;7&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;6&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;emoji&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;gp&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;CORRECT: 1 Green  üü©
PRESENT: 2 Yellow üü®
ABSENT : 3 Black  ‚¨õ&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;You can add methods like &lt;tt class=&#34;docutils literal&#34;&gt;color()&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;emoji()&lt;/tt&gt; above‚Äîyou can even decorate them with &lt;tt class=&#34;docutils literal&#34;&gt;&amp;#64;property&lt;/tt&gt; so that you don&#39;t need parentheses‚Äîbut you have to remember to update &lt;em&gt;every&lt;/em&gt; method
when you add or remove members from the enumeration.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;namedtuples-to-the-rescue&#34;&gt;
&lt;h3&gt;Namedtuples to the rescue&lt;/h3&gt;
&lt;p&gt;It &lt;a class=&#34;reference external&#34; href=&#34;https://stackoverflow.com/a/62601113/6364&#34;&gt;turns out&lt;/a&gt; that you can build a &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2016/01/14/PythonBaseClassOrder.html&#34;&gt;mixin&lt;/a&gt; enumeration
from &lt;a class=&#34;reference external&#34; href=&#34;https://realpython.com/python-namedtuple/&#34;&gt;namedtuple&lt;/a&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;Enum&lt;/tt&gt; that gives terse construction syntax:&lt;/p&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;namedtuple&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;TileState&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;value emoji color css_color&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;Enum&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;):&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;CORRECT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U0001F7E9&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Green&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;quot;#6aaa64&amp;quot;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;PRESENT&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U0001F7E8&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Yellow&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;#c9b458&amp;quot;&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;ABSENT&lt;/span&gt;  &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\U00002B1B&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;Black&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;  &lt;span class=&#34;s2&#34;&gt;&amp;quot;#838184&amp;quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Each member now has multiple read-only attributes,
like &lt;tt class=&#34;docutils literal&#34;&gt;emoji&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;css_color&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;code pycon literal-block&#34;&gt;
&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;TileState&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;span class=&#34;gp&#34;&gt;... &lt;/span&gt;    &lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;7&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;: &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;emoji&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; U+&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;ord&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;emoji&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;05x&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &amp;quot;&lt;/span&gt;
&lt;span class=&#34;gp&#34;&gt;... &lt;/span&gt;          &lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;color&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;:&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;lt;6&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt; &lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ts&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;css_color&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;gp&#34;&gt;...&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;CORRECT: 1 üü© U+1f7e9 Green  #6aaa64
PRESENT: 2 üü® U+1f7e8 Yellow #c9b458
ABSENT : 3 ‚¨õ U+02b1b Black  #838184&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;
</description>
        <pubDate>Sat, 02 Sep 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-09-02:/blog/2023/09/02/PythonEnumsWithAttributes.html</guid>
    </item>
        
            <item>
        <title>Patching a Python Wheel</title>
        <link>https://www.georgevreilly.com/blog/2023/08/10/PatchingAPythonWheel.html</link>
        <description>&lt;p&gt;Recently, I had to create a new &lt;a class=&#34;reference external&#34; href=&#34;https://realpython.com/python-wheels/&#34;&gt;Python wheel&lt;/a&gt; for &lt;a class=&#34;reference external&#34; href=&#34;https://pytorch.org/&#34;&gt;PyTorch&lt;/a&gt;.
There is a &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/pytorch/pytorch/issues/99622&#34;&gt;cyclic dependency&lt;/a&gt; between PyTorch 2.0.1 and Triton 2.0.0:
Torch depends upon Triton, but Triton also depends on Torch.
&lt;a class=&#34;reference external&#34; href=&#34;https://pip.pypa.io/en/latest/&#34;&gt;Pip&lt;/a&gt; is okay with installing packages where there&#39;s a cyclic dependency.
&lt;a class=&#34;reference external&#34; href=&#34;https://bazel.build/&#34;&gt;Bazel&lt;/a&gt;, however, &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/bazelbuild/rules_python/issues/1076&#34;&gt;does not handle&lt;/a&gt; cyclic dependencies between packages.
We use Bazel extensively at Stripe
and this cyclic dependency prevented us from using the latest version of Torch.&lt;/p&gt;
&lt;p&gt;I spent a few days trying to build the PyTorch wheel from source.
It was a &lt;em&gt;nightmare!&lt;/em&gt;
I ran out of disk space on the root partition on my EC2 devbox
trying to install system packages,
so I had to bring up a custom instance.
Then I ran out of space on the main partition,
trying to compile,
so I had to bring up another custom instance.
Then I realized I had installed CUDA 12.1
and couldn&#39;t install CUDA 11.8 over it,
so yet another instance.
Then a long list of other problems.
I was eventually able to get &lt;tt class=&#34;docutils literal&#34;&gt;python setup.py develop&lt;/tt&gt; to execute,
but it took three hours!
And I had little confidence that I was building the same thing
that was in the official wheels.&lt;/p&gt;
&lt;p&gt;Then I had a brainwave:
what if I &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Patch_(computing)&#34;&gt;patch&lt;/a&gt; the official Torch wheel and simply remove the requirement on Triton?
All the officially built code would remain untouched.
That worked!&lt;/p&gt;
&lt;p&gt;This post is adapted from my &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/pytorch/pytorch/issues/99622#issuecomment-1604812054&#34;&gt;writeup on the issue&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;what-is-a-wheel&#34;&gt;
&lt;h3&gt;What is a Wheel?&lt;/h3&gt;
&lt;p&gt;A Python &lt;a class=&#34;reference external&#34; href=&#34;https://packaging.python.org/en/latest/specifications/binary-distribution-format/&#34;&gt;wheel&lt;/a&gt; is a ready-to-install Python package
that requires no compilation at installation time.
Unlike older formats such as source distributions or eggs,
&lt;tt class=&#34;docutils literal&#34;&gt;setup.py&lt;/tt&gt; is not run during installation from a wheel.
The older formats conflated build and install
and required arbitrary code to run.&lt;/p&gt;
&lt;p&gt;A wheel is a &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/ZIP_(file_format)&#34;&gt;Zip archive&lt;/a&gt; with a specially formatted filename
and a &lt;tt class=&#34;docutils literal&#34;&gt;.whl&lt;/tt&gt; extension.
The wheel contains a &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;dist-info&lt;/span&gt;&lt;/tt&gt; metadata directory
and the installable payload.
A wheel is either pure Python,
which can install on any platform,
or a platform (binary) wheel,
which usually contains compiled Python extension code.&lt;/p&gt;
&lt;p&gt;Java JARs, Android APKs, Mozilla XPIs, and many other file types
are also structured Zip archives.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;manual-patching&#34;&gt;
&lt;h3&gt;Manual Patching&lt;/h3&gt;
&lt;p&gt;The wheel file&#39;s &lt;a class=&#34;reference external&#34; href=&#34;https://packaging.python.org/en/latest/specifications/binary-distribution-format/#file-contents&#34;&gt;contents&lt;/a&gt; include the
&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;{distribution}-{version}.dist-info/&lt;/span&gt;&lt;/tt&gt; directory,
which contains metadata about the wheel.&lt;/p&gt;
&lt;p&gt;In the case of PyTorch 2.0.1,
I had &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;torch-2.0.1-cp38-cp38-manylinux1_x86_64.whl&lt;/span&gt;&lt;/tt&gt;,
a Linux &lt;tt class=&#34;docutils literal&#34;&gt;x86_64&lt;/tt&gt; wheel for Python 3.8.&lt;/p&gt;
&lt;p&gt;I used &lt;tt class=&#34;docutils literal&#34;&gt;unzip&lt;/tt&gt; to extract the wheel&#39;s contents into a directory, &lt;tt class=&#34;docutils literal&#34;&gt;torch201.2&lt;/tt&gt;.
(The &lt;tt class=&#34;docutils literal&#34;&gt;.2&lt;/tt&gt; denoted my second attempt.)
In the &lt;tt class=&#34;docutils literal&#34;&gt;torch201.2&lt;/tt&gt; directory was the entire content of the wheel,
including the &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;torch-2.0.1.dist-info/&lt;/span&gt;&lt;/tt&gt; subdirectory.&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
unzip -d torch201.2 torch-2.0.1-cp38-cp38-manylinux1_x86_64.whl
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; torch201.2

&lt;span class=&#34;c1&#34;&gt;# Rename the `dist-info` directory to include &#39;+stripe.2&#39; as a suffix for `2.0.1`
&lt;/span&gt;mv torch-2.0.1&lt;span class=&#34;o&#34;&gt;{&lt;/span&gt;,+stripe.2&lt;span class=&#34;o&#34;&gt;}&lt;/span&gt;.dist-info/
&lt;span class=&#34;nb&#34;&gt;cd&lt;/span&gt; torch-2.0.1+stripe.2.dist-info/
&lt;/pre&gt;
&lt;p&gt;Normally, when we build wheels for forked version of Python packages at Stripe,
we append &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;+stripe.{major}.{commits}.{revision}&lt;/span&gt;&lt;/tt&gt; to the version number.
Both &lt;tt class=&#34;docutils literal&#34;&gt;commits&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;revision&lt;/tt&gt; come from
the output of &lt;tt class=&#34;docutils literal&#34;&gt;git describe &lt;span class=&#34;pre&#34;&gt;--tags&lt;/span&gt; HEAD&lt;/tt&gt;,
which &lt;a class=&#34;reference external&#34; href=&#34;https://git-scm.com/docs/git-describe#_examples&#34;&gt;looks like&lt;/a&gt; &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;{tag}-{commits}-g{revision}&lt;/span&gt;&lt;/tt&gt;;
&lt;tt class=&#34;docutils literal&#34;&gt;major&lt;/tt&gt; is currently hardcoded to &lt;tt class=&#34;docutils literal&#34;&gt;1&lt;/tt&gt;.
This suffix helps distinguish a forked wheel&#39;s version
from the upstream version number.&lt;/p&gt;
&lt;p&gt;Since I wasn&#39;t forking, I used a simplified scheme,
&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;+stripe.{attempt}&lt;/span&gt;&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Then I updated some &lt;a class=&#34;reference external&#34; href=&#34;https://packaging.python.org/en/latest/specifications/core-metadata/&#34;&gt;fields&lt;/a&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;torch-2.0.1+stripe.2.dist-info/METADATA&lt;/span&gt;&lt;/tt&gt;:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Updated &lt;tt class=&#34;docutils literal&#34;&gt;Version&lt;/tt&gt; to include &lt;tt class=&#34;docutils literal&#34;&gt;+stripe.2&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;Removed the &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;Requires-Dist&lt;/span&gt;&lt;/tt&gt; line for &lt;tt class=&#34;docutils literal&#34;&gt;triton&lt;/tt&gt;.
This is the crucial step to fix the cyclic dependency problem.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Now I had to update &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;torch-2.0.1+stripe.2.dist-info/RECORD&lt;/span&gt;&lt;/tt&gt;,
which contains signatures for all the files in the wheel,
in the form &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;{filename},sha256={safe_hash},{filesize}&lt;/span&gt;&lt;/tt&gt;.
Of course, &lt;tt class=&#34;docutils literal&#34;&gt;RECORD&lt;/tt&gt; does not have an entry for itself.&lt;/p&gt;
&lt;p&gt;The paths to all the &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;dist-info&lt;/span&gt;&lt;/tt&gt; files needed to be updated in &lt;tt class=&#34;docutils literal&#34;&gt;RECORD&lt;/tt&gt;
to include the &lt;tt class=&#34;docutils literal&#34;&gt;+stripe.2&lt;/tt&gt; suffix.&lt;/p&gt;
&lt;p&gt;In Vim terms:&lt;/p&gt;
&lt;pre class=&#34;code vim literal-block&#34;&gt;
&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;%s&lt;span class=&#34;sr&#34;&gt;/^\(torch-2.0.1\)\(\.dist-info\)/&lt;/span&gt;\&lt;span class=&#34;m&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;+&lt;/span&gt;stripe.&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;\&lt;span class=&#34;m&#34;&gt;2&lt;/span&gt;/
&lt;/pre&gt;
&lt;p&gt;You can use this &lt;tt class=&#34;docutils literal&#34;&gt;record_hash.py&lt;/tt&gt; script to compute the entry for a file:&lt;/p&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;ch&#34;&gt;#!/usr/bin/env python3&lt;/span&gt;

&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;base64&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;hashlib&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;os&lt;/span&gt;
&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;sys&lt;/span&gt;

&lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;sys&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;argv&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;

&lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;rb&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;digest&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;hashlib&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sha256&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;read&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;
    &lt;span class=&#34;n&#34;&gt;safe_hash&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;base64&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;urlsafe_b64encode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;digest&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;digest&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;decode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;us-ascii&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;rstrip&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;=&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sa&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;,sha256=&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;safe_hash&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;os&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;getsize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filename&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;si&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;The output will look like this:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
$ ../record_hash.py torch-2.0.1+stripe.2.dist-info/METADATA
torch-2.0.1+stripe.2.dist-info/METADATA,sha256&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;StmZkVzCWlHIxaIGVJocXv7JsDnlrSaNXwtuIlE_PKc,24703
&lt;/pre&gt;
&lt;p&gt;Replace the &lt;tt class=&#34;docutils literal&#34;&gt;METADATA&lt;/tt&gt; entry in &lt;tt class=&#34;docutils literal&#34;&gt;RECORD&lt;/tt&gt; with the output from &lt;tt class=&#34;docutils literal&#34;&gt;record_hash.py&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;Finally, you can &lt;tt class=&#34;docutils literal&#34;&gt;zip&lt;/tt&gt; up everything into a new wheel.
Note the &lt;tt class=&#34;docutils literal&#34;&gt;+stripe.2&lt;/tt&gt; in the new wheel&#39;s filename:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
zip ../torch-2.0.1+stripe.2-cp38-cp38-manylinux1_x86_64.whl -r .
&lt;/pre&gt;
&lt;p&gt;At this point, you can upload the wheel to a private repository.&lt;/p&gt;
&lt;p&gt;To install the wheel:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
pip install torch==2.0.1+stripe.2
&lt;/pre&gt;
&lt;p&gt;You will not see &lt;tt class=&#34;docutils literal&#34;&gt;triton&lt;/tt&gt; being installed, unlike before.
However, if you do install &lt;tt class=&#34;docutils literal&#34;&gt;triton&lt;/tt&gt;,
it will be satisfied by this patched version of &lt;tt class=&#34;docutils literal&#34;&gt;torch&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;summary&#34;&gt;
&lt;h3&gt;Summary&lt;/h3&gt;
&lt;p&gt;If you have to manually patch a Python wheel:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Decide upon a suffix, such as &lt;tt class=&#34;docutils literal&#34;&gt;+stripe.2&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;Unzip the wheel.&lt;/li&gt;
&lt;li&gt;Rename the &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;dist-info&lt;/span&gt;&lt;/tt&gt; directory to include the suffix.&lt;/li&gt;
&lt;li&gt;Update &lt;tt class=&#34;docutils literal&#34;&gt;Version&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;METADATA&lt;/tt&gt; to include the suffix.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Make other modifications.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Append the suffix to the &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;dist-info&lt;/span&gt;&lt;/tt&gt; entries in &lt;tt class=&#34;docutils literal&#34;&gt;RECORD&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;Use &lt;tt class=&#34;docutils literal&#34;&gt;record_hash.py&lt;/tt&gt; to compute new entries for all modified files.
Update &lt;tt class=&#34;docutils literal&#34;&gt;RECORD&lt;/tt&gt; accordingly.&lt;/li&gt;
&lt;li&gt;Zip up the new wheel. Include the suffix in the filename.&lt;/li&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;pip install&lt;/tt&gt; the new wheel.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
        <pubDate>Thu, 10 Aug 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-08-10:/blog/2023/08/10/PatchingAPythonWheel.html</guid>
    </item>
        
            <item>
        <title>Bram Moolenaar RIP</title>
        <link>https://www.georgevreilly.com/blog/2023/08/07/BramMoolenaarRIP.html</link>
        <description>&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://www.vim.org/&#34;&gt;&lt;img alt=&#34;Vim&#34; src=&#34;https://www.georgevreilly.com/content/binary/vim-logo-png-transparent.png&#34; style=&#34;width: 250px;&#34;/&gt;&lt;/a&gt;
&lt;p&gt;I woke up on Saturday to read on Bram Moolenaar&#39;s Facebook page
an &lt;a class=&#34;reference external&#34; href=&#34;https://www.facebook.com/bram.moolenaar/posts/pfbid0d7rBdoVZu7Ww2yvmpEjmjJ1B3WYVFf86nFrFXczmRcYzjUxChq3xcjH84zURsZYjl&#34;&gt;announcement&lt;/a&gt; of his death.
I knew Bram online for nearly 30 years and
I was one of his relatively small number of Facebook friends,
but we never met in real life.
I knew that he had retired from Google Zurich to Tenerife,
but I hadn&#39;t been aware that he had been ill.&lt;/p&gt;
&lt;p&gt;Bram was known to the world for his signature creation,
the &lt;a class=&#34;reference external&#34; href=&#34;https://www.vim.org&#34;&gt;Vim text editor&lt;/a&gt;,
used by millions of developers on Linux, macOS, and Windows.
Vim stands for Vi IMproved,
but it outgrew the original &lt;tt class=&#34;docutils literal&#34;&gt;vi&lt;/tt&gt; long ago.&lt;/p&gt;
&lt;p&gt;I was an &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2005/12/30/20YearsOfVi.html&#34;&gt;active contributor&lt;/a&gt; to Vim in the 1990s:
I wrote a lot of the Win32 console mode code
as well as the alpha version of Windows gVim;
my name is at the top of the &lt;a class=&#34;reference external&#34; href=&#34;https://vimhelp.org/os_win32.txt.html&#34;&gt;page&lt;/a&gt; if you do &lt;tt class=&#34;docutils literal&#34;&gt;:help win32&lt;/tt&gt;.
In the 00s, I ported Vim to Win64.
I drifted away from active participation more than a decade ago,
but I still lurk on the &lt;a class=&#34;reference external&#34; href=&#34;https://groups.google.com/g/vim_dev/&#34;&gt;vim_dev&lt;/a&gt; mailing list.&lt;/p&gt;
&lt;p&gt;Vim has been the thoroughly dominant flavor of &lt;tt class=&#34;docutils literal&#34;&gt;vi&lt;/tt&gt;
for a number of years,
but that wasn‚Äôt the case in the 90s.
There were Elvis, vile, xvi, and other things I no longer recall.
Bram built a better &lt;tt class=&#34;docutils literal&#34;&gt;vi&lt;/tt&gt;
and he built a solid community of developers and users.
I never saw the toxic behavior that‚Äôs prevalent in some tech communities.
Bram was always a patient and reasonable leader.
He poured countless hours into making Vim an ever better editor
and he answered so many questions on the various mailing lists.
Vim would not have succeeded half so well without the community that he built.
I didn‚Äôt always agree with Bram&#39;s technical decisions
(and neither did the NeoVim people),
but I have enormous respect for what he accomplished,
technically and socially.&lt;/p&gt;
&lt;p&gt;The other remarkable thing about Vim is that it‚Äôs &lt;a class=&#34;reference external&#34; href=&#34;https://vimdoc.sourceforge.net/htmldoc/uganda.html#license&#34;&gt;charityware&lt;/a&gt;.
Vim users were strongly encouraged to donate to &lt;a class=&#34;reference external&#34; href=&#34;https://iccf-holland.org/&#34;&gt;ICCF Holland&lt;/a&gt;,
which supports children in Kibaale, Uganda.
Bram was the treasurer of ICCF and was involved with the work for many years.
When I was at Microsoft,
I got a bunch of Vim-loving engineers to donate;
Microsoft matched our donations.
I made another donation to ICCF today in his memory.&lt;/p&gt;
&lt;p&gt;It‚Äôs clear that work on Vim will continue.
Although Bram was the benevolent dictator for life of Vim,
a &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/orgs/vim/people&#34;&gt;handful of others&lt;/a&gt; have commit rights
and are planning &lt;a class=&#34;reference external&#34; href=&#34;https://groups.google.com/g/vim_dev/c/dq9Wu5jqVTw/m/puYIETTwAAAJ&#34;&gt;future of the Vim project&lt;/a&gt;.
They have big shoes to fill.
I don‚Äôt know enough about ICCF to say how severely this will affect them.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ETA&lt;/strong&gt;: The upcoming Vim 9.1 release will be &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/vim/vim/pull/12749&#34;&gt;dedicated to Bram&lt;/a&gt;,
just as the &lt;a class=&#34;reference external&#34; href=&#34;https://groups.google.com/g/vim_announce/c/MJBKVd-xrEE/m/joVNaDgAAgAJ&#34;&gt;9.0 release was dedicated to Sven Guckes&lt;/a&gt;, who died last year.
Sven was one of Vim&#39;s greatest ambassadors,
endlessly helpful to users in the newsgroups.
We stayed for a week with Sven in August 2014 in his Berlin apartment,
and he was the most wonderful host,
spending many hours showing us around his beloved city.&lt;/p&gt;
&lt;p&gt;The best articles that I‚Äôve seen about Bram so far:&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://www.theregister.com/2023/08/07/bram_moolenaar_obituary/&#34;&gt;The Reg&#39;s obituary&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://j11g.com/2023/08/07/the-legacy-of-bram-moolenaar/&#34;&gt;The Legacy of Bram Moolenaar&lt;/a&gt;, Jan van den Berg&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://neovim.io/news/2023/08&#34;&gt;Vim Boss&lt;/a&gt;, Justin M. Keyes&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;tt class=&#34;docutils literal&#34;&gt;:wq!&lt;/tt&gt;&lt;/p&gt;
</description>
        <pubDate>Mon, 07 Aug 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-08-07:/blog/2023/08/07/BramMoolenaarRIP.html</guid>
    </item>
        
            <item>
        <title>Cold Brew Coffee Recipe</title>
        <link>https://www.georgevreilly.com/blog/2023/07/24/ColdBrewCoffeeRecipe.html</link>
        <description>&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://www.amazon.com/dp/B00JVSVM36/?tag=georgvreill-20&#34;&gt;&lt;img alt=&#34;Oxo Cold Brew Coffee Maker&#34; class=&#34;right-float&#34; src=&#34;https://images-na.ssl-images-amazon.com/images/P/B00JVSVM36.01.LZZZZZZZ.jpg&#34; style=&#34;width: 300px;&#34;/&gt;&lt;/a&gt;
&lt;p&gt;I often enjoy cold brew coffee in summer.
I bought an &lt;a class=&#34;reference external&#34; href=&#34;https://www.oxo.com/cold-brew-coffee-maker.html&#34;&gt;Oxo Cold Brew Coffee Maker&lt;/a&gt; one winter
when it was on sale at Bed, Bath &amp;amp; Beyond.
Before that, I used a &lt;a class=&#34;reference external&#34; href=&#34;https://www.organiccottonmart.com/blogs/sustainable-lifestyle/nut-milk-bag-vs-cheesecloth&#34;&gt;nut milk bag&lt;/a&gt; in a jar.
I like the Oxo and it gets high marks in many reviews,
such as &lt;a class=&#34;reference external&#34; href=&#34;https://www.homegrounds.co/oxo-cold-brew-coffee-maker-review/&#34;&gt;HomeGrounds&lt;/a&gt; or &lt;a class=&#34;reference external&#34; href=&#34;https://www.nytimes.com/wirecutter/reviews/best-cold-brew-coffee-maker/&#34;&gt;Wirecutter&lt;/a&gt;.
It&#39;s easy to use, easy to clean, and makes a good brew.&lt;/p&gt;
&lt;p&gt;The only downside to making your own cold brew coffee
is that you must plan ahead.
You can make hot coffee in a few minutes,
but cold brew takes hours.&lt;/p&gt;
&lt;p&gt;I have used this recipe for a number of years.
It makes a smooth, less acidic coffee.&lt;/p&gt;
&lt;p&gt;ETA: See also &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2024/10/19/ColdBrewCoffeeFrenchPressRecipe.html&#34;&gt;Cold Brew Coffee Recipe for French Press&lt;/a&gt;.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;ingredients&#34;&gt;
&lt;h3&gt;Ingredients&lt;/h3&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;24 fl oz water&lt;/li&gt;
&lt;li&gt;6 oz fresh &lt;em&gt;coarsely ground&lt;/em&gt; coffee.
Store-bought pre-ground coffee is too fine.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This will half-fill the Oxo jar.
It &lt;strong&gt;yields about 16 fl oz&lt;/strong&gt; (1 pt) of cold brew coffee.
You can double the quantities in the Oxo, if you like.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;instructions&#34;&gt;
&lt;h3&gt;Instructions&lt;/h3&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;Grind the coffee beans coarsely.&lt;/li&gt;
&lt;li&gt;Place the ground coffee in the Oxo jar.&lt;/li&gt;
&lt;li&gt;Pour water through the rain sprinkler top.&lt;/li&gt;
&lt;li&gt;Swirl gently to ensure that all coffee grounds are wet.
(I once followed a recipe that called for vigorous stirring.
Never again!
The grounds absorbed so much more water that I only got half the yield.)&lt;/li&gt;
&lt;li&gt;Some people put the jar in the fridge at this point.
I don&#39;t bother.&lt;/li&gt;
&lt;li&gt;Wait for the coffee to brew!
Some instructions say 12 to 24 hours.
I usually wait 6‚Äì8 hours.&lt;/li&gt;
&lt;li&gt;Put the jar on the stand.
First, make sure that the switch is &lt;em&gt;closed&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;Place the flask under the stand.
Push the switch down to release the brew.&lt;/li&gt;
&lt;li&gt;Let the cold brew coffee drain.
This will take 10‚Äì15 minutes.&lt;/li&gt;
&lt;li&gt;Refrigerate the cold brew.&lt;/li&gt;
&lt;li&gt;Use the coffee grounds to
&lt;a class=&#34;reference external&#34; href=&#34;https://www.southernliving.com/garden/coffee-grounds-for-hydrangeas&#34;&gt;turn hydrangeas blue&lt;/a&gt; or &lt;a class=&#34;reference external&#34; href=&#34;https://www.healthline.com/nutrition/uses-for-coffee-grounds&#34;&gt;exfoliate your skin&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;adjustments&#34;&gt;
&lt;h3&gt;Adjustments&lt;/h3&gt;
&lt;p&gt;You can vary the ratio of coffee to water, the grind, and how long you steep the mixture.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;drinks&#34;&gt;
&lt;h3&gt;Drinks&lt;/h3&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;2 fl oz of cold brew&lt;/li&gt;
&lt;li&gt;6 fl oz milk&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://www.forkinthekitchen.com/how-to-make-cold-brew-coffee/&#34;&gt;Fork in the Kitchen&lt;/a&gt; has some suggestions
if you don&#39;t have a coffee grinder
or an Oxo maker.&lt;/p&gt;
&lt;/div&gt;
</description>
        <pubDate>Mon, 24 Jul 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-07-24:/blog/2023/07/24/ColdBrewCoffeeRecipe.html</guid>
    </item>
        
            <item>
        <title>Compressing Tar Files in Parallel</title>
        <link>https://www.georgevreilly.com/blog/2023/02/21/CompressingTarFilesInParallel.html</link>
        <description>&lt;p&gt;TL;DR: use &lt;tt class=&#34;docutils literal&#34;&gt;tar &lt;span class=&#34;pre&#34;&gt;-I&lt;/span&gt; pigz&lt;/tt&gt; or &lt;tt class=&#34;docutils literal&#34;&gt;tar &lt;span class=&#34;pre&#34;&gt;-I&lt;/span&gt; lbzip2&lt;/tt&gt;
to compress large tar files much more quickly.&lt;/p&gt;
&lt;p&gt;I investigated various ways of compressing a 7GiB tar file.&lt;/p&gt;
&lt;p&gt;The built-in &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;--gzip&lt;/span&gt;&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;--bzip2&lt;/span&gt;&lt;/tt&gt; compression methods in GNU &lt;tt class=&#34;docutils literal&#34;&gt;tar&lt;/tt&gt;
are single-threaded.
If you invoke an external compressor with &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;--use-compress-program&lt;/span&gt;&lt;/tt&gt;,
you can get some huge reductions in compression time,
with slightly worse compression ratios.&lt;/p&gt;
&lt;p&gt;You can use &lt;a class=&#34;reference external&#34; href=&#34;https://zlib.net/pigz/&#34;&gt;pigz&lt;/a&gt; as a parallel replacement for &lt;tt class=&#34;docutils literal&#34;&gt;gzip&lt;/tt&gt;
and &lt;a class=&#34;reference external&#34; href=&#34;https://linux.die.net/man/1/lbzip2&#34;&gt;lbzip2&lt;/a&gt; as a parallel version of &lt;tt class=&#34;docutils literal&#34;&gt;bzip2&lt;/tt&gt;.
Both of them will make heavy use of all the cores in your system,
greatly reducing the &lt;em&gt;real&lt;/em&gt; time relative to the &lt;em&gt;user&lt;/em&gt; time.&lt;/p&gt;
&lt;p&gt;Single-threaded compression timing:
&lt;tt class=&#34;docutils literal&#34;&gt;gzip&lt;/tt&gt; is a lot faster than &lt;tt class=&#34;docutils literal&#34;&gt;bzip2&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
$ time tar --bzip2 -cf huge-bzip2.tar.bz2 hugedir

real    13m15.352s
user    12m53.972s
sys     0m16.029s

$ time tar --gzip -cf huge-gzip.tar.gz hugedir

real    5m56.489s
user    5m30.271s
sys     0m14.633s
&lt;/pre&gt;
&lt;p&gt;&lt;tt class=&#34;docutils literal&#34;&gt;fast&lt;/tt&gt; parallel compression timing:
&lt;tt class=&#34;docutils literal&#34;&gt;pigz&lt;/tt&gt; is the clear winner:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
$ time tar --use-compress-program=&#39;lbzip2 --fast&#39; \
    -cf huge-lbzip2-fast.tar.bz2 hugedir

real    2m35.967s
user    11m38.865s
sys     0m26.981s

$ time tar --use-compress-program=&#39;pigz --fast&#39; \
    -cf huge-pigz-fast.tar.gz hugedir

real    0m58.222s
user    3m22.134s
sys     0m17.357s
&lt;/pre&gt;
&lt;p&gt;&lt;tt class=&#34;docutils literal&#34;&gt;best&lt;/tt&gt; parallel compression timing:
&lt;tt class=&#34;docutils literal&#34;&gt;lbzip2&lt;/tt&gt; is much quicker than &lt;tt class=&#34;docutils literal&#34;&gt;pigz&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
$ time tar --use-compress-program=&#39;lbzip2 --best&#39; \
    -cf huge-lbzip2-best.tar.bz2 hugedir

real    1m44.365s
user    11m38.277s
sys     0m13.551s

$ time tar --use-compress-program=&#39;pigz --best&#39; \
    -cf huge-pigz-best.tar.gz hugedir

real    2m27.694s
user    16m20.441s
sys     0m16.092s
&lt;/pre&gt;
&lt;p&gt;Compressed file sizes:
&lt;tt class=&#34;docutils literal&#34;&gt;bzip2&lt;/tt&gt; family compresses better than &lt;tt class=&#34;docutils literal&#34;&gt;gzip&lt;/tt&gt; family;
&lt;tt class=&#34;docutils literal&#34;&gt;best&lt;/tt&gt; is smaller than default compression level which is smaller than &lt;tt class=&#34;docutils literal&#34;&gt;fast&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
$ ls -lSr
-rw-r--r-- 1 user group 2460438578 Feb 22 03:03 huge-lbzip2-best.tar.bz2
-rw-r--r-- 1 user group 2461172874 Feb 22 03:19 huge-bzip2.tar.bz2
-rw-r--r-- 1 user group 2689784220 Feb 22 03:00 huge-lbzip2-fast.tar.bz2
-rw-r--r-- 1 user group 2691286852 Feb 22 03:06 huge-pigz-best.tar.gz
-rw-r--r-- 1 user group 2704591997 Feb 22 03:25 huge-gzip.tar.gz
-rw-r--r-- 1 user group 2950547862 Feb 22 03:01 huge-pigz-fast.tar.gz
-rw-r--r-- 1 user group 7365222400 Feb 22 03:00 huge.tar
&lt;/pre&gt;
</description>
        <pubDate>Tue, 21 Feb 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-02-21:/blog/2023/02/21/CompressingTarFilesInParallel.html</guid>
    </item>
        
            <item>
        <title>Implementing the Tree command in Rust, part 2: Printing Trees</title>
        <link>https://www.georgevreilly.com/blog/2023/01/24/TreeInRust2PrintingTrees.html</link>
        <description>&lt;p&gt;In &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/01/23/TreeInRust1WalkDirectories.html&#34;&gt;Part 1&lt;/a&gt;, we saw how to walk directory trees,
recursively using &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;fs::read_dir&lt;/span&gt;&lt;/tt&gt;
to construct an in-memory tree of &lt;tt class=&#34;docutils literal&#34;&gt;FileNode&lt;/tt&gt;s.
In Part 2, we&#39;ll implement the rest of the core of the &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Tree_(command)&#34;&gt;tree command&lt;/a&gt;:
printing the directory tree with &lt;a class=&#34;reference external&#34; href=&#34;https://www.compart.com/en/unicode/block/U+2500&#34;&gt;Box Drawing&lt;/a&gt; characters.&lt;/p&gt;
&lt;p&gt;Let&#39;s take a look at some output from &lt;tt class=&#34;docutils literal&#34;&gt;tree&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
.
‚îú‚îÄ‚îÄ alloc.rs
‚îú‚îÄ‚îÄ ascii.rs
‚îú‚îÄ‚îÄ os
‚îÇ&amp;nbsp;&amp;nbsp; ‚îú‚îÄ‚îÄ wasi
‚îÇ&amp;nbsp;&amp;nbsp; ‚îÇ&amp;nbsp;&amp;nbsp; ‚îú‚îÄ‚îÄ ffi.rs
‚îÇ&amp;nbsp;&amp;nbsp; ‚îÇ&amp;nbsp;&amp;nbsp; ‚îú‚îÄ‚îÄ mod.rs          ‚ûä
‚îÇ&amp;nbsp;&amp;nbsp; ‚îÇ&amp;nbsp;&amp;nbsp; ‚îî‚îÄ‚îÄ net             ‚ûã
‚îÇ&amp;nbsp;&amp;nbsp; ‚îÇ&amp;nbsp;&amp;nbsp;     ‚îî‚îÄ‚îÄ mod.rs
‚îÇ&amp;nbsp;&amp;nbsp; ‚îî‚îÄ‚îÄ windows
‚îÇ&amp;nbsp;&amp;nbsp;     ‚îú‚îÄ‚îÄ ffi.rs          ‚ûå
‚îÇ&amp;nbsp;&amp;nbsp;     ‚îú‚îÄ‚îÄ fs.rs
‚îÇ&amp;nbsp;&amp;nbsp;     ‚îú‚îÄ‚îÄ io
‚îÇ&amp;nbsp;&amp;nbsp;     ‚îÇ&amp;nbsp;&amp;nbsp; ‚îî‚îÄ‚îÄ tests.rs
‚îÇ&amp;nbsp;&amp;nbsp;     ‚îú‚îÄ‚îÄ mod.rs
‚îÇ&amp;nbsp;&amp;nbsp;     ‚îî‚îÄ‚îÄ thread.rs
‚îú‚îÄ‚îÄ personality
‚îÇ&amp;nbsp;&amp;nbsp; ‚îú‚îÄ‚îÄ dwarf
‚îÇ&amp;nbsp;&amp;nbsp; ‚îÇ&amp;nbsp;&amp;nbsp; ‚îú‚îÄ‚îÄ eh.rs
‚îÇ&amp;nbsp;&amp;nbsp; ‚îÇ&amp;nbsp;&amp;nbsp; ‚îú‚îÄ‚îÄ mod.rs
‚îÇ&amp;nbsp;&amp;nbsp; ‚îÇ&amp;nbsp;&amp;nbsp; ‚îî‚îÄ‚îÄ tests.rs
‚îÇ&amp;nbsp;&amp;nbsp; ‚îú‚îÄ‚îÄ emcc.rs
‚îÇ&amp;nbsp;&amp;nbsp; ‚îî‚îÄ‚îÄ gcc.rs
‚îî‚îÄ‚îÄ personality.rs
&lt;/pre&gt;
&lt;p&gt;The first thing that we notice is that
most entries at any level, such as ‚ûä,
are preceded by &lt;tt class=&#34;docutils literal&#34;&gt;‚îú‚îÄ‚îÄ&lt;/tt&gt;,
while the last entry, ‚ûã, is preceded by &lt;tt class=&#34;docutils literal&#34;&gt;‚îî‚îÄ‚îÄ&lt;/tt&gt;.
This &lt;a class=&#34;reference external&#34; href=&#34;https://realpython.com/directory-tree-generator-python/&#34;&gt;article&lt;/a&gt; about building a directory tree generator
in Python calls them the &lt;em&gt;tee&lt;/em&gt; and &lt;em&gt;elbow&lt;/em&gt; connectors,
and I&#39;m going to use that terminology.&lt;/p&gt;
&lt;p&gt;The second thing we notice is that there are
multiple &lt;em&gt;prefixes&lt;/em&gt; before the connectors,
either &lt;tt class=&#34;docutils literal&#34;&gt;‚îÇ&amp;nbsp;&amp;nbsp;&lt;/tt&gt;&amp;nbsp;(&lt;em&gt;pipe&lt;/em&gt;) or
&lt;tt class=&#34;docutils literal&#34;&gt;&amp;nbsp;&amp;nbsp; &lt;/tt&gt;&amp;nbsp;(&lt;em&gt;space&lt;/em&gt;),
one prefix for each level.
The rule is that children of a last entry,
such as &lt;tt class=&#34;docutils literal&#34;&gt;os/windows&lt;/tt&gt; ‚ûå, get the space prefix,
while children of other entries,
such as &lt;tt class=&#34;docutils literal&#34;&gt;os/wasi&lt;/tt&gt; or &lt;tt class=&#34;docutils literal&#34;&gt;personality&lt;/tt&gt;,
get the pipe prefix.&lt;/p&gt;
&lt;p&gt;For both connectors and prefixes,
the last entry at a particular level gets special treatment.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;the-print-tree-function&#34;&gt;
&lt;h3&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;print_tree&lt;/tt&gt; function&lt;/h3&gt;
&lt;p&gt;A classic technique with recursion is to create a pair of functions:
an outer public function that calls a private helper function
with the initial set of parameters to visit recursively.&lt;/p&gt;
&lt;p&gt;Our &lt;tt class=&#34;docutils literal&#34;&gt;print_tree&lt;/tt&gt; function uses an inner &lt;tt class=&#34;docutils literal&#34;&gt;visit&lt;/tt&gt; function
to recursively do almost all of the work.&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;print_tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dir&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;Directory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;OTHER_CHILD&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;‚îÇ   &amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// prefix: pipe
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;OTHER_ENTRY&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;‚îú‚îÄ‚îÄ &amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// connector: tee
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FINAL_CHILD&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;    &amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// prefix: no more siblings
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FINAL_ENTRY&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;‚îî‚îÄ‚îÄ &amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// connector: elbow
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;println!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;{}&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                           &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûä&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;visit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;println!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\n&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;{} directories, {} files&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;visit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;Directory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prefix&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;    &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûã&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dirs&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// counting this directory         ‚ûå
&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;: &lt;span class=&#34;kt&#34;&gt;usize&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                         &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûç&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entry&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connector&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FINAL_ENTRY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;OTHER_ENTRY&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûé&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entry&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;DirNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sub_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                     &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûè&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;println!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;{}{}{}&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sub_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_prefix&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;format!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                       &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûê&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                        &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;{}{}&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;count&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;==&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FINAL_CHILD&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;else&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;OTHER_CHILD&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;visit&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sub_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;new_prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;      &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûë&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dirs&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;d&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;LinkNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;symlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;println!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                        &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;{}{}{} -&amp;gt; {}&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;symlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;symlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;FileNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;println!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;{}{}{}&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;prefix&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;connector&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;+=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dirs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                               &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûí&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;The outer function, &lt;tt class=&#34;docutils literal&#34;&gt;print_tree&lt;/tt&gt;,
simply prints the name of the root node on a line by itself;
calls the inner &lt;tt class=&#34;docutils literal&#34;&gt;visit&lt;/tt&gt; function with the &lt;tt class=&#34;docutils literal&#34;&gt;dir&lt;/tt&gt; node and an empty prefix;
and finally prints the number of directories and files visited.
This is for compatibility with the output of &lt;tt class=&#34;docutils literal&#34;&gt;tree&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;The inner &lt;tt class=&#34;docutils literal&#34;&gt;visit&lt;/tt&gt; function takes two parameters:
&lt;tt class=&#34;docutils literal&#34;&gt;node&lt;/tt&gt;, a &lt;tt class=&#34;docutils literal&#34;&gt;Directory&lt;/tt&gt;, and
&lt;tt class=&#34;docutils literal&#34;&gt;prefix&lt;/tt&gt;, a string which is initially empty.&lt;/li&gt;
&lt;li&gt;Keep track of the number of &lt;tt class=&#34;docutils literal&#34;&gt;dirs&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;files&lt;/tt&gt; seen at this level
and in sub-directories.&lt;/li&gt;
&lt;li&gt;We count downwards from the number of entries in this directory to zero.
When &lt;tt class=&#34;docutils literal&#34;&gt;count&lt;/tt&gt; is zero, we are on the last entry, which gets special treatment.&lt;/li&gt;
&lt;li&gt;Compute the connector,
&lt;tt class=&#34;docutils literal&#34;&gt;‚îî‚îÄ‚îÄ&lt;/tt&gt; (&lt;em&gt;elbow&lt;/em&gt;) for the last entry;
&lt;tt class=&#34;docutils literal&#34;&gt;‚îú‚îÄ‚îÄ&lt;/tt&gt; (&lt;em&gt;tee&lt;/em&gt;) otherwise.&lt;/li&gt;
&lt;li&gt;Match the &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;FileTree::DirNode&lt;/span&gt;&lt;/tt&gt; variant
and &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/reference/patterns.html#destructuring&#34;&gt;destructure&lt;/a&gt; the value into &lt;tt class=&#34;docutils literal&#34;&gt;sub_dir&lt;/tt&gt;, a &lt;tt class=&#34;docutils literal&#34;&gt;&amp;amp;Directory&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;Before recursively visiting a sub-directory,
we compute a new prefix,
by appending the appropriate sub-prefix to the current prefix.
If there are further entries (&lt;tt class=&#34;docutils literal&#34;&gt;count &amp;gt; 0&lt;/tt&gt;),
the sub-prefix for the current level is &lt;tt class=&#34;docutils literal&#34;&gt;‚îÇ&amp;nbsp;&amp;nbsp;&lt;/tt&gt;&amp;nbsp;(&lt;em&gt;pipe&lt;/em&gt;);
otherwise, it&#39;s &lt;tt class=&#34;docutils literal&#34;&gt;&amp;nbsp;&amp;nbsp; &lt;/tt&gt;&amp;nbsp;(&lt;em&gt;spaces&lt;/em&gt;).&lt;/li&gt;
&lt;li&gt;Call &lt;tt class=&#34;docutils literal&#34;&gt;visit&lt;/tt&gt; recursively, then add to the
running totals of &lt;tt class=&#34;docutils literal&#34;&gt;dirs&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;files&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;visit&lt;/tt&gt; returns a tuple of the counts of directories and files
that were recursively visited.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;One subtlety that is not obvious from the above is that
&lt;tt class=&#34;docutils literal&#34;&gt;OTHER_CHILD&lt;/tt&gt; actually contains two &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Non-breaking_space&#34;&gt;non-breaking spaces&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;const&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;OTHER_CHILD&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;‚îÇ&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\u{00A0}\u{00A0}&lt;/span&gt;&lt;span class=&#34;s&#34;&gt; &amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;c1&#34;&gt;// prefix: pipe&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;This is for compatibility with the output of &lt;tt class=&#34;docutils literal&#34;&gt;tree&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
$ diff &amp;lt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;cargo run -q -- ./tests&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &amp;lt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;tree ./tests&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;quot;no difference&amp;quot;&lt;/span&gt;
no difference
&lt;/pre&gt;
&lt;p&gt;Using &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2022/01/31/DiffFileFragment.html&#34;&gt;process substitution&lt;/a&gt; to generate two different inputs for &lt;tt class=&#34;docutils literal&#34;&gt;diff&lt;/tt&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;the-main-function&#34;&gt;
&lt;h3&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;main&lt;/tt&gt; function&lt;/h3&gt;
&lt;p&gt;Let&#39;s tie it all together.&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;main&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;io&lt;/span&gt;::&lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;env&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;args&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;nth&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;   &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûä&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dir&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;Directory&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dir_walk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                              &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûã&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;PathBuf&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;from&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;clone&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                           &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûå&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_not_hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sort_by_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                         &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûç&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;print_tree&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                    &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûé&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                                      &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûè&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;The simplest possible way to get a single, optional command-line argument.
If omitted, we default to &lt;tt class=&#34;docutils literal&#34;&gt;.&lt;/tt&gt;, the current directory.
For more sophisticated argument parsing, we could use &lt;a class=&#34;reference external&#34; href=&#34;https://docs.rs/clap/latest/clap/&#34;&gt;Clap&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Use &lt;tt class=&#34;docutils literal&#34;&gt;dir_walk&lt;/tt&gt; from &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/01/23/TreeInRust1WalkDirectories.html&#34;&gt;Part 1&lt;/a&gt; to recursively build
a directory of &lt;tt class=&#34;docutils literal&#34;&gt;FileTree&lt;/tt&gt; nodes.&lt;/li&gt;
&lt;li&gt;Create a &lt;tt class=&#34;docutils literal&#34;&gt;PathBuf&lt;/tt&gt; from &lt;tt class=&#34;docutils literal&#34;&gt;root&lt;/tt&gt;, a string;
&lt;tt class=&#34;docutils literal&#34;&gt;clone&lt;/tt&gt; is needed because &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;PathBuf::from&lt;/span&gt;&lt;/tt&gt; takes ownership of the string buffer.
Use the &lt;tt class=&#34;docutils literal&#34;&gt;is_not_hidden&lt;/tt&gt; filter and the &lt;tt class=&#34;docutils literal&#34;&gt;sort_by_name&lt;/tt&gt; comparator from &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/01/23/TreeInRust1WalkDirectories.html&#34;&gt;Part 1&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;The &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/reference/expressions/operator-expr.html#the-question-mark-operator&#34;&gt;postfix question mark operator&lt;/a&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;?&lt;/tt&gt;, is used to propagate errors.&lt;/li&gt;
&lt;li&gt;Let &lt;tt class=&#34;docutils literal&#34;&gt;print_tree&lt;/tt&gt; draw the diagram.&lt;/li&gt;
&lt;li&gt;Return the &lt;tt class=&#34;docutils literal&#34;&gt;Ok&lt;/tt&gt; &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/std/primitive.unit.html&#34;&gt;unit&lt;/a&gt; result to indicate success.&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;baum&#34;&gt;
&lt;h3&gt;Baum&lt;/h3&gt;
&lt;p&gt;You can find the &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/georgevreilly/baum&#34;&gt;Baum&lt;/a&gt; source code on GitHub.&lt;/p&gt;
&lt;p&gt;In Part 3, we&#39;ll discuss testing.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;resources&#34;&gt;
&lt;h3&gt;Resources&lt;/h3&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://github.com/Old-Man-Programmer/tree/&#34;&gt;Official tree source&lt;/a&gt;:
The actual source for &lt;tt class=&#34;docutils literal&#34;&gt;tree&lt;/tt&gt;, written in old-school C.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://two-wrongs.com/draw-a-tree-structure-with-only-css.html&#34;&gt;Draw a Tree Structure With Only CSS&lt;/a&gt;:
Use CSS to draw links in nested, unordered lists.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://realpython.com/directory-tree-generator-python/&#34;&gt;Build a Python Directory Tree Generator for the Command Line&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Kevin Newton has implemented &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/kddnewton/tree&#34;&gt;Tree in Multiple Languages&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://github.com/dduan/tre&#34;&gt;Tre&lt;/a&gt; is a modern alternative to &lt;tt class=&#34;docutils literal&#34;&gt;tree&lt;/tt&gt; in Rust.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
        <pubDate>Tue, 24 Jan 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-01-24:/blog/2023/01/24/TreeInRust2PrintingTrees.html</guid>
    </item>
        
            <item>
        <title>Implementing the Tree command in Rust, part 1: Walking Directories</title>
        <link>https://www.georgevreilly.com/blog/2023/01/23/TreeInRust1WalkDirectories.html</link>
        <description>&lt;img alt=&#34;tree tree core/src/num for Rust&#34; class=&#34;right-float&#34; src=&#34;https://www.georgevreilly.com/content/binary/rust-core-src-num-tree.png&#34; style=&#34;width: 160px;&#34;/&gt;
&lt;p&gt;I&#39;ve been learning Rust lately.
I started by reading several books,
including &lt;a class=&#34;reference external&#34; href=&#34;https://www.manning.com/books/rust-in-action&#34;&gt;Rust in Action&lt;/a&gt;,
&lt;a class=&#34;reference external&#34; href=&#34;https://www.manning.com/books/code-like-a-pro-in-rust&#34;&gt;Code Like a Pro in Rust&lt;/a&gt;,
and most of &lt;a class=&#34;reference external&#34; href=&#34;https://learning.oreilly.com/library/view/programming-rust-2nd/9781492052586/&#34;&gt;Programming Rust&lt;/a&gt;.
Now, I&#39;m starting to actually write code.&lt;/p&gt;
&lt;p&gt;I read the &lt;a class=&#34;reference external&#34; href=&#34;https://www.goodreads.com/review/show/5183138397&#34;&gt;Command-Line Rust&lt;/a&gt; book last month,
which challenged readers to write
our own implementations of the &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Tree_(command)&#34;&gt;tree command&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I decided to accept the challenge.&lt;/p&gt;
&lt;p&gt;At its simplest, &lt;tt class=&#34;docutils literal&#34;&gt;tree&lt;/tt&gt; simply prints a directory tree,
using some of the Unicode &lt;a class=&#34;reference external&#34; href=&#34;https://www.compart.com/en/unicode/block/U+2500&#34;&gt;Box Drawing&lt;/a&gt; characters
to show the hierarchical relationship,
as in the image at right.&lt;/p&gt;
&lt;p&gt;I&#39;ve split the code into two phases,
which will be covered in two blog posts.&lt;/p&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;Walking the directory tree on disk to build an in-memory tree.&lt;/li&gt;
&lt;li&gt;Pretty-printing the in-memory tree.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;While it&#39;s certainly possible to print a subtree as it&#39;s being read,
separating the two phases
yields code that is cleaner, simpler, and more testable.&lt;/p&gt;
&lt;p&gt;In future, I will insert a third phase, &lt;em&gt;processing&lt;/em&gt;,
between the reading and writing phases,
by a weak analogy with Extract-Transform-Load (&lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Extract,_transform,_load&#34;&gt;ETL&lt;/a&gt;).&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;walking-the-directory-tree&#34;&gt;
&lt;h3&gt;Walking the Directory Tree&lt;/h3&gt;
&lt;p&gt;There are three kinds of file tree node that I care about:
&lt;tt class=&#34;docutils literal&#34;&gt;File&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;Directory&lt;/tt&gt;, and &lt;tt class=&#34;docutils literal&#34;&gt;Symlink&lt;/tt&gt;.
These are the variants exposed by Rust&#39;s &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/std/fs/struct.FileType.html&#34;&gt;FileType&lt;/a&gt;.&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;File&lt;/tt&gt; has a name and file system metadata;&lt;/li&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;Symlink&lt;/tt&gt; has a name, a target, and metadata;&lt;/li&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;Directory&lt;/tt&gt; has a name and a list of child file tree nodes.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Here, &lt;em&gt;name&lt;/em&gt; refers to the last component of a path;
e.g., the &lt;tt class=&#34;docutils literal&#34;&gt;gamma&lt;/tt&gt; in &lt;tt class=&#34;docutils literal&#34;&gt;alpha/beta/gamma&lt;/tt&gt;.
The file system metadata is not currently used,
but will be in future.&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;cp&#34;&gt;#[derive(Debug)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;File&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metadata&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[derive(Debug)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Symlink&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metadata&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;Metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;

&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;#[derive(Debug)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;struct&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;Directory&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;File and directory paths are not guaranteed to be UTF-8.
Indeed, Unix file paths are an arbitrary sequence of bytes,
while Windows file paths are an opaque sequence of 16-bit integers.
You might think that I should be using &lt;tt class=&#34;docutils literal&#34;&gt;OsString&lt;/tt&gt; here,
since it holds a &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/std/ffi/struct.OsString.html&#34;&gt;platform-native string&lt;/a&gt;.
&lt;tt class=&#34;docutils literal&#34;&gt;String&lt;/tt&gt; has to be valid UTF-8; &lt;tt class=&#34;docutils literal&#34;&gt;OsString&lt;/tt&gt; doesn&#39;t.
Unfortunately, it&#39;s not easy to look at the actual data in an &lt;tt class=&#34;docutils literal&#34;&gt;OsString&lt;/tt&gt;,
unless you convert it (possibly lossily) to a &lt;tt class=&#34;docutils literal&#34;&gt;String&lt;/tt&gt;.
See &lt;a class=&#34;reference external&#34; href=&#34;https://docs.rs/bstr/0.2.8/bstr/#file-paths-and-os-strings&#34;&gt;File paths and OS strings&lt;/a&gt; for more.&lt;/p&gt;
&lt;p&gt;The obvious way to represent a file tree node in Rust
is as an &lt;a class=&#34;reference external&#34; href=&#34;https://hashrust.com/blog/why-rust-enums-are-so-cool/&#34;&gt;enum&lt;/a&gt; with three tuple-like variants.&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;cp&#34;&gt;#[derive(Debug)]&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;enum&lt;/span&gt; &lt;span class=&#34;nc&#34;&gt;FileTree&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;DirNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Directory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;File&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;LinkNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Symlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Here, each variant in the enum holds a struct of similar name.
We will be able to take advantage of Rust&#39;s &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/book/ch18-03-pattern-syntax.html#destructuring-enums&#34;&gt;pattern matching&lt;/a&gt;
to handle each variant.&lt;/p&gt;
&lt;p&gt;We&#39;ll use &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;fs::read_dir&lt;/span&gt;&lt;/tt&gt; to read each directory in the hierarchy.
The &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/std/fs/struct.ReadDir.html&#34;&gt;read_dir&lt;/a&gt; function returns an iterator
that yields instances of &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;io::Result&amp;lt;DirEntry&amp;gt;&lt;/span&gt;&lt;/tt&gt;.
If a &lt;tt class=&#34;docutils literal&#34;&gt;DirEntry&lt;/tt&gt; is a directory,
we can recursively invoke our &lt;tt class=&#34;docutils literal&#34;&gt;dir_walk&lt;/tt&gt; function
to read the child directory
and add its contents to our in-memory tree.&lt;/p&gt;
&lt;p&gt;The &lt;a class=&#34;reference external&#34; href=&#34;https://docs.rs/walkdir/latest/walkdir/&#34;&gt;walkdir&lt;/a&gt; crate also walks through a directory tree,
but it hides the recursion from you.
It&#39;s an excellent choice otherwise.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;skipping-and-sorting&#34;&gt;
&lt;h4&gt;Skipping and Sorting&lt;/h4&gt;
&lt;p&gt;In each directory that we read,
we need to consider two factors.&lt;/p&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;Which entries to skip, such as hidden files.&lt;/li&gt;
&lt;li&gt;How to sort the entries.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We almost always want to skip &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Hidden_file_and_hidden_directory&#34;&gt;hidden files and directories&lt;/a&gt;‚Äîon Unix, those entries whose names start with the &lt;tt class=&#34;docutils literal&#34;&gt;.&lt;/tt&gt; character.
Every directory includes entries
for &lt;tt class=&#34;docutils literal&#34;&gt;.&lt;/tt&gt; (itself) and &lt;tt class=&#34;docutils literal&#34;&gt;..&lt;/tt&gt; (parent directory),
and may include other hidden files or directories,
such as &lt;tt class=&#34;docutils literal&#34;&gt;.vimrc&lt;/tt&gt; or &lt;tt class=&#34;docutils literal&#34;&gt;.git&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;On Windows, hidden files are controlled by an &lt;a class=&#34;reference external&#34; href=&#34;https://www.raymond.cc/blog/reset-system-and-hidden-attributes-for-files-or-folders-caused-by-virus/&#34;&gt;attribute&lt;/a&gt;, not by their name.&lt;/p&gt;
&lt;p&gt;For more complicated usage,
we might want to skip &lt;a class=&#34;reference external&#34; href=&#34;https://git-scm.com/docs/gitignore&#34;&gt;ignored files&lt;/a&gt;,
as specified in &lt;tt class=&#34;docutils literal&#34;&gt;.gitignore&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The simplest useful filter for entry names
is one that rejects hidden files and directories.&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;is_not_hidden&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;return&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;starts_with&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;sc&#34;&gt;&#39;.&#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;Disk I/O is &lt;a class=&#34;reference external&#34; href=&#34;https://louwrentius.com/understanding-storage-performance-iops-and-latency.html&#34;&gt;costly and slow&lt;/a&gt;, compared to memory access.
It&#39;s far more efficient to not read a directory at all
than it is to eliminate a subtree at a later stage.
Even if the OS has cached the relevant directory contents,
there&#39;s still a &lt;a class=&#34;reference external&#34; href=&#34;https://gms.tf/on-the-costs-of-syscalls.html&#34;&gt;cost to the syscall&lt;/a&gt; to retrieve that data from the kernel.&lt;/p&gt;
&lt;p&gt;There is &lt;a class=&#34;reference external&#34; href=&#34;https://stackoverflow.com/a/8977490/6364&#34;&gt;no specific order&lt;/a&gt; to entries in a directory
or to the results returned by low-level APIs like &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;fs::read_dir&lt;/span&gt;&lt;/tt&gt;.
By default, &lt;tt class=&#34;docutils literal&#34;&gt;ls&lt;/tt&gt; sorts entries alphabetically,
but it can also sort by creation time, modification time, or size,
in ascending or descending order.&lt;/p&gt;
&lt;p&gt;Unix filesystems are case-sensitive,
but Mac filesystems (APFS and HFS+) are case-insensitive by default,
although they preserve the case of the original filename.
Windows&#39; filesystems (NTFS, exFAT, and FAT32)
are &lt;a class=&#34;reference external&#34; href=&#34;https://learn.microsoft.com/en-us/windows/win32/fileio/filesystem-functionality-comparison&#34;&gt;likewise&lt;/a&gt; case-preserving and case-insensitive.&lt;/p&gt;
&lt;p&gt;Here is a case-sensitive &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/std/vec/struct.Vec.html#method.sort_by&#34;&gt;comparator&lt;/a&gt; for use with &lt;tt class=&#34;docutils literal&#34;&gt;sort_by&lt;/tt&gt;:&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;sort_by_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;DirEntry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;DirEntry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Ordering&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a_name&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;     &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûä&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b_name&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;cmp&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                             &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûã&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;This messy expression is necessary to get the &lt;em&gt;name&lt;/em&gt; as a &lt;tt class=&#34;docutils literal&#34;&gt;String&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;cmp&lt;/tt&gt; returns &lt;tt class=&#34;docutils literal&#34;&gt;Less&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;Equal&lt;/tt&gt;, or &lt;tt class=&#34;docutils literal&#34;&gt;Greater&lt;/tt&gt; from the &lt;tt class=&#34;docutils literal&#34;&gt;Ordering&lt;/tt&gt; enum.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;More on &lt;tt class=&#34;docutils literal&#34;&gt;Ordering&lt;/tt&gt; &lt;a class=&#34;reference external&#34; href=&#34;https://www.philipdaniels.com/blog/2019/rust-equality-and-ordering/&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;the-dir-walk-function&#34;&gt;
&lt;h3&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;dir_walk&lt;/tt&gt; function&lt;/h3&gt;
&lt;p&gt;Finally, the recursive &lt;tt class=&#34;docutils literal&#34;&gt;dir_walk&lt;/tt&gt; function that
creates the tree of &lt;tt class=&#34;docutils literal&#34;&gt;FileTree&lt;/tt&gt; nodes.&lt;/p&gt;
&lt;pre class=&#34;code rust literal-block&#34;&gt;
&lt;span class=&#34;k&#34;&gt;pub&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;fn&lt;/span&gt; &lt;span class=&#34;nf&#34;&gt;dir_walk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;PathBuf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filter&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;fn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;kt&#34;&gt;str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;kt&#34;&gt;bool&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                 &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûä&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compare&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;fn&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;a&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;DirEntry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;b&lt;/span&gt;: &lt;span class=&#34;kp&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;nc&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;DirEntry&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;Ordering&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;-&amp;gt; &lt;span class=&#34;nc&#34;&gt;io&lt;/span&gt;::&lt;span class=&#34;nb&#34;&gt;Result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Directory&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;DirEntry&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;read_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filter_map&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;|&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;result&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;())&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;collect&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                 &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûã&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;sort_by&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compare&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;mut&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;directory&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Vec&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;with_capacity&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;len&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;());&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;          &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûå&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;for&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;in&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;e&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;nb&#34;&gt;String&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;!&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                         &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûç&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;continue&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;match&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                     &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûé&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_dir&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;DirNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                  &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûè&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                    &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;dir_walk&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;join&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;filter&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;compare&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;?&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_symlink&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;LinkNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Symlink&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;target&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;fs&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;read_link&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;).&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string_lossy&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;().&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_string&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metadata&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;k&#34;&gt;if&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;path&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;is_file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;FileTree&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;FileNode&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;File&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
                &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;metadata&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;metadata&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
            &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;_&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&amp;gt;&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;fm&#34;&gt;unreachable!&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(),&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;};&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;directory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;push&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;node&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;kd&#34;&gt;let&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;root&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;file_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap_or&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;OsStr&lt;/span&gt;::&lt;span class=&#34;n&#34;&gt;new&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;quot;.&amp;quot;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                 &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûê&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;to_str&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;unwrap&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;into&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;();&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;Ok&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;Directory&lt;/span&gt;&lt;span class=&#34;w&#34;&gt; &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;                                  &lt;/span&gt;&lt;span class=&#34;err&#34;&gt;‚ûë&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;name&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
        &lt;/span&gt;&lt;span class=&#34;n&#34;&gt;entries&lt;/span&gt;: &lt;span class=&#34;nc&#34;&gt;directory&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
    &lt;/span&gt;&lt;span class=&#34;p&#34;&gt;})&lt;/span&gt;&lt;span class=&#34;w&#34;&gt;
&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/pre&gt;
&lt;ol class=&#34;arabic simple&#34;&gt;
&lt;li&gt;Currently, the &lt;tt class=&#34;docutils literal&#34;&gt;filter&lt;/tt&gt; and &lt;tt class=&#34;docutils literal&#34;&gt;compare&lt;/tt&gt; parameters are &lt;tt class=&#34;docutils literal&#34;&gt;fn&lt;/tt&gt;s.
They could probably be &lt;tt class=&#34;docutils literal&#34;&gt;FnMut&lt;/tt&gt; traits.&lt;/li&gt;
&lt;li&gt;Read directory.
Discard any &lt;tt class=&#34;docutils literal&#34;&gt;Error&lt;/tt&gt; results.
Collect into a &lt;tt class=&#34;docutils literal&#34;&gt;Vec&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;We&#39;ll need at most this many entries.&lt;/li&gt;
&lt;li&gt;Use &lt;tt class=&#34;docutils literal&#34;&gt;filter&lt;/tt&gt; to discard names that won&#39;t be visited.&lt;/li&gt;
&lt;li&gt;Match the path as a &lt;tt class=&#34;docutils literal&#34;&gt;DirNode&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;LinkNode&lt;/tt&gt;, or &lt;tt class=&#34;docutils literal&#34;&gt;FileNode&lt;/tt&gt;,
by using &lt;a class=&#34;reference external&#34; href=&#34;https://doc.rust-lang.org/book/ch18-03-pattern-syntax.html#extra-conditionals-with-match-guards&#34;&gt;match guards&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Visit the subdirectory recursively.&lt;/li&gt;
&lt;li&gt;If &lt;tt class=&#34;docutils literal&#34;&gt;root&lt;/tt&gt; was &lt;tt class=&#34;docutils literal&#34;&gt;&amp;quot;.&amp;quot;&lt;/tt&gt;, the &lt;tt class=&#34;docutils literal&#34;&gt;file_name()&lt;/tt&gt; will be &lt;tt class=&#34;docutils literal&#34;&gt;None&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;Return a &lt;tt class=&#34;docutils literal&#34;&gt;Directory&lt;/tt&gt; for this directory, wrapped in an &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;io::Result&lt;/span&gt;&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2023/01/24/TreeInRust2PrintingTrees.html&#34;&gt;Part 2&lt;/a&gt;, we&#39;ll print the directory tree.&lt;/p&gt;
&lt;/div&gt;
</description>
        <pubDate>Mon, 23 Jan 2023 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2023-01-23:/blog/2023/01/23/TreeInRust1WalkDirectories.html</guid>
    </item>
        
            <item>
        <title>fsymbols for Unicode weirdness</title>
        <link>https://www.georgevreilly.com/blog/2022/12/31/FSymbolsForUnicodeWeirdness.html</link>
        <description>&lt;p&gt;My display name on Twitter currently looks like @…¢·¥á·¥è Ä…¢·¥á·¥† Ä·¥á…™ ü ü è@·¥õ·¥á·¥Ñ ú. ü…¢ ô·¥õ,
an attempt to route around Twitter&#39;s apparent censorship of Mastodon information.&lt;/p&gt;
&lt;p&gt;I used the &lt;a href=&#34;https://fsymbols.com/generators/&#34;&gt;FSymbols Generators&lt;/a&gt; to produce several variants.&lt;/p&gt;
&lt;div class=&#34;codehilite&#34;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;@ùïòùïñùï†ùï£ùïòùïñùïßùï£ùïñùïöùïùùïùùï™@ùï•ùïñùïîùïô.ùïùùïòùïìùï•
 áq∆É Ö.…•…î«ù á@ é Ö Ö·¥â«ù…π å«ù∆É…πo«ù∆É@
@ùóÄùñæùóàùóãùóÄùñæùóèùóãùñæùóÇùóÖùóÖùóí@ùóçùñæùñºùóÅ.ùóÖùóÄùñªùóç
@ùò®ùò¶ùò∞ùò≥ùò®ùò¶ùò∑ùò≥ùò¶ùò™ùò≠ùò≠ùò∫@ùòµùò¶ùò§ùò©.ùò≠ùò®ùò£ùòµ
@ùëîùëíùëúùëüùëîùëíùë£ùëüùëíùëñùëôùëôùë¶@ùë°ùëíùëê‚Ñé.ùëôùëîùëèùë°
@ùôúùôöùô§ùôßùôúùôöùô´ùôßùôöùôûùô°ùô°ùôÆ@ùô©ùôöùôòùôù.ùô°ùôúùôóùô©
@ùöêùöéùöòùöõùöêùöéùöüùöõùöéùöíùöïùöïùö¢@ùöùùöéùöåùöë.ùöïùöêùöãùöù
@ùî§ùî¢ùî¨ùîØùî§ùî¢ùî≥ùîØùî¢ùî¶ùî©ùî©ùî∂@ùî±ùî¢ùî†ùî•.ùî©ùî§ùîüùî±
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Many of these variants come from
&lt;a href=&#34;https://www.compart.com/en/unicode/block/U+1D400&#34;&gt;Unicode Block &#34;Mathematical Alphanumeric Symbols&#34;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There are a lot more things you can do with Unicode
than just &lt;a href=&#34;https://www.georgevreilly.com/blog/2016/02/12/UnicodeUpsideDownMappingPart2.html&#34;&gt;upside-down text&lt;/a&gt;.&lt;/p&gt;</description>
        <pubDate>Sat, 31 Dec 2022 20:35:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2022-12-31:/blog/2022/12/31/FSymbolsForUnicodeWeirdness.html</guid>
    </item>
        
            <item>
        <title>Backwards Ranges in Python</title>
        <link>https://www.georgevreilly.com/blog/2022/12/19/BackwardsRangesInPython.html</link>
        <description>&lt;p&gt;In Python, if you want to specify a sequence of numbers
from &lt;code&gt;a&lt;/code&gt; up to (but excluding) &lt;code&gt;b&lt;/code&gt;,
you can write &lt;code&gt;range(a, b)&lt;/code&gt;.
This generates the sequence &lt;code&gt;a, a+1, a+2, ..., b-1&lt;/code&gt;.
You start at &lt;code&gt;a&lt;/code&gt; and keep going until the next number would be &lt;code&gt;b&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In Python 3, &lt;code&gt;range&lt;/code&gt; is &lt;em&gt;lazy&lt;/em&gt;
and the values in the sequence do not materialize
until you consume the range.&lt;/p&gt;
&lt;div class=&#34;codehilite&#34;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;range(3, 12)&lt;/span&gt;
&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;[3, 4, 5, 6, 7, 8, 9, 10, 11]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Trey Hunner makes the point that
&lt;a href=&#34;https://treyhunner.com/2018/02/python-range-is-not-an-iterator/&#34;&gt;range is a lazy iterable&lt;/a&gt;
rather than an iterator.&lt;/p&gt;
&lt;p&gt;You can also &lt;em&gt;step&lt;/em&gt; by an increment other than one:
&lt;code&gt;range(a, b, s)&lt;/code&gt;.
This generates &lt;code&gt;a, a+s, a+2*s, ..., b-s&lt;/code&gt;
(assuming that &lt;code&gt;(b - a) % s == 0&lt;/code&gt;;
i.e., &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; are separated by an exact multiple of &lt;code&gt;s&lt;/code&gt;.)&lt;/p&gt;
&lt;div class=&#34;codehilite&#34;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;[3, 6, 9]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;What if you want to count down?
&lt;code&gt;range(b, a, -s)&lt;/code&gt; won&#39;t do what you want.&lt;/p&gt;
&lt;div class=&#34;codehilite&#34;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;[12, 9, 6]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Why? Because you&#39;re starting at &lt;code&gt;b&lt;/code&gt;,
a value that doesn&#39;t appear in the forward range,
and you&#39;re ending before you reach &lt;code&gt;a&lt;/code&gt;,
a value that is certainly in the forward range.
You have to subtract &lt;code&gt;s&lt;/code&gt; from both &lt;code&gt;b&lt;/code&gt; and &lt;code&gt;a&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;When you use &lt;code&gt;range(b-s, a-s, -s)&lt;/code&gt;,
you get &lt;code&gt;b-s, b-2*s, ..., a+s, a&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;codehilite&#34;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;))&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;[9, 6, 3]&lt;/span&gt;
&lt;span class=&#34;gp&#34;&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)),&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;list&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;reversed&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nb&#34;&gt;range&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;12&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;mi&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)))&lt;/span&gt;
&lt;span class=&#34;go&#34;&gt;([9, 6, 3], [9, 6, 3])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description>
        <pubDate>Mon, 19 Dec 2022 15:20:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2022-12-19:/blog/2022/12/19/BackwardsRangesInPython.html</guid>
    </item>
        
            <item>
        <title>Ulysses at 100</title>
        <link>https://www.georgevreilly.com/blog/2022/02/02/UlyssesAt100.html</link>
        <description>&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://www.irishtimes.com/news/ireland/irish-news/an-post-launches-new-stamps-to-celebrate-centenary-of-ulysses-1.4787040&#34;&gt;&lt;img alt=&#34;new stamps celebrating the centenary of Ulysses&#34; src=&#34;https://www.irishtimes.com/polopoly_fs/1.4787039.1643276940!/image/image.jpg_gen/derivatives/box_620_330/image.jpg&#34;/&gt;&lt;/a&gt;
&lt;p&gt;On 2nd February 1882, in the Dublin suburb of Rathgar,
a son was given unto John and May Joyce.
James Joyce celebrated his 40th birthday in Paris on 2nd February 1922
by receiving the first printed copy of his novel &lt;em&gt;Ulysses&lt;/em&gt;.
Parts of it had already been published in literary magazines and
the book was eagerly received by the cognoscenti.
It took more than a decade for &lt;em&gt;Ulysses&lt;/em&gt; to be published
in Britain and the United States.
Censors had considered the book obscene,
but the courts established that it had legitimate literary merit.&lt;/p&gt;
&lt;p&gt;For decades, &lt;em&gt;Ulysses&lt;/em&gt; was poorly received in Ireland.
The book was considered &lt;a class=&#34;reference external&#34; href=&#34;https://www.irishtimes.com/news/ireland/irish-news/the-year-of-ulysses-2022-marks-centenary-of-joyce-s-experimental-masterpiece-1.4766055&#34;&gt;blasphemous&lt;/a&gt; and obscene by many.
Worse, Joyce had freely borrowed from life,
populating the pages of &lt;em&gt;Ulysses&lt;/em&gt; with people he had known in Dublin.&lt;/p&gt;
&lt;p&gt;By the time of the centenary of Joyce&#39;s birth in 1982,
attitudes had changed in Ireland.
&lt;em&gt;Ulysses&lt;/em&gt; was now celebrated, if not widely read.
RT√â Radio broadcast a &lt;a class=&#34;reference external&#34; href=&#34;https://www.rte.ie/archives/exhibitions/681-history-of-rte/706-rte-1980s/327476-ulysses-broadcast/&#34;&gt;25-hour reading&lt;/a&gt; of the entire book.&lt;/p&gt;
&lt;p&gt;I was a schoolboy of almost seventeen in Dublin in February 1982.
I did not, alas, listen to the &lt;a class=&#34;reference external&#34; href=&#34;https://archive.org/details/Ulysses-Audiobook-Merged&#34;&gt;RT√â recording&lt;/a&gt; at the time,
but at some point that year, I started reading &lt;em&gt;Ulysses&lt;/em&gt; for myself.
And like so many would-be readers before and since,
I hit Episode 3, &amp;quot;Proteus&amp;quot;,
which opens with &amp;quot;Ineluctable modality of the visible&amp;quot;
and promptly dives into Stephen Dedalus&#39;s impenetrable thoughts.
If I could give some advice to myself 40 years ago,
it would be to &amp;quot;skip over the hard bits&amp;quot;.
I&#39;m in good company on that recommendation.
Daniel Mulhall, Ireland&#39;s Ambassador to the US
and author of the recent &lt;a class=&#34;reference external&#34; href=&#34;https://www.amazon.com/dp/1848408293/?tag=georgvreill-20&#34;&gt;Ulysses: A Reader&#39;s Odyssey&lt;/a&gt;,
gives the same advice.
Episode 4, &amp;quot;Calypso&amp;quot;, introduces us to Leopold Bloom
and is far more enjoyable.&lt;/p&gt;
&lt;p&gt;Unfortunately, I did not have the benefit of that advice then,
and I had little to do with &lt;em&gt;Ulysses&lt;/em&gt; for the next two decades.
In &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2003/06/11/Bloomsday.html&#34;&gt;2003&lt;/a&gt;, I took part in the &lt;a class=&#34;reference external&#34; href=&#34;https://www.wildgeeseseattle.org/&#34;&gt;Wild Geese Players of Seattle&lt;/a&gt;&#39;s
staged reading of Episodes 8 and 9, &amp;quot;Lestrygonians&amp;quot; and &amp;quot;Scylla and Charybdis&amp;quot;.
In 2004, I helped adapt the next episode, &amp;quot;Wandering Rocks&amp;quot;, for that year&#39;s staged reading.
When Kieran O&#39;Malley, the group&#39;s original founder, moved back to Ireland in 2005 or 2006,
I took over as dramaturg.
I&#39;ve led the Geese for many years now,
and I&#39;ve &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/WildGeeseSeattle/Ulysses&#34;&gt;adapted scripts&lt;/a&gt; for the entire book.&lt;/p&gt;
&lt;p&gt;Why?
The connection with Dublin that I share with Joyce is certainly part of it.
I&#39;ve come to love the book.
(Most of it; there are certainly parts that I find tedious.)
It&#39;s a book in which very little happens,
and yet it encompasses everything.
We get an extremely rounded picture of Bloom and his inner life.
It&#39;s funny and sad and erudite and annoying and wise.
Joyce has distilled the human condition into one summer&#39;s day in Dublin.&lt;/p&gt;
&lt;p&gt;And now it is the centenary of the publication of &lt;em&gt;Ulysses&lt;/em&gt;.
I posted some &lt;a class=&#34;reference external&#34; href=&#34;https://www.wildgeeseseattle.org/ulysses-at-100.html&#34;&gt;centenary material&lt;/a&gt; at the Wild Geese website.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Ulysses&lt;/em&gt; has become an ineluctable part of my life.&lt;/p&gt;
</description>
        <pubDate>Wed, 02 Feb 2022 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2022-02-02:/blog/2022/02/02/UlyssesAt100.html</guid>
    </item>
        
            <item>
        <title>Diffing a fragment of a file</title>
        <link>https://www.georgevreilly.com/blog/2022/01/31/DiffFileFragment.html</link>
        <description>&lt;p&gt;A while back, I had extracted some code out of a large file
into a separate file and made some modifications.
I wanted to check that the differences were minimal.
Let&#39;s say that the extracted code had been between
lines 123 and 456 of &lt;tt class=&#34;docutils literal&#34;&gt;large_old_file&lt;/tt&gt;.&lt;/p&gt;
&lt;pre class=&#34;code bash literal-block&#34;&gt;
diff -u &amp;lt;&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;sed -n &lt;span class=&#34;s1&#34;&gt;&#39;123,456p;457q&#39;&lt;/span&gt; large_old_file&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt; new_file
&lt;/pre&gt;
&lt;p&gt;What&#39;s happening here?&lt;/p&gt;
&lt;ul class=&#34;simple&#34;&gt;
&lt;li&gt;&lt;tt class=&#34;docutils literal&#34;&gt;sed &lt;span class=&#34;pre&#34;&gt;-n&lt;/span&gt; &#39;123,456p&#39;&lt;/tt&gt; is printing lines 123‚Äì456 of &lt;tt class=&#34;docutils literal&#34;&gt;large_old_file&lt;/tt&gt;.&lt;/li&gt;
&lt;li&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;457q&lt;/tt&gt; tells sed to abandon the file at line 457.
Otherwise, it will keep reading all the way to the end.&lt;/li&gt;
&lt;li&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;&amp;lt;(sed &lt;span class=&#34;pre&#34;&gt;...)&lt;/span&gt;&lt;/tt&gt; is an example of &lt;a class=&#34;reference external&#34; href=&#34;https://tldp.org/LDP/abs/html/process-sub.html&#34;&gt;process substitution&lt;/a&gt;.
The &lt;em&gt;output&lt;/em&gt; of the &lt;tt class=&#34;docutils literal&#34;&gt;sed&lt;/tt&gt; invocation
becomes the first &lt;em&gt;input&lt;/em&gt; of the &lt;tt class=&#34;docutils literal&#34;&gt;diff&lt;/tt&gt; command.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A similar example: &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2017/01/11/DiffTransformedFile.html&#34;&gt;Diff a Transformed File&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;BTW, these days, I usually use &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/dandavison/delta&#34;&gt;delta&lt;/a&gt; for diffing at the command line,
especially with Git.&lt;/p&gt;
</description>
        <pubDate>Mon, 31 Jan 2022 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2022-01-31:/blog/2022/01/31/DiffFileFragment.html</guid>
    </item>
        
            <item>
        <title>40 Years of Programming</title>
        <link>https://www.georgevreilly.com/blog/2022/01/31/40YearsOfProgramming.html</link>
        <description>&lt;p&gt;40 years ago this month,
I sat down at a computer and wrote a program.
(Or &amp;quot;programme&amp;quot;, as I spelled it then.)
It was the first time I had ever used a computer.
Very few people had used computers in 1982,
in Ireland or elsewhere.&lt;/p&gt;
&lt;p&gt;What was the program?
No idea.
Just a few lines of AppleSoft Basic.
But it was enough to get me hooked and change my life.&lt;/p&gt;
&lt;p&gt;I still get a hit when a little bit of code unlocks in my brain.
It&#39;s quite addictive.
There&#39;s always more to learn and to see.&lt;/p&gt;
&lt;p&gt;I wrote more about this in 2012: &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2012/01/26/30YearsOfProgramming.html&#34;&gt;30 Years of Programming&lt;/a&gt;.&lt;/p&gt;
</description>
        <pubDate>Mon, 31 Jan 2022 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2022-01-31:/blog/2022/01/31/40YearsOfProgramming.html</guid>
    </item>
        
            <item>
        <title>On Circumnavigating the Aubreyiad Again</title>
        <link>https://www.georgevreilly.com/blog/2021/12/30/CircumnavigatingAubreyiad.html</link>
        <description>&lt;p&gt;At the beginning of 2021,
prompted by Russell Crowe&#39;s defense of &lt;em&gt;Master and Commander&lt;/em&gt;,
I began yet another re-read of the twenty Aubrey-Maturin novels.
Or, as the fandom would have it, another circumnavigation.
It&#39;s probably my fifth or sixth circumnavigation,
since I bought the complete boxed set as a Christmas present to myself
in the early aughts.&lt;/p&gt;
&lt;p&gt;I completed the twentieth book, &lt;em&gt;Blue at the Mizzen&lt;/em&gt;, yesterday,
and also the few pages of the final, unfinished novel, &lt;em&gt;21&lt;/em&gt;.
(I also read about &lt;a class=&#34;reference external&#34; href=&#34;https://www.goodreads.com/user/year_in_books/2021/3723742&#34;&gt;120 other books&lt;/a&gt; in 2021,
down from a stupendous &lt;a class=&#34;reference external&#34; href=&#34;https://www.goodreads.com/user/year_in_books/2020/3723742&#34;&gt;200 books in 2020&lt;/a&gt;,
but that&#39;s neither here nor there.)&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;I think I&amp;#39;m due for another re-read of Patrick O&amp;#39;Brian&amp;#39;s Aubrey/Maturin novels (all 6,500 pages) and a rewatch of Master and Commander.
&lt;a href=&#34;https://t.co/gVf9IBan7e&#34;&gt;pic.twitter.com/gVf9IBan7e&lt;/a&gt;&lt;/p&gt;&amp;mdash; George V. Reilly (@georgevreilly)
&lt;a href=&#34;https://twitter.com/georgevreilly/status/1350913122345783297?ref_src=twsrc%5Etfw&#34;&gt;
January 17, 2021&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;p&gt;Why did I put myself through re-reading 6,500 pages of a dense &lt;em&gt;roman-fleuve&lt;/em&gt; yet again?
For the sheer pleasure of joining up once more with my old friends,
Captain Jack Aubrey and Dr Stephen Maturin,
in their 15-year fight against Napoleon.&lt;/p&gt;
&lt;p&gt;They are an unlikely pair of friends.
Jack Aubrey, a big, hearty English naval officer,
is utterly competent in his domain,
magnificent at sea but na√Øve and easily duped on land.
Stephen Maturin, the illegitimate son of an Irish officer and a Catalan lady,
is a renowned physician and naturalist,
a former &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Society_of_United_Irishmen&#34;&gt;United Irishman&lt;/a&gt; turned British intelligence agent,
a Catholic in a Protestant service,
and a perpetual landlubber and sloven.
They have little in common, save a shared love of music and of natural philosophy.
Both are Fellows of the &lt;a class=&#34;reference external&#34; href=&#34;https://royalsociety.org/about-us/history/&#34;&gt;Royal Society&lt;/a&gt;‚ÄîJack, to many&#39;s surprise, is a mathematician and astronomer.&lt;/p&gt;
&lt;p&gt;And yet, they are fast friends and Stephen follows Jack from ship to ship.
A captain must hold himself aloof from his crew and his officers.
He is the sole authority, often months of sailing away from his superiors.
He dines alone, save when invited to the officers&#39; wardroom
or when he invites them to join him.
Stephen, as Jack&#39;s particular friend, is exempt from the normal strictures,
allowing Jack to retain his humanity on the long voyages.&lt;/p&gt;
&lt;p&gt;It is the friendship and the two main characters that hold me,
along with the adventure and the travel.
O&#39;Brian immersed himself in the eighteenth and early nineteenth centuries,
and his encyclopaedic knowledge helped him bring the era to life
with incredible verisimilitude.
O&#39;Brian was an accomplished storyteller and often &lt;a class=&#34;reference external&#34; href=&#34;https://quotingobrian.tumblr.com/&#34;&gt;very funny&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The characters sound and act like people of the time,
not like transplanted twentieth century Americans.
Jack, Stephen, and the other characters
would be at home in the pages of Jane Austen
(sister to two Royal Navy officers).&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://www.tor.com/series/re-reading-patrick-obrians-aubrey-maturin-series/&#34;&gt;Jo Walton&#39;s re-read&lt;/a&gt; will give you a taste of the books.&lt;/p&gt;
</description>
        <pubDate>Thu, 30 Dec 2021 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2021-12-30:/blog/2021/12/30/CircumnavigatingAubreyiad.html</guid>
    </item>
        
            <item>
        <title>Review: Crafting Interpreters</title>
        <link>https://www.georgevreilly.com/blog/2021/12/28/ReviewCraftingInterpreters.html</link>
        <description>&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://www.amazon.com/dp/0990582930/?tag=georgvreill-20&#34;&gt;&lt;img alt=&#34;Crafting Interpreters&#34; class=&#34;right-float&#34; src=&#34;https://images-na.ssl-images-amazon.com/images/I/41-7uSeOyCL._SX398_BO1,204,203,200_.jpg&#34;/&gt;&lt;/a&gt;
&lt;div class=&#34;line-block&#34;&gt;
&lt;div class=&#34;line&#34;&gt;Title: &lt;a class=&#34;reference external&#34; href=&#34;https://craftinginterpreters.com/&#34;&gt;Crafting Interpreters&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Author: Robert Nystrom&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Rating: ‚òÖ ‚òÖ ‚òÖ ‚òÖ ‚òÖ&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Publisher: Genever Benning&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Copyright: 2021&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;ISBN: &lt;a class=&#34;reference external&#34; href=&#34;https://www.amazon.com/dp/0990582930/?tag=georgvreill-20&#34;&gt;978-0990582939&lt;/a&gt;&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Pages: 640&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Keywords: programming, interpreters&lt;/div&gt;
&lt;div class=&#34;line&#34;&gt;Reading period: 10‚Äì28 December, 2021&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;I&#39;ve read hundreds of technical books over the last 40 years.
&lt;em&gt;Crafting Interpreters&lt;/em&gt; is an instant classic,
and far more readable and fun than many of the classics.&lt;/p&gt;
&lt;p&gt;Nystrom covers a lot of ground in this book,
building two very different interpreters for Lox,
a small dynamic language of his own design.
He takes us through &lt;em&gt;every line&lt;/em&gt; of
jlox, a Java-based tree-walk interpreter,
and of clox, a bytecode virtual machine written in C.&lt;/p&gt;
&lt;p&gt;For the first implementation, jlox,
he covers such topics as scanning,
parsing expressions with recursive descent,
evaluating expressions, control flow,
functions and closures, classes, and inheritance.&lt;/p&gt;
&lt;p&gt;Starting with an empty slate,
Nystrom adds just enough code to implement the topic
of each chapter,
having a working albeit incomplete implementation of the interpreter
by the end of the chapter.
He adds new code as he goes,
inserting an extra &lt;tt class=&#34;docutils literal&#34;&gt;case&lt;/tt&gt; into a &lt;tt class=&#34;docutils literal&#34;&gt;switch&lt;/tt&gt; here
or writing a new function there,
or replacing a few lines of an earlier implementation
with something that&#39;s just been explained.
Knuth&#39;s &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Literate_programming&#34;&gt;Literate Programming&lt;/a&gt; explains a finished implementation,
broken into separate pieces for exposition.
Nystrom&#39;s continual, ever-evolving exposition is slower to get to the point,
but it&#39;s excellent pedagogy.
I would be remiss if I didn&#39;t mention the hundreds of hand-drawn illustrations,
which add a quirky flavor to the tone of the book.
He has a blog post on how he &lt;a class=&#34;reference external&#34; href=&#34;http://journal.stuffwithstuff.com/2020/04/05/crafting-crafting-interpreters/&#34;&gt;pulled this organization off&lt;/a&gt;
and another on how he created a &lt;a class=&#34;reference external&#34; href=&#34;http://journal.stuffwithstuff.com/2021/07/29/640-pages-in-15-months/&#34;&gt;physical book&lt;/a&gt; from the text.&lt;/p&gt;
&lt;p&gt;clox is a very different second implementation of a Lox interpreter.
Instead of a slow interpreter walking an abstract syntax tree,
he develops a stack-based virtual machine,
compiles Lox into bytecode,
and interprets the bytecode.
He covers theory and practical considerations
for creating a bytecode virtual machine,
makes use of Pratt‚Äôs ‚Äútop-down operator precedence parsing‚Äù,
and implements closures and classes in C.
In jlox, he used Java&#39;s &lt;tt class=&#34;docutils literal&#34;&gt;HashMap&lt;/tt&gt; to manage identifiers
and relied on Java&#39;s garbage collection for memory management.
For clox, he implements a hash table and a mark-and-sweep garbage collector.
Although he has to cover similar topics (parsing, local variables, closures) each time,
he finds a fresh perspective for the second implementation.&lt;/p&gt;
&lt;p&gt;I read the entire book for free at &lt;a class=&#34;reference external&#34; href=&#34;https://craftinginterpreters.com/&#34;&gt;https://craftinginterpreters.com/&lt;/a&gt;,
but I liked it so much that I&#39;ve ordered a physical copy.
In fact, I actually read much of the book on the website in 2020,
but life intervened and I didn&#39;t finish it,
so this month, I read it again from the start.&lt;/p&gt;
&lt;p&gt;This book is not a textbook and you don&#39;t get an exhaustive introduction
to building interpreters, much less compilers.
In the final year of my Computer Science degree at Trinity College Dublin in 1986‚Äì87,
I studied the &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Compilers:_Principles,_Techniques,_and_Tools&#34;&gt;Dragon Book&lt;/a&gt; when the first edition was brand new.
&lt;em&gt;Crafting Interpreters&lt;/em&gt; is a lot more fun than the Dragon Book.&lt;/p&gt;
&lt;p&gt;Highly recommended!&lt;/p&gt;
</description>
        <pubDate>Tue, 28 Dec 2021 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2021-12-28:/blog/2021/12/28/ReviewCraftingInterpreters.html</guid>
    </item>
        
            <item>
        <title>Path Traversal Attacks</title>
        <link>https://www.georgevreilly.com/blog/2021/10/05/PathTraversalAttacks.html</link>
        <description>&lt;p&gt;I was surprised to read this evening that the Apache Web Server
just fixed an actively exploited path traversal flaw.&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;
&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;
üö® Apache has disclosed an *actively exploited* Path traversal flaw
in the &lt;a href=&#34;https://twitter.com/hashtag/opensource?src=hash&amp;amp;ref_src=twsrc%5Etfw&#34;&gt;#opensource&lt;/a&gt;
&amp;quot;httpd&amp;quot; server.
Over 112,000 exposed Apache servers run version 2.4.49,
and should be upgraded now!&lt;br&gt;
New fix checks for encoded path traversal characters
e.g. /../.%2E/&lt;a href=&#34;https://t.co/1tLNc3LAul&#34;&gt;https://t.co/1tLNc3LAul&lt;/a&gt;
&lt;a href=&#34;https://t.co/mDHLEU3k9N&#34;&gt;pic.twitter.com/mDHLEU3k9N&lt;/a&gt;
&lt;/p&gt;&amp;mdash; Ax Sharma (@Ax_Sharma)
&lt;a href=&#34;https://twitter.com/Ax_Sharma/status/1445391350053183500?ref_src=twsrc%5Etfw&#34;&gt;October 5, 2021&lt;/a&gt;
&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;&lt;p&gt;Apparently, it was &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/apache/httpd/commit/4c79fd280dfa3eede5a6f3baebc7ef2e55b3eb6a&#34;&gt;introduced over a year ago&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I&#39;m gobsmacked that Apache didn&#39;t have a robust suite of tests for this.&lt;/p&gt;
&lt;p&gt;Directory Traversal attacks have been a problem for web servers
since the beginning.
&lt;a class=&#34;reference external&#34; href=&#34;https://owasp.org/www-community/attacks/Path_Traversal&#34;&gt;OWASP&lt;/a&gt;, &lt;a class=&#34;reference external&#34; href=&#34;https://portswigger.net/web-security/file-path-traversal&#34;&gt;PortSwigger&lt;/a&gt;, and &lt;a class=&#34;reference external&#34; href=&#34;https://spanning.com/blog/directory-traversal-web-based-application-security-part-8/&#34;&gt;Spanning&lt;/a&gt; all have explanations that you can read.
The essence is that you make a request to a URL that looks like
&lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;http://example.com/cgi-bin/../../../../etc/passwd&lt;/span&gt;&lt;/tt&gt;
and, voil√†, you get access to something that you shouldn&#39;t.
Each of the &lt;tt class=&#34;docutils literal&#34;&gt;..&lt;/tt&gt; path segments climbs up a level of the file system.
Even the simplest web server knows better than to blindly allow
a sequence of &lt;tt class=&#34;docutils literal&#34;&gt;..&lt;/tt&gt; path segments,
so you have to be a little clever about how you express them.&lt;/p&gt;
&lt;div class=&#34;section&#34; id=&#34;iis-unicode-exploit&#34;&gt;
&lt;h3&gt;IIS Unicode Exploit&lt;/h3&gt;
&lt;p&gt;I remember when I worked on the IIS development team at Microsoft in 1997‚Äì2004,
we got hit by &lt;a class=&#34;reference external&#34; href=&#34;https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-0884&#34;&gt;CVE-2000-0884&lt;/a&gt; in 2000,
which made use of an &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/UTF-8#Overlong_encodings&#34;&gt;overlong UTF-8 encoding&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;URLs allow &lt;a class=&#34;reference external&#34; href=&#34;https://developer.mozilla.org/en-US/docs/Glossary/percent-encoding&#34;&gt;percent encoding&lt;/a&gt; for characters that can&#39;t be sent literally.
For example, &lt;tt class=&#34;docutils literal&#34;&gt;%3D&lt;/tt&gt; encodes an &lt;tt class=&#34;docutils literal&#34;&gt;=&lt;/tt&gt;
as the two-digit hexadecimal value of &lt;tt class=&#34;docutils literal&#34;&gt;=&lt;/tt&gt;‚Äôs ASCII code.
UTF-8 characters beyond U+007F require two or more bytes of storage,
each of which can be percent encoded;
e.g., U+00C1 (&lt;tt class=&#34;docutils literal&#34;&gt;√Å&lt;/tt&gt;) is encoded as the &lt;tt class=&#34;docutils literal&#34;&gt;C3 81&lt;/tt&gt; byte pair in UTF-8,
and as &lt;tt class=&#34;docutils literal&#34;&gt;%C3%81&lt;/tt&gt; in percent encoding.&lt;/p&gt;
&lt;p&gt;The slash character, &lt;tt class=&#34;docutils literal&#34;&gt;/&lt;/tt&gt; or U+002F, can be percent encoded as &lt;tt class=&#34;docutils literal&#34;&gt;%2F&lt;/tt&gt;.
IIS 4 and 5 were smart enough to treat &lt;tt class=&#34;docutils literal&#34;&gt;%2F&lt;/tt&gt; as a slash
and to defend against sequences like &lt;tt class=&#34;docutils literal&#34;&gt;&lt;span class=&#34;pre&#34;&gt;..%2F..%2F&lt;/span&gt;&lt;/tt&gt;.
However, the attackers encoded a slash as &lt;tt class=&#34;docutils literal&#34;&gt;%C0%AF&lt;/tt&gt;‚Äîa sequence that is burned into my brain.
This two-byte UTF-8 sequence can be decoded as U+002F,
though it should not be treated as valid
as it is &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/UTF-8#Overlong_encodings&#34;&gt;overlong&lt;/a&gt;:
the five payload bits in the leading byte are all zero.&lt;/p&gt;
&lt;p&gt;The &lt;a class=&#34;reference external&#34; href=&#34;https://www.giac.org/paper/gcih/115/iis-unicode-exploit/101163&#34;&gt;GIAC paper&lt;/a&gt; explains in some detail how this could be exploited.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&#34;section&#34; id=&#34;windows-security-push&#34;&gt;
&lt;h3&gt;Windows Security Push&lt;/h3&gt;
&lt;p&gt;Windows XP went on sale in late 2001,
touted as the most secure version of Windows ever.
(It was, at that time.)&lt;/p&gt;
&lt;p&gt;Right around Christmas 2001,
the &lt;a class=&#34;reference external&#34; href=&#34;https://www.giac.org/paper/gcih/274/windows-xp-upnp-exploits/102906&#34;&gt;UPnP vulnerabilty&lt;/a&gt; was disclosed.
Brian Valentine, the Senior VP who ran Windows, threw a shitfit.
It was announced that &lt;em&gt;all&lt;/em&gt; of Windows would spend the month of February 2002
undergoing security training,
so that we could &lt;a class=&#34;reference external&#34; href=&#34;https://owasp.org/www-community/Threat_Modeling&#34;&gt;threat model&lt;/a&gt; and review our code.&lt;/p&gt;
&lt;p&gt;For IIS 6, which would be released in Windows Server 2003,
we had fundamentally rearchitected it with a new worker process model
(inspired by Apache&#39;s) and we had rewritten much of it.
There was a new kernel mode driver, http.sys,
that terminated all requests and routed them
to the appropriate handler in kernel or user mode.
I was part of the http.sys dev team at that point.&lt;/p&gt;
&lt;p&gt;IIS had already gotten serious about security by then.
We had to, after &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Code_Red_(computer_worm)&#34;&gt;Code Red&lt;/a&gt;, &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Nimda&#34;&gt;Nimda&lt;/a&gt;, the Unicode exploit, and others.
&lt;a class=&#34;reference external&#34; href=&#34;https://www.linkedin.com/in/mikehow/&#34;&gt;Mike Howard&lt;/a&gt; had been the IIS Security Program Manager
before he went on to bigger responsiblities.
A lot of the first edition of his &lt;a class=&#34;reference external&#34; href=&#34;https://www.amazon.com/Writing-Secure-Second-Developer-Practices/dp/0735617228&#34;&gt;Writing Secure Code&lt;/a&gt; book
was based on his experience with securing IIS,
and a lot of the second edition benefited from the Security Push experience.&lt;/p&gt;
&lt;p&gt;Since http.sys was new and an obvious target,
our team actually spent two months carefully reviewing everything.
It turned out that we had done a good job over the previous couple of years
and we didn&#39;t find much to worry about.&lt;/p&gt;
&lt;p&gt;We did identify that the URL canonicalization in http.sys
was overly complicated.
I rewrote that component and I created a ton of unit tests for it.
Developers writing unit tests was not common at Microsoft back in 2002:
we had a separate caste of testers to write tests.&lt;/p&gt;
&lt;p&gt;I&#39;ve been out of the loop since I left IIS in 2004,
but to my knowledge, there were no further vulnerabilities in URL handling.&lt;/p&gt;
&lt;p&gt;I&#39;m surprised and disappointed that Apache would mess up path traversal in the 2020s.&lt;/p&gt;
&lt;/div&gt;
</description>
        <pubDate>Tue, 05 Oct 2021 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2021-10-05:/blog/2021/10/05/PathTraversalAttacks.html</guid>
    </item>
        
            <item>
        <title>Accidentally Quadratic: Python List Membership</title>
        <link>https://www.georgevreilly.com/blog/2021/10/04/AccidentallyQuadraticPythonListMembership.html</link>
        <description>&lt;p&gt;We had a performance regression in a test suite recently
when the median test time jumped by two minutes.&lt;/p&gt;
&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://www.bigocheatsheet.com/&#34;&gt;&lt;img alt=&#34;Big O Cheat Sheet&#34; src=&#34;https://www.georgevreilly.com/content/binary/bigochart.gif&#34;/&gt;&lt;/a&gt;
&lt;p&gt;We tracked it down to this (simplified) code fragment:&lt;/p&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;n&#34;&gt;task_inclusions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;some_collection_of_tasks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;invalid_tasks&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;task_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;airflow_tasks&lt;/span&gt;
                 &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;task_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;task_inclusions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;This looks fairly innocuous‚Äîand it was‚Äîuntil the size of the result returned from &lt;tt class=&#34;docutils literal&#34;&gt;some_collection_of_tasks()&lt;/tt&gt;
jumped from a few hundred to a few thousand.&lt;/p&gt;
&lt;p&gt;The &lt;a class=&#34;reference external&#34; href=&#34;https://docs.python.org/3/reference/expressions.html#membership-test-operations&#34;&gt;in comparison operator&lt;/a&gt; conveniently works
with all of Python&#39;s standard sequences and collections,
but its efficiency varies.
For a &lt;tt class=&#34;docutils literal&#34;&gt;list&lt;/tt&gt; and other sequences,
&lt;tt class=&#34;docutils literal&#34;&gt;in&lt;/tt&gt; must search linearly through all the elements
until it finds a matching element
&lt;em&gt;or&lt;/em&gt; the list is exhausted.
In other words, &lt;tt class=&#34;docutils literal&#34;&gt;x in some_list&lt;/tt&gt; takes &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;O&lt;/i&gt;(&lt;i&gt;n&lt;/i&gt;)&lt;/span&gt; time.
For a &lt;tt class=&#34;docutils literal&#34;&gt;set&lt;/tt&gt; or a &lt;tt class=&#34;docutils literal&#34;&gt;dict&lt;/tt&gt;, however,
&lt;tt class=&#34;docutils literal&#34;&gt;x in container&lt;/tt&gt; takes, on average, only &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;O&lt;/i&gt;(1)&lt;/span&gt; time.
See &lt;a class=&#34;reference external&#34; href=&#34;https://wiki.python.org/moin/TimeComplexity&#34;&gt;Time Complexity&lt;/a&gt; for more.&lt;/p&gt;
&lt;p&gt;The &lt;tt class=&#34;docutils literal&#34;&gt;invalid_tasks&lt;/tt&gt; list comprehension
was explicitly looping through one list, &lt;tt class=&#34;docutils literal&#34;&gt;airflow_tasks&lt;/tt&gt;,
and implicitly doing a linear search through &lt;tt class=&#34;docutils literal&#34;&gt;task_inclusions&lt;/tt&gt;
for each value of &lt;tt class=&#34;docutils literal&#34;&gt;t&lt;/tt&gt;.
The nested loop was hidden
and its effect only became apparent
when &lt;tt class=&#34;docutils literal&#34;&gt;task_inclusions&lt;/tt&gt; grew large.&lt;/p&gt;
&lt;p&gt;The list comprehension was actually taking &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;O&lt;/i&gt;(&lt;i&gt;n&lt;/i&gt;&lt;sup&gt;2&lt;/sup&gt;)&lt;/span&gt; time.
When &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;n&lt;/i&gt;&lt;/span&gt; was comparatively small (a few hundred),
this wasn&#39;t a problem.
When &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;n&lt;/i&gt;&lt;/span&gt; grew to several thousand,
it became a big problem.&lt;/p&gt;
&lt;p&gt;This is a classic example of an &lt;a class=&#34;reference external&#34; href=&#34;https://accidentallyquadratic.tumblr.com/&#34;&gt;accidentally quadratic&lt;/a&gt; algorithm.
Indeed, Nelson describes a very similar problem with &lt;a class=&#34;reference external&#34; href=&#34;https://accidentallyquadratic.tumblr.com/post/161243900944/mercurial-changegroup-application&#34;&gt;Mercurial changegroups&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This performance regression was compounded because this fragment of code
was being called thousands of times‚ÄîI believe once for each task‚Äî
making the overall cost cubic, &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;O&lt;/i&gt;(&lt;i&gt;n&lt;/i&gt;&lt;sup&gt;3&lt;/sup&gt;)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The fix here is similar:
Use a &lt;tt class=&#34;docutils literal&#34;&gt;set&lt;/tt&gt; instead of a &lt;tt class=&#34;docutils literal&#34;&gt;list&lt;/tt&gt;
and get &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;O&lt;/i&gt;(1)&lt;/span&gt; membership testing.
The &lt;tt class=&#34;docutils literal&#34;&gt;invalid_tasks&lt;/tt&gt; list comprehension now takes
the expected &lt;span class=&#34;formula&#34;&gt;&lt;i&gt;O&lt;/i&gt;(&lt;i&gt;n&lt;/i&gt;)&lt;/span&gt; time.&lt;/p&gt;
&lt;pre class=&#34;code python literal-block&#34;&gt;
&lt;span class=&#34;n&#34;&gt;task_inclusions&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;set&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;some_collection_of_tasks&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;span class=&#34;n&#34;&gt;invalid_tasks&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;[&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;task_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;for&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;airflow_tasks&lt;/span&gt;
                 &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;t&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;task_id&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;ow&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;task_inclusions&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;]&lt;/span&gt;
&lt;/pre&gt;
&lt;p&gt;More at &lt;a class=&#34;reference external&#34; href=&#34;https://www.coengoedegebure.com/understanding-big-o-notation/&#34;&gt;Understanding Big-O Notation&lt;/a&gt; and the &lt;a class=&#34;reference external&#34; href=&#34;https://www.bigocheatsheet.com/&#34;&gt;Big-O Cheat Sheet&lt;/a&gt;.&lt;/p&gt;
</description>
        <pubDate>Mon, 04 Oct 2021 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2021-10-04:/blog/2021/10/04/AccidentallyQuadraticPythonListMembership.html</guid>
    </item>
        
            <item>
        <title>Passphrase Generators</title>
        <link>https://www.georgevreilly.com/blog/2021/05/10/PassphraseGenerators.html</link>
        <description>&lt;a class=&#34;reference external image-reference&#34; href=&#34;https://xkcd.com/936/&#34;&gt;&lt;img alt=&#34;Password Strength&#34; src=&#34;https://imgs.xkcd.com/comics/password_strength.png&#34;/&gt;&lt;/a&gt;
&lt;p&gt;I&#39;ve been using &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Password_manager&#34;&gt;password managers&lt;/a&gt; for at least 15 years
to keep track of all my passwords.
I have separate, distinct, strong passwords for hundreds of sites,
and I&#39;ve only memorized the handful that I need to actually type regularly.&lt;/p&gt;
&lt;p&gt;I started out with the &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2006/02/06/200KeePassEntries.html&#34;&gt;KeePass&lt;/a&gt; desktop app originally,
but I switched to the online &lt;a class=&#34;reference external&#34; href=&#34;https://www.georgevreilly.com/blog/2016/01/07/DicewareAndLastpass.html&#34;&gt;LastPass&lt;/a&gt; app about a decade ago.
At work, we use &lt;a class=&#34;reference external&#34; href=&#34;https://1password.com/&#34;&gt;1Password&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;When I register for a site,
LastPass generates a random password for me,
such as:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
tV%5joS$U6^uY5xU
T2oEUY!g70Iv1b&amp;amp;I
8kNHg9*A5GMR9%8D
&lt;/pre&gt;
&lt;p&gt;LastPass securely syncs my passwords between machines and devices.
Its browser integration and its Android and iPhone apps
mean that I rarely ever have to actually type any of those ugly messes in.&lt;/p&gt;
&lt;p&gt;But when I do have to type in such a password,
it&#39;s unpleasant in a browser.
It doesn&#39;t help that LastPass in some cases displays passwords
in a sans-serif font that makes it easy to &lt;a class=&#34;reference external&#34; href=&#34;https://typography.guru/journal/letters-symbols-misrecognition/&#34;&gt;misrecognize&lt;/a&gt; letters
such as &lt;tt class=&#34;docutils literal&#34;&gt;Il&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;0O&lt;/tt&gt;, &lt;tt class=&#34;docutils literal&#34;&gt;5S&lt;/tt&gt;, or &lt;tt class=&#34;docutils literal&#34;&gt;8B&lt;/tt&gt;.
It&#39;s far more painful in an Android app,
where you have to switch the keyboard in and out of symbol mode.
It&#39;s usually even worse in iPhone apps,
which rarely offer you an option to see your password in the clear
as you&#39;re laboriously typing it,
so it&#39;s easy to make a mistake.
When I tried to use a remote control
to enter my Netflix and Amazon Prime passwords into a new set-top box,
I got so annoyed that I brought down a real keyboard
and plugged it into the USB port.&lt;/p&gt;
&lt;p&gt;&lt;a class=&#34;reference external&#34; href=&#34;https://theintercept.com/2015/03/26/passphrases-can-memorize-attackers-cant-guess/&#34;&gt;Passphrases&lt;/a&gt; have nice properties compared to random passwords:
they&#39;re human readable,
they&#39;re much easier‚Äîif longer‚Äîto type,
and you can actually remember them if you have to.
A passphrase of at least five words (chosen by a secure random generator)
is computationally infeasible to crack.&lt;/p&gt;
&lt;p&gt;The ur-example of random passphrase generators is &lt;a class=&#34;reference external&#34; href=&#34;https://en.wikipedia.org/wiki/Diceware&#34;&gt;Diceware&lt;/a&gt; from 1995.
There are various problems with the Diceware wordlist,
which are rectified by more modern lists,
such as the &lt;a class=&#34;reference external&#34; href=&#34;https://www.eff.org/deeplinks/2016/07/new-wordlists-random-passphrases&#34;&gt;EFF Wordlists&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Which would you rather type?
The &lt;a class=&#34;reference external&#34; href=&#34;http://www.catb.org/jargon/html/L/line-noise.html&#34;&gt;line noise&lt;/a&gt; above or one of these passphrases?:&lt;/p&gt;
&lt;pre class=&#34;literal-block&#34;&gt;
confident starfish aftermost elsewhere jasmine
shun baggage chaps reward cuddle
avenue rut pardon skating earlobe
latter blissful snippet jolt corroding
upstage-divinely-ninth-unfilled-skeleton
SkimmingMachinistBlessHesitancyKissableRink
&lt;/pre&gt;
&lt;p&gt;When I want to generate a random passphrase,
I tend to use either the &lt;a class=&#34;reference external&#34; href=&#34;https://github.com/ulif/diceware&#34;&gt;Python diceware&lt;/a&gt; command-line tool
or Glenn Rempe&#39;s JavaScript-based &lt;a class=&#34;reference external&#34; href=&#34;https://www.rempe.us/diceware/#eff&#34;&gt;Diceware website&lt;/a&gt;.
Both use cryptographic random number generators
to generate excellent passphrases.&lt;/p&gt;
&lt;p&gt;The &lt;a class=&#34;reference external&#34; href=&#34;https://1password.com/password-generator/&#34;&gt;1Password Online Generator&lt;/a&gt; (in Memorable Password mode)
also generates passphrases,
as do the desktop and browser versions of 1Password.&lt;/p&gt;
&lt;p&gt;My master password for LastPass is a passphrase,
as is my laptop password.
I&#39;m also using &lt;a class=&#34;reference external&#34; href=&#34;https://authy.com/&#34;&gt;Authy&lt;/a&gt; for 2FA, but that&#39;s a post for another time.&lt;/p&gt;
&lt;div class=&#34;admonition tip&#34;&gt;
&lt;p class=&#34;first admonition-title&#34;&gt;Tip&lt;/p&gt;
&lt;p&gt;If you have to supply answers
for one of those misbegotten &lt;a class=&#34;reference external&#34; href=&#34;https://www.okta.com/blog/2021/03/security-questions/&#34;&gt;security questions&lt;/a&gt;,
such as your favorite movie or your first car,
&lt;em&gt;do not answer truthfully&lt;/em&gt;.
Truthful answers increase your risk of identity theft.
The answers are often guessable,
can frequently be learned easily about you,
and may be obtained through a password breach on another site.&lt;/p&gt;
&lt;p&gt;Instead, generate a passphrase as the &amp;quot;answer&amp;quot;
&lt;em&gt;and store it and the question
in the Notes field of your password manager&lt;/em&gt;.
If you have to supply the answer to a security question
over the phone to a customer service rep,
you&#39;ll be thankful that you chose something
that you can clearly say aloud.&lt;/p&gt;
&lt;p class=&#34;last&#34;&gt;Also &lt;a class=&#34;reference external&#34; href=&#34;https://www.mentalfloss.com/article/522136/taking-facebook-quizzes-could-put-you-risk-identity-theft&#34;&gt;Facebook quizzes&lt;/a&gt; and memes like
&amp;quot;Your porn name is your middle name and the first car you had&amp;quot;
are trying to obtain your answers to common security questions.
Don&#39;t answer them.&lt;/p&gt;
&lt;/div&gt;
</description>
        <pubDate>Mon, 10 May 2021 00:00:00 GMT</pubDate>
        <guid isPermaLink="false">tag:www.georgevreilly.com,2021-05-10:/blog/2021/05/10/PassphraseGenerators.html</guid>
    </item>
        </channel>
</rss>