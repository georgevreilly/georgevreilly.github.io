<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>George V. Reilly</title>
  <link media="all" href="/style.css" rel="stylesheet" />
  <link media="all" href="/pygments.css" rel="stylesheet" />
  <link href="/favicon.ico" rel="shortcut icon" />
    <link href="/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">
  <link href="/" rel="home start" />
  <link href="/atom/" type="application/atom+xml" rel="alternate" title="Atom Feed" />
  <link href="/rss/" type="application/rss+xml" rel="alternate" title="RSS Feed" />
</head>
<body>
  <header>
    <h1><a href="/" rel="home start" class="blogtitle">George V. Reilly</a></h1>
    <nav>
      <ul>
        <li><a href="/blog/" rel="home start" title="George's full blog">blog</a></li>
        <li><a href="/til/" rel="home start" title="Today George Learned">TIL</a></li>
        <li><a href="/about/" rel="home start" title="About George">about</a></li>
        <li><a href="/atom/" rel="alternate" title="Atom Feed">atom</a></li>
        <li><a href="/rss/" rel="alternate" title="RSS Feed">rss</a></li>
        <li><a href="/articles/" rel="contents">articles</a></li>
        <li><a href="/tags/" rel="contents">tags</a></li>
      </ul>
    </nav>
  </header>
    
        <article>
    <header>
        <time datetime="2011-04-22">2011-04-22</time>
        <h1>
            <a href="/blog/2011/04/22/SerializationExceptionTheConstructorWasNotFound.html" rel="bookmark canonical">SerializationException: the constructor was not found</a>
        </h1>
    </header>
    <a class="reference external image-reference" href="http://blogs.cozi.com/tech/2011/04/serializationexception-the-constructor-was-not-found.html"></a>
<p>I just finished another post at the Cozi Tech Blog,
<a class="reference external" href="http://blogs.cozi.com/tech/2011/04/serializationexception-the-constructor-was-not-found.html">Se&shy;ri&shy;al&shy;iza&shy;tionEx&shy;cep&shy;tion: the con&shy;struc&shy;tor was not found</a></p>

    <footer>
        
        
            <p>tagged as
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
        <article>
    <header>
        <time datetime="2007-08-15">2007-08-15</time>
        <h1>
            <a href="/blog/2007/08/15/BuildingARESTWebServiceDay1.html" rel="bookmark canonical">Building a REST Web Service, day 1</a>
        </h1>
    </header>
    <a class="reference external image-reference" href="http://rest.blueoxen.net/"></a>
<p>My first project at <a class="reference external" href="http://www.cozi.com/">Cozi</a> is to build a simple <a class="reference external" href="http://rest.blueoxen.net/">REST</a>-style Web Service.
Nobody here has done that before.</p>
<p>The first thing that I'm trying to get going is a simple <a class="reference external" href="http://msdn2.microsoft.com/en-us/library/ms972974.aspx">URL rewriter</a>,
using an ASP.NET HttpModule.</p>
<p>I'm running Vista as my de&shy;vel&shy;op&shy;ment desktop for the first time.
So far, not bad, but there are lots of new quirks to get used to.
I've been a good boy so far and I've left the User Access Control stuff enabled,
so that I'm not running with ad&shy;min&shy;is&shy;tra&shy;tive privileges by default.</p>
<p>It's my first exposure to IIS 7.
I must say that the IIS UI is much improved
(a low bar to <span>&#8230;<a href="/blog/2007/08/15/BuildingARESTWebServiceDay1.html" class="continue">continue</a>.</span></p>
    <footer>
        
        
            <p>tagged as
                <a href="/tag/cozi/" rel="tag">cozi</a>,
                <a href="/tag/rest/" rel="tag">rest</a>
                    and
                    
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
        <article>
    <header>
        <time datetime="2007-07-20">2007-07-20</time>
        <h1>
            <a href="/blog/2007/07/20/SerializingANameValueCollection.html" rel="bookmark canonical">Serializing a NameValueCollection</a>
        </h1>
    </header>
    
<p>I had a NameVal&shy;ueCol&shy;lec&shy;tion embedded inside a larger object.
I needed to serialize the larger object into XML and back.
Un&shy;for&shy;tu&shy;nate&shy;ly, NameVal&shy;ueCol&shy;lec&shy;tion is not XML se&shy;ri&shy;al&shy;iz&shy;able.
Why I do not know.</p>
<p>A blog comment from <a class="reference external" href="http://nayyeri.net/archive/2006/08/11/Serialize-NameValueCollection.aspx#72442">Tim Erwin</a> got me started in the right direction.
Implement <tt class="docutils literal">IXmlSe&shy;ri&shy;al&shy;iz&shy;able</tt> and do the work by hand in
<tt class="docutils literal">ReadXml</tt> and <tt class="docutils literal">WriteXml</tt>.</p>
<p>Tim's im&shy;ple&shy;men&shy;ta&shy;tion turned out to be overly simple.
It didn't handle an empty collection well,
nor did it leave the <tt class="docutils literal">XmlReader</tt> in a good state.</p>
<p>I used <a class="reference external" href="http://msdn2.microsoft.com/en-us/library/bk3w6240(vs.80).aspx">SGen</a> to examine the de&shy;se&shy;ri&shy;al&shy;iza&shy;tion of a
<tt class="docutils literal">List&lt;String&gt;</tt> to figure out what else needed to be done.</p>
<p>The following <tt class="docutils literal">ReadXml</tt> seems to work.
If I expected to receive XML from <span>&#8230;<a href="/blog/2007/07/20/SerializingANameValueCollection.html" class="continue">continue</a>.</span></p>
    <footer>
        
        
            <p>tagged as
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>
                    and
                    
                <a href="/tag/til/" rel="tag">til</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
        <article>
    <header>
        <time datetime="2007-06-09">2007-06-09</time>
        <h1>
            <a href="/blog/2007/06/09/Multilingual.html" rel="bookmark canonical">Multilingual</a>
        </h1>
    </header>
    
<p>This week, I have written code in C#, C++, Managed C++, C, WiX, NAnt,
Ac&shy;tion&shy;Script, VBScript, JScript, cmd batch, NMake, HTML,
XSLT, and Ruby. And I will probably get some Python in before the weekend
is over. &lt;boggle/&gt;</p>

    <footer>
        
        
            <p>tagged as
                <a href="/tag/programming/" rel="tag">programming</a>,
                <a href="/tag/javascript/" rel="tag">javascript</a>,
                <a href="/tag/c++/" rel="tag">c++</a>,
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>,
                <a href="/tag/python/" rel="tag">python</a>,
                <a href="/tag/ruby/" rel="tag">ruby</a>
                    and
                    
                <a href="/tag/html/" rel="tag">html</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
        <article>
    <header>
        <time datetime="2007-03-21">2007-03-21</time>
        <h1>
            <a href="/blog/2007/03/21/NUnitCallingCppUnit.html" rel="bookmark canonical">NUnit calling CppUnit</a>
        </h1>
    </header>
    
<p>Over the last few days, I've been adapting an existing native C++ library
so that it can be called from managed code.
I had written a large number of unit tests with <a class="reference external" href="http://cppunit.sourceforge.net/">CppUnit</a>
and I wanted to be able to call the tests from <a class="reference external" href="http://www.nunit.org/">NUnit</a>.</p>
<p>I suppose that I could have written a new CppUnit <a class="reference external" href="http://cppunit.sourceforge.net/cppunit-wiki/TestRunner">TestRunner</a> so that I
could call it from NUnit.
Instead, I took the cheap-n-dirty route, playing with <tt class="docutils literal">#define</tt>
and include paths.
It took less time to get working than it did to write this blog post.</p>
<p>Here's the original native CppUnit test code</p>
<pre class="code cpp literal-block">
<span class="c1">//-------------------------------
// native\FooTest.h
//-------------------------------
</span><span class="w">
</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;cppunit/extensions/HelperMacros.h&gt;</span><span class="cp">
</span><span class="w">
</span><span class="k">class</span><span class="w"> </span><span class="nc">FooTest</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CppUnit</span><span class="o">::</span><span class="n">TestFixture</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="n">CPPUNIT_TEST_SUITE</span><span class="p">(</span><span class="w"> </span><span class="n">FooTest</span><span class="w"> </span></pre><span>&#8230;<a href="/blog/2007/03/21/NUnitCallingCppUnit.html" class="continue">continue</a>.</span>
    <footer>
        
        
            <p>tagged as
                <a href="/tag/net/" rel="tag">.NET</a>,
                <a href="/tag/c++/" rel="tag">C++</a>,
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>
                    and
                    
                <a href="/tag/til/" rel="tag">til</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
        <article>
    <header>
        <time datetime="2007-03-14">2007-03-14</time>
        <h1>
            <a href="/blog/2007/03/14/NVelocityLoadingTemplatesFromEmbeddedResources.html" rel="bookmark canonical">NVelocity: loading templates from embedded resources</a>
        </h1>
    </header>
    <a class="reference external image-reference" href="http://www.castleproject.org/others/nvelocity/index.html"></a>
<p>In last week's tip on
using the <a class="reference external" href="http://www.castleproject.org/others/nvelocity/index.html">NVelocity</a> template formatting engine,
I described what to set to load a template from
an <a class="reference external" href="/blog/2007/03/07/NVelocityTemplatesAndAbsolutePaths.html">absolute path</a>.</p>
<p>Here's the magic necessary to get NVelocity to load a template from an
embedded resource:</p>
<pre class="code csharp literal-block">
<span class="n">VelocityEngine</span><span class="w"> </span><span class="n">engine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">VelocityEngine</span><span class="p">();</span><span class="w">
</span><span class="n">ExtendedProperties</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ExtendedProperties</span><span class="p">();</span><span class="w">
</span><span class="n">properties</span><span class="p">.</span><span class="n">AddProperty</span><span class="p">(</span><span class="s">&quot;resource.loader&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;assembly&quot;</span><span class="p">);</span><span class="w">
</span><span class="n">properties</span><span class="p">.</span><span class="n">AddProperty</span><span class="p">(</span><span class="s">&quot;assembly.resource.loader.class&quot;</span><span class="p">,</span><span class="w">
    </span><span class="s">&quot;NVelocity.Runtime.Resource.Loader.AssemblyResourceLoader, NVelocity&quot;</span><span class="p">);</span><span class="w">
</span><span class="n">properties</span><span class="p">.</span><span class="n">AddProperty</span><span class="p">(</span><span class="s">&quot;assembly.resource.loader.assembly&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;StencilFormatter&quot;</span><span class="p">);</span><span class="w">
</span><span class="n">engine</span><span class="p">.</span><span class="n">Init</span><span class="p">(</span><span class="n">properties</span><span class="p">);</span>
</pre>

    <footer>
        
        
            <p>tagged as
                <a href="/tag/net/" rel="tag">.NET</a>,
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>
                    and
                    
                <a href="/tag/til/" rel="tag">til</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
        <article>
    <header>
        <time datetime="2007-03-07">2007-03-07</time>
        <h1>
            <a href="/blog/2007/03/07/NVelocityTemplatesAndAbsolutePaths.html" rel="bookmark canonical">NVelocity templates and absolute paths</a>
        </h1>
    </header>
    <a class="reference external image-reference" href="http://www.castleproject.org/others/nvelocity/index.html"></a>
<p>We've started using the <a class="reference external" href="http://www.castleproject.org/others/nvelocity/index.html">NVelocity</a> template formatting engine.
We were absolutely stymied for an hour, trying to figure
out how to get it working with an absolute path to the template file,
instead of the relative path shown in the <a class="reference external" href="http://www.castleproject.org/others/nvelocity/usingit.html">doc&shy;u&shy;men&shy;ta&shy;tion</a>.</p>
<p>The trick is to set <tt class="docutils literal">file.resource.loader.path</tt>.
Here's how to load <tt class="docutils literal"><span class="pre">C:\foo\bar\&shy;some&shy;file.vm</span></tt>:</p>
<pre class="code csharp literal-block">
<span class="n">ExtendedProperties</span><span class="w"> </span><span class="n">props</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ExtendedProperties</span><span class="p">();</span><span class="w">
</span><span class="n">props</span><span class="p">.</span><span class="n">AddProperty</span><span class="p">(</span><span class="s">&quot;file.resource.loader.path&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="kt">string</span><span class="p">[]{</span><span class="s">&quot;.&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;C:\\&quot;</span><span class="p">}));</span><span class="w">
</span><span class="n">velocity</span><span class="p">.</span><span class="n">Init</span><span class="p">(</span><span class="n">props</span><span class="p">);</span><span class="w">

</span><span class="n">template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velocity</span><span class="p">.</span><span class="n">GetTemplate</span><span class="p">(</span><span class="s">&quot;foo\\bar\\somefile.vm&quot;</span><span class="p">);</span>
</pre>

    <footer>
        
        
            <p>tagged as
                <a href="/tag/net/" rel="tag">.NET</a>,
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>
                    and
                    
                <a href="/tag/til/" rel="tag">til</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
        <article>
    <header>
        <time datetime="2006-09-14">2006-09-14</time>
        <h1>
            <a href="/blog/2006/09/14/NeverSleep0InAnInfiniteLoop.html" rel="bookmark canonical">Never Sleep(0) in an Infinite Loop</a>
        </h1>
    </header>
    
<p>I ran into a problem installing some COM+ components today. The installer
was using <a class="reference external" href="http://msdn2.microsoft.com/en-us/library/04za0hca.aspx">Regsvcs.exe</a>
to register each COM+ component. I noticed after a while that the installer
wasn't making any progress and that my dual-proc system was stuck at 50%
CPU uti&shy;liza&shy;tion. I attached a debugger to the offending process, regsvcs,
and found that it was stuck in the following infinite loop
(dis&shy;as&shy;sem&shy;bly courtesy of <a class="reference external" href="http://www.aisto.com/roeder/dotnet/">Reflector</a>):</p>
<pre class="code csharp literal-block">
<span class="k">internal</span><span class="w"> </span><span class="k">void</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">EnterpriseServices</span><span class="p">.</span><span class="n">CatalogSync</span><span class="p">.</span><span class="n">Wait</span><span class="p">()</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="n">_set</span><span class="p">)</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="n">RegistryKey</span><span class="w"> </span><span class="n">key1</span><span class="w">
      </span><span class="o">=</span><span class="w"> </span><span class="n">Registry</span><span class="p">.</span><span class="n">LocalMachine</span><span class="p">.</span><span class="n">OpenSubKey</span><span class="p">(</span><span class="s">&#64;&quot;SOFTWARE\Classes\CLSID&quot;</span><span class="p">);</span><span class="w">
    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="k">true</span><span class="p">)</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="kt">int</span><span class="w"> </span><span class="n">num1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">key1</span><span class="p">.</span><span class="n">GetValue</span><span class="p">(</span><span class="s">&quot;CLBVersion&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">);</span><span class="w">
 </span></pre><span>&#8230;<a href="/blog/2006/09/14/NeverSleep0InAnInfiniteLoop.html" class="continue">continue</a>.</span>
    <footer>
        
        
            <p>tagged as
                <a href="/tag/c-sharp/" rel="tag">c-sharp</a>,
                <a href="/tag/windows/" rel="tag">windows</a>
                    and
                    
                <a href="/tag/til/" rel="tag">til</a>
                
            </p>
        
    </footer>
    <div class="comments"></div>
</article>


    
    
    
<footer>
    
    
    <p>written by <a href="mailto:george@reilly.org">George V. Reilly</a></p>
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="copyright license">
        <img src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" alt="by-nc-sa" />
    </a>
    
    

  </footer>
</body>
</html>
